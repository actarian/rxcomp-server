{"version":3,"sources":["test/js/main.server.ts","../node_modules/node-fetch/lib/index.mjs","../src/nodes/nodes.ts","../node_modules/cross-fetch/dist/node-ponyfill.js","../node_modules/cross-fetch/dist/node-polyfill.js","../src/platform/server.ts","../test/js/http/http.service.ts","../test/js/app.component.ts","../test/js/app.module.ts","../test/js/main.server.ts"],"names":["g","f","exports","module","require","define","amd","globalThis","self","main","server","umd","Stream","http","Url","https","zlib","rxjs","operators","htmlparser2","rxcomp","this","Object","prototype","hasOwnProperty","call","commonjsGlobal","window","global","Readable","BUFFER","Symbol","TYPE","Blob","[object Object]","blobParts","arguments","options","buffers","size","a","length","Number","i","element","buffer","Buffer","ArrayBuffer","isView","from","byteOffset","byteLength","String","push","concat","type","undefined","toLowerCase","test","Promise","resolve","toString","buf","ab","slice","readable","_read","start","end","relativeStart","relativeEnd","Math","max","min","span","slicedBuffer","blob","FetchError","message","systemError","Error","code","errno","captureStackTrace","constructor","convert","defineProperties","enumerable","defineProperty","toStringTag","value","writable","configurable","create","name","e","INTERNALS","PassThrough","Body","body","_this","_ref","_ref$size","_ref$timeout","timeout","isURLSearchParams","isBlob","isBuffer","disturbed","error","on","err","url","consumeBody","_this4","reject","TypeError","alloc","stream","accum","accumBytes","abort","resTimeout","setTimeout","chunk","clearTimeout","obj","append","delete","get","getAll","has","set","sort","arrayBuffer","clone","instance","p1","p2","bodyUsed","getBoundary","pipe","extractContentType","getTotalBytes","getLengthSync","_lengthRetrievers","hasKnownLength","then","ct","headers","assign","_this2","JSON","parse","_this3","res","str","charset","exec","pop","convertBody","json","text","mixIn","proto","getOwnPropertyNames","desc","getOwnPropertyDescriptor","invalidTokenRegex","invalidHeaderCharRegex","validateName","validateValue","find","map","key","MAP","Headers","init","rawHeaders","raw","headerNames","keys","headerName","method","iterator","pairs","pair","Array","join","callback","thisArg","getHeaders","_pairs$i","createHeadersIterator","kind","k","entries","forEach","values","INTERNAL","target","HeadersIteratorPrototype","index","setPrototypeOf","getPrototypeOf","_INTERNAL","done","exportNodeCompatibleHeaders","__proto__","hostHeaderKey","INTERNALS$1","STATUS_CODES","Response","opts","status","contentType","statusText","counter","ok","redirected","INTERNALS$2","parse_url","format_url","format","streamDestructionSupported","isRequest","input","Request","parsedURL","href","toUpperCase","inputBody","signal","isAbortSignal","redirect","follow","compress","agent","AbortError","PassThrough$1","resolve_url","fetch","request","protocol","hostname","contentLengthValue","totalBytes","getNodeRequestOptions","send","response","destroy","emit","aborted","abortAndFinalize","finalize","req","reqTimeout","removeEventListener","addEventListener","once","socket","isArray","val","createHeadersLenient","isRedirect","statusCode","location","locationURL","requestOpts","response_options","statusMessage","codings","zlibOptions","flush","Z_SYNC_FLUSH","finishFlush","createGunzip","createBrotliDecompress","createInflate","createInflateRaw","dest","write","writeToStream","n","RxNodeType","SelectorType","nodeFetch","freeze","default","fetch$1","nodePonyfill","fn","basedir","path","base","commonjsRequire","createCommonjsModule","realFetch","fetchNode","bind","_defineProperties","props","descriptor","_createClass","Constructor","protoProps","staticProps","_inheritsLoose","subClass","superClass","_getPrototypeOf","o","_setPrototypeOf","p","_isNativeReflectConstruct","Reflect","construct","sham","Proxy","Date","_construct","Parent","args","Class","apply","Function","_wrapNativeSuper","_cache","Map","indexOf","Wrapper","_assertThisInitialized","ReferenceError","_arrayLikeToArray","arr","len","arr2","_createForOfIteratorHelperLoose","allowArrayLike","it","minLen","_unsupportedIterableToArray","next","isRxElement","x","nodeType","ELEMENT_NODE","isRxText","TEXT_NODE","html","node","doc","RxDocument","parentNode","parser","Parser","onopentag","nodeName","attributes","RxElement","childNodes","onclosetag","ontext","nodeValue","textNode","RxText","onprocessinginstruction","RxDocumentType","RxProcessingInstruction","oncomment","RxComment","oncommentend","oncdatastart","console","log","oncdataend","onerror","decodeEntities","lowerCaseTags","getQueries","selector","queries","trim","split","_step","selectors","_iterator","matchAll","match","Id","negate","Attribute","TagName","inner","matchSelectors","child","reduce","id","classList","matchSelector","querySelector","query","shift","_step3","_iterator3","cloneNode","source","deep","nodeElement","DOCUMENT_FRAGMENT_NODE","nodeDocumentFragment","RxDocumentFragment","COMMENT_NODE","isRxComment","DOCUMENT_NODE","isRxDocument","documentElement","polyfill","RxNode","_proto","serialize","RxStyle","_proto2","item","getPropertyPriority","getPropertyValue","setProperty","important","serialize_","removeProperty","style","_this$node$attributes","RxClassList","_Array","_proto3","contains","add","_len","names","remove","_this5","_len2","splice","toggle","force","replace","oldClass","newClass","class","_this$node$attributes2","_RxNode","_this6","_proto4","_this7","_len3","nodesOrDOMStrings","nodeOrDomString","prepend","_this8","_len4","unshift","replaceChildren","_this9","_len5","nodes","querySelectorAll","filter","hasAttribute","attribute","getAttribute","setAttribute","removeAttribute","replaceChild","newChild","oldChild","removeChild","insertBefore","newNode","referenceNode","addListener","eventName","handler","removeListener","serializeAttributes","_this10","children","count","_step4","_iterator4","innerText","_this11","_RxNode2","_this12","_RxNode4","_this14","_RxNode5","_this15","PROCESSING_INSTRUCTION_NODE","_RxNode6","_this16","DOCUMENT_TYPE_NODE","_RxElement","_this17","_RxElement2","_this18","isRxDocumentType","title","firstElementChild","_proto10","createAttribute","createAttributeNS","createCDATASection","createComment","createDocumentFragment","createElement","createElementNS","createEvent","createNodeIterator","createProcessingInstruction","createRange","createTextNode","createTouchList","createTreeWalker","Server","_Platform","bootstrap","moduleFactory","isPlatformServer","meta","document","resolveGlobals","resolveMeta","_node$parentNode","nodeInnerHTML","rxcomp_hydrate_","innerHTML","scriptNode","scriptText","stringify","instances","compile","pushChanges","documentOrHtml","Platform","HttpResponse","data","HttpService","http$","response_","pendingRequests$","getValue","Accept","Content-Type","catchError","throwError","getError","get$","delete$","post$","put$","patch$","object","BehaviorSubject","AppComponent","_Component","onInit","items","first","subscribe","onClick","completed","Component","AppModule","_Module","Module","imports","CoreModule","declarations","renderServer"],"mappings":"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","file":"server\\main.server.umd.min.js","sourcesContent":[null,"import Stream from 'stream';\nimport http from 'http';\nimport Url from 'url';\nimport https from 'https';\nimport zlib from 'zlib';\n\n// Based on https://github.com/tmpvar/jsdom/blob/aa85b2abf07766ff7bf5c1f6daafb3726f2f2db5/lib/jsdom/living/blob.js\n\n// fix for \"Readable\" isn't a named export issue\nconst Readable = Stream.Readable;\n\nconst BUFFER = Symbol('buffer');\nconst TYPE = Symbol('type');\n\nclass Blob {\n\tconstructor() {\n\t\tthis[TYPE] = '';\n\n\t\tconst blobParts = arguments[0];\n\t\tconst options = arguments[1];\n\n\t\tconst buffers = [];\n\t\tlet size = 0;\n\n\t\tif (blobParts) {\n\t\t\tconst a = blobParts;\n\t\t\tconst length = Number(a.length);\n\t\t\tfor (let i = 0; i < length; i++) {\n\t\t\t\tconst element = a[i];\n\t\t\t\tlet buffer;\n\t\t\t\tif (element instanceof Buffer) {\n\t\t\t\t\tbuffer = element;\n\t\t\t\t} else if (ArrayBuffer.isView(element)) {\n\t\t\t\t\tbuffer = Buffer.from(element.buffer, element.byteOffset, element.byteLength);\n\t\t\t\t} else if (element instanceof ArrayBuffer) {\n\t\t\t\t\tbuffer = Buffer.from(element);\n\t\t\t\t} else if (element instanceof Blob) {\n\t\t\t\t\tbuffer = element[BUFFER];\n\t\t\t\t} else {\n\t\t\t\t\tbuffer = Buffer.from(typeof element === 'string' ? element : String(element));\n\t\t\t\t}\n\t\t\t\tsize += buffer.length;\n\t\t\t\tbuffers.push(buffer);\n\t\t\t}\n\t\t}\n\n\t\tthis[BUFFER] = Buffer.concat(buffers);\n\n\t\tlet type = options && options.type !== undefined && String(options.type).toLowerCase();\n\t\tif (type && !/[^\\u0020-\\u007E]/.test(type)) {\n\t\t\tthis[TYPE] = type;\n\t\t}\n\t}\n\tget size() {\n\t\treturn this[BUFFER].length;\n\t}\n\tget type() {\n\t\treturn this[TYPE];\n\t}\n\ttext() {\n\t\treturn Promise.resolve(this[BUFFER].toString());\n\t}\n\tarrayBuffer() {\n\t\tconst buf = this[BUFFER];\n\t\tconst ab = buf.buffer.slice(buf.byteOffset, buf.byteOffset + buf.byteLength);\n\t\treturn Promise.resolve(ab);\n\t}\n\tstream() {\n\t\tconst readable = new Readable();\n\t\treadable._read = function () {};\n\t\treadable.push(this[BUFFER]);\n\t\treadable.push(null);\n\t\treturn readable;\n\t}\n\ttoString() {\n\t\treturn '[object Blob]';\n\t}\n\tslice() {\n\t\tconst size = this.size;\n\n\t\tconst start = arguments[0];\n\t\tconst end = arguments[1];\n\t\tlet relativeStart, relativeEnd;\n\t\tif (start === undefined) {\n\t\t\trelativeStart = 0;\n\t\t} else if (start < 0) {\n\t\t\trelativeStart = Math.max(size + start, 0);\n\t\t} else {\n\t\t\trelativeStart = Math.min(start, size);\n\t\t}\n\t\tif (end === undefined) {\n\t\t\trelativeEnd = size;\n\t\t} else if (end < 0) {\n\t\t\trelativeEnd = Math.max(size + end, 0);\n\t\t} else {\n\t\t\trelativeEnd = Math.min(end, size);\n\t\t}\n\t\tconst span = Math.max(relativeEnd - relativeStart, 0);\n\n\t\tconst buffer = this[BUFFER];\n\t\tconst slicedBuffer = buffer.slice(relativeStart, relativeStart + span);\n\t\tconst blob = new Blob([], { type: arguments[2] });\n\t\tblob[BUFFER] = slicedBuffer;\n\t\treturn blob;\n\t}\n}\n\nObject.defineProperties(Blob.prototype, {\n\tsize: { enumerable: true },\n\ttype: { enumerable: true },\n\tslice: { enumerable: true }\n});\n\nObject.defineProperty(Blob.prototype, Symbol.toStringTag, {\n\tvalue: 'Blob',\n\twritable: false,\n\tenumerable: false,\n\tconfigurable: true\n});\n\n/**\n * fetch-error.js\n *\n * FetchError interface for operational errors\n */\n\n/**\n * Create FetchError instance\n *\n * @param   String      message      Error message for human\n * @param   String      type         Error type for machine\n * @param   String      systemError  For Node.js system error\n * @return  FetchError\n */\nfunction FetchError(message, type, systemError) {\n  Error.call(this, message);\n\n  this.message = message;\n  this.type = type;\n\n  // when err.type is `system`, err.code contains system error code\n  if (systemError) {\n    this.code = this.errno = systemError.code;\n  }\n\n  // hide custom error implementation details from end-users\n  Error.captureStackTrace(this, this.constructor);\n}\n\nFetchError.prototype = Object.create(Error.prototype);\nFetchError.prototype.constructor = FetchError;\nFetchError.prototype.name = 'FetchError';\n\nlet convert;\ntry {\n\tconvert = require('encoding').convert;\n} catch (e) {}\n\nconst INTERNALS = Symbol('Body internals');\n\n// fix an issue where \"PassThrough\" isn't a named export for node <10\nconst PassThrough = Stream.PassThrough;\n\n/**\n * Body mixin\n *\n * Ref: https://fetch.spec.whatwg.org/#body\n *\n * @param   Stream  body  Readable stream\n * @param   Object  opts  Response options\n * @return  Void\n */\nfunction Body(body) {\n\tvar _this = this;\n\n\tvar _ref = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {},\n\t    _ref$size = _ref.size;\n\n\tlet size = _ref$size === undefined ? 0 : _ref$size;\n\tvar _ref$timeout = _ref.timeout;\n\tlet timeout = _ref$timeout === undefined ? 0 : _ref$timeout;\n\n\tif (body == null) {\n\t\t// body is undefined or null\n\t\tbody = null;\n\t} else if (isURLSearchParams(body)) {\n\t\t// body is a URLSearchParams\n\t\tbody = Buffer.from(body.toString());\n\t} else if (isBlob(body)) ; else if (Buffer.isBuffer(body)) ; else if (Object.prototype.toString.call(body) === '[object ArrayBuffer]') {\n\t\t// body is ArrayBuffer\n\t\tbody = Buffer.from(body);\n\t} else if (ArrayBuffer.isView(body)) {\n\t\t// body is ArrayBufferView\n\t\tbody = Buffer.from(body.buffer, body.byteOffset, body.byteLength);\n\t} else if (body instanceof Stream) ; else {\n\t\t// none of the above\n\t\t// coerce to string then buffer\n\t\tbody = Buffer.from(String(body));\n\t}\n\tthis[INTERNALS] = {\n\t\tbody,\n\t\tdisturbed: false,\n\t\terror: null\n\t};\n\tthis.size = size;\n\tthis.timeout = timeout;\n\n\tif (body instanceof Stream) {\n\t\tbody.on('error', function (err) {\n\t\t\tconst error = err.name === 'AbortError' ? err : new FetchError(`Invalid response body while trying to fetch ${_this.url}: ${err.message}`, 'system', err);\n\t\t\t_this[INTERNALS].error = error;\n\t\t});\n\t}\n}\n\nBody.prototype = {\n\tget body() {\n\t\treturn this[INTERNALS].body;\n\t},\n\n\tget bodyUsed() {\n\t\treturn this[INTERNALS].disturbed;\n\t},\n\n\t/**\n  * Decode response as ArrayBuffer\n  *\n  * @return  Promise\n  */\n\tarrayBuffer() {\n\t\treturn consumeBody.call(this).then(function (buf) {\n\t\t\treturn buf.buffer.slice(buf.byteOffset, buf.byteOffset + buf.byteLength);\n\t\t});\n\t},\n\n\t/**\n  * Return raw response as Blob\n  *\n  * @return Promise\n  */\n\tblob() {\n\t\tlet ct = this.headers && this.headers.get('content-type') || '';\n\t\treturn consumeBody.call(this).then(function (buf) {\n\t\t\treturn Object.assign(\n\t\t\t// Prevent copying\n\t\t\tnew Blob([], {\n\t\t\t\ttype: ct.toLowerCase()\n\t\t\t}), {\n\t\t\t\t[BUFFER]: buf\n\t\t\t});\n\t\t});\n\t},\n\n\t/**\n  * Decode response as json\n  *\n  * @return  Promise\n  */\n\tjson() {\n\t\tvar _this2 = this;\n\n\t\treturn consumeBody.call(this).then(function (buffer) {\n\t\t\ttry {\n\t\t\t\treturn JSON.parse(buffer.toString());\n\t\t\t} catch (err) {\n\t\t\t\treturn Body.Promise.reject(new FetchError(`invalid json response body at ${_this2.url} reason: ${err.message}`, 'invalid-json'));\n\t\t\t}\n\t\t});\n\t},\n\n\t/**\n  * Decode response as text\n  *\n  * @return  Promise\n  */\n\ttext() {\n\t\treturn consumeBody.call(this).then(function (buffer) {\n\t\t\treturn buffer.toString();\n\t\t});\n\t},\n\n\t/**\n  * Decode response as buffer (non-spec api)\n  *\n  * @return  Promise\n  */\n\tbuffer() {\n\t\treturn consumeBody.call(this);\n\t},\n\n\t/**\n  * Decode response as text, while automatically detecting the encoding and\n  * trying to decode to UTF-8 (non-spec api)\n  *\n  * @return  Promise\n  */\n\ttextConverted() {\n\t\tvar _this3 = this;\n\n\t\treturn consumeBody.call(this).then(function (buffer) {\n\t\t\treturn convertBody(buffer, _this3.headers);\n\t\t});\n\t}\n};\n\n// In browsers, all properties are enumerable.\nObject.defineProperties(Body.prototype, {\n\tbody: { enumerable: true },\n\tbodyUsed: { enumerable: true },\n\tarrayBuffer: { enumerable: true },\n\tblob: { enumerable: true },\n\tjson: { enumerable: true },\n\ttext: { enumerable: true }\n});\n\nBody.mixIn = function (proto) {\n\tfor (const name of Object.getOwnPropertyNames(Body.prototype)) {\n\t\t// istanbul ignore else: future proof\n\t\tif (!(name in proto)) {\n\t\t\tconst desc = Object.getOwnPropertyDescriptor(Body.prototype, name);\n\t\t\tObject.defineProperty(proto, name, desc);\n\t\t}\n\t}\n};\n\n/**\n * Consume and convert an entire Body to a Buffer.\n *\n * Ref: https://fetch.spec.whatwg.org/#concept-body-consume-body\n *\n * @return  Promise\n */\nfunction consumeBody() {\n\tvar _this4 = this;\n\n\tif (this[INTERNALS].disturbed) {\n\t\treturn Body.Promise.reject(new TypeError(`body used already for: ${this.url}`));\n\t}\n\n\tthis[INTERNALS].disturbed = true;\n\n\tif (this[INTERNALS].error) {\n\t\treturn Body.Promise.reject(this[INTERNALS].error);\n\t}\n\n\tlet body = this.body;\n\n\t// body is null\n\tif (body === null) {\n\t\treturn Body.Promise.resolve(Buffer.alloc(0));\n\t}\n\n\t// body is blob\n\tif (isBlob(body)) {\n\t\tbody = body.stream();\n\t}\n\n\t// body is buffer\n\tif (Buffer.isBuffer(body)) {\n\t\treturn Body.Promise.resolve(body);\n\t}\n\n\t// istanbul ignore if: should never happen\n\tif (!(body instanceof Stream)) {\n\t\treturn Body.Promise.resolve(Buffer.alloc(0));\n\t}\n\n\t// body is stream\n\t// get ready to actually consume the body\n\tlet accum = [];\n\tlet accumBytes = 0;\n\tlet abort = false;\n\n\treturn new Body.Promise(function (resolve, reject) {\n\t\tlet resTimeout;\n\n\t\t// allow timeout on slow response body\n\t\tif (_this4.timeout) {\n\t\t\tresTimeout = setTimeout(function () {\n\t\t\t\tabort = true;\n\t\t\t\treject(new FetchError(`Response timeout while trying to fetch ${_this4.url} (over ${_this4.timeout}ms)`, 'body-timeout'));\n\t\t\t}, _this4.timeout);\n\t\t}\n\n\t\t// handle stream errors\n\t\tbody.on('error', function (err) {\n\t\t\tif (err.name === 'AbortError') {\n\t\t\t\t// if the request was aborted, reject with this Error\n\t\t\t\tabort = true;\n\t\t\t\treject(err);\n\t\t\t} else {\n\t\t\t\t// other errors, such as incorrect content-encoding\n\t\t\t\treject(new FetchError(`Invalid response body while trying to fetch ${_this4.url}: ${err.message}`, 'system', err));\n\t\t\t}\n\t\t});\n\n\t\tbody.on('data', function (chunk) {\n\t\t\tif (abort || chunk === null) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (_this4.size && accumBytes + chunk.length > _this4.size) {\n\t\t\t\tabort = true;\n\t\t\t\treject(new FetchError(`content size at ${_this4.url} over limit: ${_this4.size}`, 'max-size'));\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\taccumBytes += chunk.length;\n\t\t\taccum.push(chunk);\n\t\t});\n\n\t\tbody.on('end', function () {\n\t\t\tif (abort) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tclearTimeout(resTimeout);\n\n\t\t\ttry {\n\t\t\t\tresolve(Buffer.concat(accum, accumBytes));\n\t\t\t} catch (err) {\n\t\t\t\t// handle streams that have accumulated too much data (issue #414)\n\t\t\t\treject(new FetchError(`Could not create Buffer from response body for ${_this4.url}: ${err.message}`, 'system', err));\n\t\t\t}\n\t\t});\n\t});\n}\n\n/**\n * Detect buffer encoding and convert to target encoding\n * ref: http://www.w3.org/TR/2011/WD-html5-20110113/parsing.html#determining-the-character-encoding\n *\n * @param   Buffer  buffer    Incoming buffer\n * @param   String  encoding  Target encoding\n * @return  String\n */\nfunction convertBody(buffer, headers) {\n\tif (typeof convert !== 'function') {\n\t\tthrow new Error('The package `encoding` must be installed to use the textConverted() function');\n\t}\n\n\tconst ct = headers.get('content-type');\n\tlet charset = 'utf-8';\n\tlet res, str;\n\n\t// header\n\tif (ct) {\n\t\tres = /charset=([^;]*)/i.exec(ct);\n\t}\n\n\t// no charset in content type, peek at response body for at most 1024 bytes\n\tstr = buffer.slice(0, 1024).toString();\n\n\t// html5\n\tif (!res && str) {\n\t\tres = /<meta.+?charset=(['\"])(.+?)\\1/i.exec(str);\n\t}\n\n\t// html4\n\tif (!res && str) {\n\t\tres = /<meta[\\s]+?http-equiv=(['\"])content-type\\1[\\s]+?content=(['\"])(.+?)\\2/i.exec(str);\n\n\t\tif (res) {\n\t\t\tres = /charset=(.*)/i.exec(res.pop());\n\t\t}\n\t}\n\n\t// xml\n\tif (!res && str) {\n\t\tres = /<\\?xml.+?encoding=(['\"])(.+?)\\1/i.exec(str);\n\t}\n\n\t// found charset\n\tif (res) {\n\t\tcharset = res.pop();\n\n\t\t// prevent decode issues when sites use incorrect encoding\n\t\t// ref: https://hsivonen.fi/encoding-menu/\n\t\tif (charset === 'gb2312' || charset === 'gbk') {\n\t\t\tcharset = 'gb18030';\n\t\t}\n\t}\n\n\t// turn raw buffers into a single utf-8 buffer\n\treturn convert(buffer, 'UTF-8', charset).toString();\n}\n\n/**\n * Detect a URLSearchParams object\n * ref: https://github.com/bitinn/node-fetch/issues/296#issuecomment-307598143\n *\n * @param   Object  obj     Object to detect by type or brand\n * @return  String\n */\nfunction isURLSearchParams(obj) {\n\t// Duck-typing as a necessary condition.\n\tif (typeof obj !== 'object' || typeof obj.append !== 'function' || typeof obj.delete !== 'function' || typeof obj.get !== 'function' || typeof obj.getAll !== 'function' || typeof obj.has !== 'function' || typeof obj.set !== 'function') {\n\t\treturn false;\n\t}\n\n\t// Brand-checking and more duck-typing as optional condition.\n\treturn obj.constructor.name === 'URLSearchParams' || Object.prototype.toString.call(obj) === '[object URLSearchParams]' || typeof obj.sort === 'function';\n}\n\n/**\n * Check if `obj` is a W3C `Blob` object (which `File` inherits from)\n * @param  {*} obj\n * @return {boolean}\n */\nfunction isBlob(obj) {\n\treturn typeof obj === 'object' && typeof obj.arrayBuffer === 'function' && typeof obj.type === 'string' && typeof obj.stream === 'function' && typeof obj.constructor === 'function' && typeof obj.constructor.name === 'string' && /^(Blob|File)$/.test(obj.constructor.name) && /^(Blob|File)$/.test(obj[Symbol.toStringTag]);\n}\n\n/**\n * Clone body given Res/Req instance\n *\n * @param   Mixed  instance  Response or Request instance\n * @return  Mixed\n */\nfunction clone(instance) {\n\tlet p1, p2;\n\tlet body = instance.body;\n\n\t// don't allow cloning a used body\n\tif (instance.bodyUsed) {\n\t\tthrow new Error('cannot clone body after it is used');\n\t}\n\n\t// check that body is a stream and not form-data object\n\t// note: we can't clone the form-data object without having it as a dependency\n\tif (body instanceof Stream && typeof body.getBoundary !== 'function') {\n\t\t// tee instance body\n\t\tp1 = new PassThrough();\n\t\tp2 = new PassThrough();\n\t\tbody.pipe(p1);\n\t\tbody.pipe(p2);\n\t\t// set instance body to teed body and return the other teed body\n\t\tinstance[INTERNALS].body = p1;\n\t\tbody = p2;\n\t}\n\n\treturn body;\n}\n\n/**\n * Performs the operation \"extract a `Content-Type` value from |object|\" as\n * specified in the specification:\n * https://fetch.spec.whatwg.org/#concept-bodyinit-extract\n *\n * This function assumes that instance.body is present.\n *\n * @param   Mixed  instance  Any options.body input\n */\nfunction extractContentType(body) {\n\tif (body === null) {\n\t\t// body is null\n\t\treturn null;\n\t} else if (typeof body === 'string') {\n\t\t// body is string\n\t\treturn 'text/plain;charset=UTF-8';\n\t} else if (isURLSearchParams(body)) {\n\t\t// body is a URLSearchParams\n\t\treturn 'application/x-www-form-urlencoded;charset=UTF-8';\n\t} else if (isBlob(body)) {\n\t\t// body is blob\n\t\treturn body.type || null;\n\t} else if (Buffer.isBuffer(body)) {\n\t\t// body is buffer\n\t\treturn null;\n\t} else if (Object.prototype.toString.call(body) === '[object ArrayBuffer]') {\n\t\t// body is ArrayBuffer\n\t\treturn null;\n\t} else if (ArrayBuffer.isView(body)) {\n\t\t// body is ArrayBufferView\n\t\treturn null;\n\t} else if (typeof body.getBoundary === 'function') {\n\t\t// detect form data input from form-data module\n\t\treturn `multipart/form-data;boundary=${body.getBoundary()}`;\n\t} else if (body instanceof Stream) {\n\t\t// body is stream\n\t\t// can't really do much about this\n\t\treturn null;\n\t} else {\n\t\t// Body constructor defaults other things to string\n\t\treturn 'text/plain;charset=UTF-8';\n\t}\n}\n\n/**\n * The Fetch Standard treats this as if \"total bytes\" is a property on the body.\n * For us, we have to explicitly get it with a function.\n *\n * ref: https://fetch.spec.whatwg.org/#concept-body-total-bytes\n *\n * @param   Body    instance   Instance of Body\n * @return  Number?            Number of bytes, or null if not possible\n */\nfunction getTotalBytes(instance) {\n\tconst body = instance.body;\n\n\n\tif (body === null) {\n\t\t// body is null\n\t\treturn 0;\n\t} else if (isBlob(body)) {\n\t\treturn body.size;\n\t} else if (Buffer.isBuffer(body)) {\n\t\t// body is buffer\n\t\treturn body.length;\n\t} else if (body && typeof body.getLengthSync === 'function') {\n\t\t// detect form data input from form-data module\n\t\tif (body._lengthRetrievers && body._lengthRetrievers.length == 0 || // 1.x\n\t\tbody.hasKnownLength && body.hasKnownLength()) {\n\t\t\t// 2.x\n\t\t\treturn body.getLengthSync();\n\t\t}\n\t\treturn null;\n\t} else {\n\t\t// body is stream\n\t\treturn null;\n\t}\n}\n\n/**\n * Write a Body to a Node.js WritableStream (e.g. http.Request) object.\n *\n * @param   Body    instance   Instance of Body\n * @return  Void\n */\nfunction writeToStream(dest, instance) {\n\tconst body = instance.body;\n\n\n\tif (body === null) {\n\t\t// body is null\n\t\tdest.end();\n\t} else if (isBlob(body)) {\n\t\tbody.stream().pipe(dest);\n\t} else if (Buffer.isBuffer(body)) {\n\t\t// body is buffer\n\t\tdest.write(body);\n\t\tdest.end();\n\t} else {\n\t\t// body is stream\n\t\tbody.pipe(dest);\n\t}\n}\n\n// expose Promise\nBody.Promise = global.Promise;\n\n/**\n * headers.js\n *\n * Headers class offers convenient helpers\n */\n\nconst invalidTokenRegex = /[^\\^_`a-zA-Z\\-0-9!#$%&'*+.|~]/;\nconst invalidHeaderCharRegex = /[^\\t\\x20-\\x7e\\x80-\\xff]/;\n\nfunction validateName(name) {\n\tname = `${name}`;\n\tif (invalidTokenRegex.test(name) || name === '') {\n\t\tthrow new TypeError(`${name} is not a legal HTTP header name`);\n\t}\n}\n\nfunction validateValue(value) {\n\tvalue = `${value}`;\n\tif (invalidHeaderCharRegex.test(value)) {\n\t\tthrow new TypeError(`${value} is not a legal HTTP header value`);\n\t}\n}\n\n/**\n * Find the key in the map object given a header name.\n *\n * Returns undefined if not found.\n *\n * @param   String  name  Header name\n * @return  String|Undefined\n */\nfunction find(map, name) {\n\tname = name.toLowerCase();\n\tfor (const key in map) {\n\t\tif (key.toLowerCase() === name) {\n\t\t\treturn key;\n\t\t}\n\t}\n\treturn undefined;\n}\n\nconst MAP = Symbol('map');\nclass Headers {\n\t/**\n  * Headers class\n  *\n  * @param   Object  headers  Response headers\n  * @return  Void\n  */\n\tconstructor() {\n\t\tlet init = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : undefined;\n\n\t\tthis[MAP] = Object.create(null);\n\n\t\tif (init instanceof Headers) {\n\t\t\tconst rawHeaders = init.raw();\n\t\t\tconst headerNames = Object.keys(rawHeaders);\n\n\t\t\tfor (const headerName of headerNames) {\n\t\t\t\tfor (const value of rawHeaders[headerName]) {\n\t\t\t\t\tthis.append(headerName, value);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn;\n\t\t}\n\n\t\t// We don't worry about converting prop to ByteString here as append()\n\t\t// will handle it.\n\t\tif (init == null) ; else if (typeof init === 'object') {\n\t\t\tconst method = init[Symbol.iterator];\n\t\t\tif (method != null) {\n\t\t\t\tif (typeof method !== 'function') {\n\t\t\t\t\tthrow new TypeError('Header pairs must be iterable');\n\t\t\t\t}\n\n\t\t\t\t// sequence<sequence<ByteString>>\n\t\t\t\t// Note: per spec we have to first exhaust the lists then process them\n\t\t\t\tconst pairs = [];\n\t\t\t\tfor (const pair of init) {\n\t\t\t\t\tif (typeof pair !== 'object' || typeof pair[Symbol.iterator] !== 'function') {\n\t\t\t\t\t\tthrow new TypeError('Each header pair must be iterable');\n\t\t\t\t\t}\n\t\t\t\t\tpairs.push(Array.from(pair));\n\t\t\t\t}\n\n\t\t\t\tfor (const pair of pairs) {\n\t\t\t\t\tif (pair.length !== 2) {\n\t\t\t\t\t\tthrow new TypeError('Each header pair must be a name/value tuple');\n\t\t\t\t\t}\n\t\t\t\t\tthis.append(pair[0], pair[1]);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t// record<ByteString, ByteString>\n\t\t\t\tfor (const key of Object.keys(init)) {\n\t\t\t\t\tconst value = init[key];\n\t\t\t\t\tthis.append(key, value);\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tthrow new TypeError('Provided initializer must be an object');\n\t\t}\n\t}\n\n\t/**\n  * Return combined header value given name\n  *\n  * @param   String  name  Header name\n  * @return  Mixed\n  */\n\tget(name) {\n\t\tname = `${name}`;\n\t\tvalidateName(name);\n\t\tconst key = find(this[MAP], name);\n\t\tif (key === undefined) {\n\t\t\treturn null;\n\t\t}\n\n\t\treturn this[MAP][key].join(', ');\n\t}\n\n\t/**\n  * Iterate over all headers\n  *\n  * @param   Function  callback  Executed for each item with parameters (value, name, thisArg)\n  * @param   Boolean   thisArg   `this` context for callback function\n  * @return  Void\n  */\n\tforEach(callback) {\n\t\tlet thisArg = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : undefined;\n\n\t\tlet pairs = getHeaders(this);\n\t\tlet i = 0;\n\t\twhile (i < pairs.length) {\n\t\t\tvar _pairs$i = pairs[i];\n\t\t\tconst name = _pairs$i[0],\n\t\t\t      value = _pairs$i[1];\n\n\t\t\tcallback.call(thisArg, value, name, this);\n\t\t\tpairs = getHeaders(this);\n\t\t\ti++;\n\t\t}\n\t}\n\n\t/**\n  * Overwrite header values given name\n  *\n  * @param   String  name   Header name\n  * @param   String  value  Header value\n  * @return  Void\n  */\n\tset(name, value) {\n\t\tname = `${name}`;\n\t\tvalue = `${value}`;\n\t\tvalidateName(name);\n\t\tvalidateValue(value);\n\t\tconst key = find(this[MAP], name);\n\t\tthis[MAP][key !== undefined ? key : name] = [value];\n\t}\n\n\t/**\n  * Append a value onto existing header\n  *\n  * @param   String  name   Header name\n  * @param   String  value  Header value\n  * @return  Void\n  */\n\tappend(name, value) {\n\t\tname = `${name}`;\n\t\tvalue = `${value}`;\n\t\tvalidateName(name);\n\t\tvalidateValue(value);\n\t\tconst key = find(this[MAP], name);\n\t\tif (key !== undefined) {\n\t\t\tthis[MAP][key].push(value);\n\t\t} else {\n\t\t\tthis[MAP][name] = [value];\n\t\t}\n\t}\n\n\t/**\n  * Check for header name existence\n  *\n  * @param   String   name  Header name\n  * @return  Boolean\n  */\n\thas(name) {\n\t\tname = `${name}`;\n\t\tvalidateName(name);\n\t\treturn find(this[MAP], name) !== undefined;\n\t}\n\n\t/**\n  * Delete all header values given name\n  *\n  * @param   String  name  Header name\n  * @return  Void\n  */\n\tdelete(name) {\n\t\tname = `${name}`;\n\t\tvalidateName(name);\n\t\tconst key = find(this[MAP], name);\n\t\tif (key !== undefined) {\n\t\t\tdelete this[MAP][key];\n\t\t}\n\t}\n\n\t/**\n  * Return raw headers (non-spec api)\n  *\n  * @return  Object\n  */\n\traw() {\n\t\treturn this[MAP];\n\t}\n\n\t/**\n  * Get an iterator on keys.\n  *\n  * @return  Iterator\n  */\n\tkeys() {\n\t\treturn createHeadersIterator(this, 'key');\n\t}\n\n\t/**\n  * Get an iterator on values.\n  *\n  * @return  Iterator\n  */\n\tvalues() {\n\t\treturn createHeadersIterator(this, 'value');\n\t}\n\n\t/**\n  * Get an iterator on entries.\n  *\n  * This is the default iterator of the Headers object.\n  *\n  * @return  Iterator\n  */\n\t[Symbol.iterator]() {\n\t\treturn createHeadersIterator(this, 'key+value');\n\t}\n}\nHeaders.prototype.entries = Headers.prototype[Symbol.iterator];\n\nObject.defineProperty(Headers.prototype, Symbol.toStringTag, {\n\tvalue: 'Headers',\n\twritable: false,\n\tenumerable: false,\n\tconfigurable: true\n});\n\nObject.defineProperties(Headers.prototype, {\n\tget: { enumerable: true },\n\tforEach: { enumerable: true },\n\tset: { enumerable: true },\n\tappend: { enumerable: true },\n\thas: { enumerable: true },\n\tdelete: { enumerable: true },\n\tkeys: { enumerable: true },\n\tvalues: { enumerable: true },\n\tentries: { enumerable: true }\n});\n\nfunction getHeaders(headers) {\n\tlet kind = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 'key+value';\n\n\tconst keys = Object.keys(headers[MAP]).sort();\n\treturn keys.map(kind === 'key' ? function (k) {\n\t\treturn k.toLowerCase();\n\t} : kind === 'value' ? function (k) {\n\t\treturn headers[MAP][k].join(', ');\n\t} : function (k) {\n\t\treturn [k.toLowerCase(), headers[MAP][k].join(', ')];\n\t});\n}\n\nconst INTERNAL = Symbol('internal');\n\nfunction createHeadersIterator(target, kind) {\n\tconst iterator = Object.create(HeadersIteratorPrototype);\n\titerator[INTERNAL] = {\n\t\ttarget,\n\t\tkind,\n\t\tindex: 0\n\t};\n\treturn iterator;\n}\n\nconst HeadersIteratorPrototype = Object.setPrototypeOf({\n\tnext() {\n\t\t// istanbul ignore if\n\t\tif (!this || Object.getPrototypeOf(this) !== HeadersIteratorPrototype) {\n\t\t\tthrow new TypeError('Value of `this` is not a HeadersIterator');\n\t\t}\n\n\t\tvar _INTERNAL = this[INTERNAL];\n\t\tconst target = _INTERNAL.target,\n\t\t      kind = _INTERNAL.kind,\n\t\t      index = _INTERNAL.index;\n\n\t\tconst values = getHeaders(target, kind);\n\t\tconst len = values.length;\n\t\tif (index >= len) {\n\t\t\treturn {\n\t\t\t\tvalue: undefined,\n\t\t\t\tdone: true\n\t\t\t};\n\t\t}\n\n\t\tthis[INTERNAL].index = index + 1;\n\n\t\treturn {\n\t\t\tvalue: values[index],\n\t\t\tdone: false\n\t\t};\n\t}\n}, Object.getPrototypeOf(Object.getPrototypeOf([][Symbol.iterator]())));\n\nObject.defineProperty(HeadersIteratorPrototype, Symbol.toStringTag, {\n\tvalue: 'HeadersIterator',\n\twritable: false,\n\tenumerable: false,\n\tconfigurable: true\n});\n\n/**\n * Export the Headers object in a form that Node.js can consume.\n *\n * @param   Headers  headers\n * @return  Object\n */\nfunction exportNodeCompatibleHeaders(headers) {\n\tconst obj = Object.assign({ __proto__: null }, headers[MAP]);\n\n\t// http.request() only supports string as Host header. This hack makes\n\t// specifying custom Host header possible.\n\tconst hostHeaderKey = find(headers[MAP], 'Host');\n\tif (hostHeaderKey !== undefined) {\n\t\tobj[hostHeaderKey] = obj[hostHeaderKey][0];\n\t}\n\n\treturn obj;\n}\n\n/**\n * Create a Headers object from an object of headers, ignoring those that do\n * not conform to HTTP grammar productions.\n *\n * @param   Object  obj  Object of headers\n * @return  Headers\n */\nfunction createHeadersLenient(obj) {\n\tconst headers = new Headers();\n\tfor (const name of Object.keys(obj)) {\n\t\tif (invalidTokenRegex.test(name)) {\n\t\t\tcontinue;\n\t\t}\n\t\tif (Array.isArray(obj[name])) {\n\t\t\tfor (const val of obj[name]) {\n\t\t\t\tif (invalidHeaderCharRegex.test(val)) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tif (headers[MAP][name] === undefined) {\n\t\t\t\t\theaders[MAP][name] = [val];\n\t\t\t\t} else {\n\t\t\t\t\theaders[MAP][name].push(val);\n\t\t\t\t}\n\t\t\t}\n\t\t} else if (!invalidHeaderCharRegex.test(obj[name])) {\n\t\t\theaders[MAP][name] = [obj[name]];\n\t\t}\n\t}\n\treturn headers;\n}\n\nconst INTERNALS$1 = Symbol('Response internals');\n\n// fix an issue where \"STATUS_CODES\" aren't a named export for node <10\nconst STATUS_CODES = http.STATUS_CODES;\n\n/**\n * Response class\n *\n * @param   Stream  body  Readable stream\n * @param   Object  opts  Response options\n * @return  Void\n */\nclass Response {\n\tconstructor() {\n\t\tlet body = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : null;\n\t\tlet opts = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n\t\tBody.call(this, body, opts);\n\n\t\tconst status = opts.status || 200;\n\t\tconst headers = new Headers(opts.headers);\n\n\t\tif (body != null && !headers.has('Content-Type')) {\n\t\t\tconst contentType = extractContentType(body);\n\t\t\tif (contentType) {\n\t\t\t\theaders.append('Content-Type', contentType);\n\t\t\t}\n\t\t}\n\n\t\tthis[INTERNALS$1] = {\n\t\t\turl: opts.url,\n\t\t\tstatus,\n\t\t\tstatusText: opts.statusText || STATUS_CODES[status],\n\t\t\theaders,\n\t\t\tcounter: opts.counter\n\t\t};\n\t}\n\n\tget url() {\n\t\treturn this[INTERNALS$1].url || '';\n\t}\n\n\tget status() {\n\t\treturn this[INTERNALS$1].status;\n\t}\n\n\t/**\n  * Convenience property representing if the request ended normally\n  */\n\tget ok() {\n\t\treturn this[INTERNALS$1].status >= 200 && this[INTERNALS$1].status < 300;\n\t}\n\n\tget redirected() {\n\t\treturn this[INTERNALS$1].counter > 0;\n\t}\n\n\tget statusText() {\n\t\treturn this[INTERNALS$1].statusText;\n\t}\n\n\tget headers() {\n\t\treturn this[INTERNALS$1].headers;\n\t}\n\n\t/**\n  * Clone this response\n  *\n  * @return  Response\n  */\n\tclone() {\n\t\treturn new Response(clone(this), {\n\t\t\turl: this.url,\n\t\t\tstatus: this.status,\n\t\t\tstatusText: this.statusText,\n\t\t\theaders: this.headers,\n\t\t\tok: this.ok,\n\t\t\tredirected: this.redirected\n\t\t});\n\t}\n}\n\nBody.mixIn(Response.prototype);\n\nObject.defineProperties(Response.prototype, {\n\turl: { enumerable: true },\n\tstatus: { enumerable: true },\n\tok: { enumerable: true },\n\tredirected: { enumerable: true },\n\tstatusText: { enumerable: true },\n\theaders: { enumerable: true },\n\tclone: { enumerable: true }\n});\n\nObject.defineProperty(Response.prototype, Symbol.toStringTag, {\n\tvalue: 'Response',\n\twritable: false,\n\tenumerable: false,\n\tconfigurable: true\n});\n\nconst INTERNALS$2 = Symbol('Request internals');\n\n// fix an issue where \"format\", \"parse\" aren't a named export for node <10\nconst parse_url = Url.parse;\nconst format_url = Url.format;\n\nconst streamDestructionSupported = 'destroy' in Stream.Readable.prototype;\n\n/**\n * Check if a value is an instance of Request.\n *\n * @param   Mixed   input\n * @return  Boolean\n */\nfunction isRequest(input) {\n\treturn typeof input === 'object' && typeof input[INTERNALS$2] === 'object';\n}\n\nfunction isAbortSignal(signal) {\n\tconst proto = signal && typeof signal === 'object' && Object.getPrototypeOf(signal);\n\treturn !!(proto && proto.constructor.name === 'AbortSignal');\n}\n\n/**\n * Request class\n *\n * @param   Mixed   input  Url or Request instance\n * @param   Object  init   Custom options\n * @return  Void\n */\nclass Request {\n\tconstructor(input) {\n\t\tlet init = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n\t\tlet parsedURL;\n\n\t\t// normalize input\n\t\tif (!isRequest(input)) {\n\t\t\tif (input && input.href) {\n\t\t\t\t// in order to support Node.js' Url objects; though WHATWG's URL objects\n\t\t\t\t// will fall into this branch also (since their `toString()` will return\n\t\t\t\t// `href` property anyway)\n\t\t\t\tparsedURL = parse_url(input.href);\n\t\t\t} else {\n\t\t\t\t// coerce input to a string before attempting to parse\n\t\t\t\tparsedURL = parse_url(`${input}`);\n\t\t\t}\n\t\t\tinput = {};\n\t\t} else {\n\t\t\tparsedURL = parse_url(input.url);\n\t\t}\n\n\t\tlet method = init.method || input.method || 'GET';\n\t\tmethod = method.toUpperCase();\n\n\t\tif ((init.body != null || isRequest(input) && input.body !== null) && (method === 'GET' || method === 'HEAD')) {\n\t\t\tthrow new TypeError('Request with GET/HEAD method cannot have body');\n\t\t}\n\n\t\tlet inputBody = init.body != null ? init.body : isRequest(input) && input.body !== null ? clone(input) : null;\n\n\t\tBody.call(this, inputBody, {\n\t\t\ttimeout: init.timeout || input.timeout || 0,\n\t\t\tsize: init.size || input.size || 0\n\t\t});\n\n\t\tconst headers = new Headers(init.headers || input.headers || {});\n\n\t\tif (inputBody != null && !headers.has('Content-Type')) {\n\t\t\tconst contentType = extractContentType(inputBody);\n\t\t\tif (contentType) {\n\t\t\t\theaders.append('Content-Type', contentType);\n\t\t\t}\n\t\t}\n\n\t\tlet signal = isRequest(input) ? input.signal : null;\n\t\tif ('signal' in init) signal = init.signal;\n\n\t\tif (signal != null && !isAbortSignal(signal)) {\n\t\t\tthrow new TypeError('Expected signal to be an instanceof AbortSignal');\n\t\t}\n\n\t\tthis[INTERNALS$2] = {\n\t\t\tmethod,\n\t\t\tredirect: init.redirect || input.redirect || 'follow',\n\t\t\theaders,\n\t\t\tparsedURL,\n\t\t\tsignal\n\t\t};\n\n\t\t// node-fetch-only options\n\t\tthis.follow = init.follow !== undefined ? init.follow : input.follow !== undefined ? input.follow : 20;\n\t\tthis.compress = init.compress !== undefined ? init.compress : input.compress !== undefined ? input.compress : true;\n\t\tthis.counter = init.counter || input.counter || 0;\n\t\tthis.agent = init.agent || input.agent;\n\t}\n\n\tget method() {\n\t\treturn this[INTERNALS$2].method;\n\t}\n\n\tget url() {\n\t\treturn format_url(this[INTERNALS$2].parsedURL);\n\t}\n\n\tget headers() {\n\t\treturn this[INTERNALS$2].headers;\n\t}\n\n\tget redirect() {\n\t\treturn this[INTERNALS$2].redirect;\n\t}\n\n\tget signal() {\n\t\treturn this[INTERNALS$2].signal;\n\t}\n\n\t/**\n  * Clone this request\n  *\n  * @return  Request\n  */\n\tclone() {\n\t\treturn new Request(this);\n\t}\n}\n\nBody.mixIn(Request.prototype);\n\nObject.defineProperty(Request.prototype, Symbol.toStringTag, {\n\tvalue: 'Request',\n\twritable: false,\n\tenumerable: false,\n\tconfigurable: true\n});\n\nObject.defineProperties(Request.prototype, {\n\tmethod: { enumerable: true },\n\turl: { enumerable: true },\n\theaders: { enumerable: true },\n\tredirect: { enumerable: true },\n\tclone: { enumerable: true },\n\tsignal: { enumerable: true }\n});\n\n/**\n * Convert a Request to Node.js http request options.\n *\n * @param   Request  A Request instance\n * @return  Object   The options object to be passed to http.request\n */\nfunction getNodeRequestOptions(request) {\n\tconst parsedURL = request[INTERNALS$2].parsedURL;\n\tconst headers = new Headers(request[INTERNALS$2].headers);\n\n\t// fetch step 1.3\n\tif (!headers.has('Accept')) {\n\t\theaders.set('Accept', '*/*');\n\t}\n\n\t// Basic fetch\n\tif (!parsedURL.protocol || !parsedURL.hostname) {\n\t\tthrow new TypeError('Only absolute URLs are supported');\n\t}\n\n\tif (!/^https?:$/.test(parsedURL.protocol)) {\n\t\tthrow new TypeError('Only HTTP(S) protocols are supported');\n\t}\n\n\tif (request.signal && request.body instanceof Stream.Readable && !streamDestructionSupported) {\n\t\tthrow new Error('Cancellation of streamed requests with AbortSignal is not supported in node < 8');\n\t}\n\n\t// HTTP-network-or-cache fetch steps 2.4-2.7\n\tlet contentLengthValue = null;\n\tif (request.body == null && /^(POST|PUT)$/i.test(request.method)) {\n\t\tcontentLengthValue = '0';\n\t}\n\tif (request.body != null) {\n\t\tconst totalBytes = getTotalBytes(request);\n\t\tif (typeof totalBytes === 'number') {\n\t\t\tcontentLengthValue = String(totalBytes);\n\t\t}\n\t}\n\tif (contentLengthValue) {\n\t\theaders.set('Content-Length', contentLengthValue);\n\t}\n\n\t// HTTP-network-or-cache fetch step 2.11\n\tif (!headers.has('User-Agent')) {\n\t\theaders.set('User-Agent', 'node-fetch/1.0 (+https://github.com/bitinn/node-fetch)');\n\t}\n\n\t// HTTP-network-or-cache fetch step 2.15\n\tif (request.compress && !headers.has('Accept-Encoding')) {\n\t\theaders.set('Accept-Encoding', 'gzip,deflate');\n\t}\n\n\tlet agent = request.agent;\n\tif (typeof agent === 'function') {\n\t\tagent = agent(parsedURL);\n\t}\n\n\tif (!headers.has('Connection') && !agent) {\n\t\theaders.set('Connection', 'close');\n\t}\n\n\t// HTTP-network fetch step 4.2\n\t// chunked encoding is handled by Node.js\n\n\treturn Object.assign({}, parsedURL, {\n\t\tmethod: request.method,\n\t\theaders: exportNodeCompatibleHeaders(headers),\n\t\tagent\n\t});\n}\n\n/**\n * abort-error.js\n *\n * AbortError interface for cancelled requests\n */\n\n/**\n * Create AbortError instance\n *\n * @param   String      message      Error message for human\n * @return  AbortError\n */\nfunction AbortError(message) {\n  Error.call(this, message);\n\n  this.type = 'aborted';\n  this.message = message;\n\n  // hide custom error implementation details from end-users\n  Error.captureStackTrace(this, this.constructor);\n}\n\nAbortError.prototype = Object.create(Error.prototype);\nAbortError.prototype.constructor = AbortError;\nAbortError.prototype.name = 'AbortError';\n\n// fix an issue where \"PassThrough\", \"resolve\" aren't a named export for node <10\nconst PassThrough$1 = Stream.PassThrough;\nconst resolve_url = Url.resolve;\n\n/**\n * Fetch function\n *\n * @param   Mixed    url   Absolute url or Request instance\n * @param   Object   opts  Fetch options\n * @return  Promise\n */\nfunction fetch(url, opts) {\n\n\t// allow custom promise\n\tif (!fetch.Promise) {\n\t\tthrow new Error('native promise missing, set fetch.Promise to your favorite alternative');\n\t}\n\n\tBody.Promise = fetch.Promise;\n\n\t// wrap http.request into fetch\n\treturn new fetch.Promise(function (resolve, reject) {\n\t\t// build request object\n\t\tconst request = new Request(url, opts);\n\t\tconst options = getNodeRequestOptions(request);\n\n\t\tconst send = (options.protocol === 'https:' ? https : http).request;\n\t\tconst signal = request.signal;\n\n\t\tlet response = null;\n\n\t\tconst abort = function abort() {\n\t\t\tlet error = new AbortError('The user aborted a request.');\n\t\t\treject(error);\n\t\t\tif (request.body && request.body instanceof Stream.Readable) {\n\t\t\t\trequest.body.destroy(error);\n\t\t\t}\n\t\t\tif (!response || !response.body) return;\n\t\t\tresponse.body.emit('error', error);\n\t\t};\n\n\t\tif (signal && signal.aborted) {\n\t\t\tabort();\n\t\t\treturn;\n\t\t}\n\n\t\tconst abortAndFinalize = function abortAndFinalize() {\n\t\t\tabort();\n\t\t\tfinalize();\n\t\t};\n\n\t\t// send request\n\t\tconst req = send(options);\n\t\tlet reqTimeout;\n\n\t\tif (signal) {\n\t\t\tsignal.addEventListener('abort', abortAndFinalize);\n\t\t}\n\n\t\tfunction finalize() {\n\t\t\treq.abort();\n\t\t\tif (signal) signal.removeEventListener('abort', abortAndFinalize);\n\t\t\tclearTimeout(reqTimeout);\n\t\t}\n\n\t\tif (request.timeout) {\n\t\t\treq.once('socket', function (socket) {\n\t\t\t\treqTimeout = setTimeout(function () {\n\t\t\t\t\treject(new FetchError(`network timeout at: ${request.url}`, 'request-timeout'));\n\t\t\t\t\tfinalize();\n\t\t\t\t}, request.timeout);\n\t\t\t});\n\t\t}\n\n\t\treq.on('error', function (err) {\n\t\t\treject(new FetchError(`request to ${request.url} failed, reason: ${err.message}`, 'system', err));\n\t\t\tfinalize();\n\t\t});\n\n\t\treq.on('response', function (res) {\n\t\t\tclearTimeout(reqTimeout);\n\n\t\t\tconst headers = createHeadersLenient(res.headers);\n\n\t\t\t// HTTP fetch step 5\n\t\t\tif (fetch.isRedirect(res.statusCode)) {\n\t\t\t\t// HTTP fetch step 5.2\n\t\t\t\tconst location = headers.get('Location');\n\n\t\t\t\t// HTTP fetch step 5.3\n\t\t\t\tconst locationURL = location === null ? null : resolve_url(request.url, location);\n\n\t\t\t\t// HTTP fetch step 5.5\n\t\t\t\tswitch (request.redirect) {\n\t\t\t\t\tcase 'error':\n\t\t\t\t\t\treject(new FetchError(`redirect mode is set to error: ${request.url}`, 'no-redirect'));\n\t\t\t\t\t\tfinalize();\n\t\t\t\t\t\treturn;\n\t\t\t\t\tcase 'manual':\n\t\t\t\t\t\t// node-fetch-specific step: make manual redirect a bit easier to use by setting the Location header value to the resolved URL.\n\t\t\t\t\t\tif (locationURL !== null) {\n\t\t\t\t\t\t\t// handle corrupted header\n\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\theaders.set('Location', locationURL);\n\t\t\t\t\t\t\t} catch (err) {\n\t\t\t\t\t\t\t\t// istanbul ignore next: nodejs server prevent invalid response headers, we can't test this through normal request\n\t\t\t\t\t\t\t\treject(err);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'follow':\n\t\t\t\t\t\t// HTTP-redirect fetch step 2\n\t\t\t\t\t\tif (locationURL === null) {\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// HTTP-redirect fetch step 5\n\t\t\t\t\t\tif (request.counter >= request.follow) {\n\t\t\t\t\t\t\treject(new FetchError(`maximum redirect reached at: ${request.url}`, 'max-redirect'));\n\t\t\t\t\t\t\tfinalize();\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// HTTP-redirect fetch step 6 (counter increment)\n\t\t\t\t\t\t// Create a new Request object.\n\t\t\t\t\t\tconst requestOpts = {\n\t\t\t\t\t\t\theaders: new Headers(request.headers),\n\t\t\t\t\t\t\tfollow: request.follow,\n\t\t\t\t\t\t\tcounter: request.counter + 1,\n\t\t\t\t\t\t\tagent: request.agent,\n\t\t\t\t\t\t\tcompress: request.compress,\n\t\t\t\t\t\t\tmethod: request.method,\n\t\t\t\t\t\t\tbody: request.body,\n\t\t\t\t\t\t\tsignal: request.signal,\n\t\t\t\t\t\t\ttimeout: request.timeout\n\t\t\t\t\t\t};\n\n\t\t\t\t\t\t// HTTP-redirect fetch step 9\n\t\t\t\t\t\tif (res.statusCode !== 303 && request.body && getTotalBytes(request) === null) {\n\t\t\t\t\t\t\treject(new FetchError('Cannot follow redirect with body being a readable stream', 'unsupported-redirect'));\n\t\t\t\t\t\t\tfinalize();\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// HTTP-redirect fetch step 11\n\t\t\t\t\t\tif (res.statusCode === 303 || (res.statusCode === 301 || res.statusCode === 302) && request.method === 'POST') {\n\t\t\t\t\t\t\trequestOpts.method = 'GET';\n\t\t\t\t\t\t\trequestOpts.body = undefined;\n\t\t\t\t\t\t\trequestOpts.headers.delete('content-length');\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// HTTP-redirect fetch step 15\n\t\t\t\t\t\tresolve(fetch(new Request(locationURL, requestOpts)));\n\t\t\t\t\t\tfinalize();\n\t\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// prepare response\n\t\t\tres.once('end', function () {\n\t\t\t\tif (signal) signal.removeEventListener('abort', abortAndFinalize);\n\t\t\t});\n\t\t\tlet body = res.pipe(new PassThrough$1());\n\n\t\t\tconst response_options = {\n\t\t\t\turl: request.url,\n\t\t\t\tstatus: res.statusCode,\n\t\t\t\tstatusText: res.statusMessage,\n\t\t\t\theaders: headers,\n\t\t\t\tsize: request.size,\n\t\t\t\ttimeout: request.timeout,\n\t\t\t\tcounter: request.counter\n\t\t\t};\n\n\t\t\t// HTTP-network fetch step 12.1.1.3\n\t\t\tconst codings = headers.get('Content-Encoding');\n\n\t\t\t// HTTP-network fetch step 12.1.1.4: handle content codings\n\n\t\t\t// in following scenarios we ignore compression support\n\t\t\t// 1. compression support is disabled\n\t\t\t// 2. HEAD request\n\t\t\t// 3. no Content-Encoding header\n\t\t\t// 4. no content response (204)\n\t\t\t// 5. content not modified response (304)\n\t\t\tif (!request.compress || request.method === 'HEAD' || codings === null || res.statusCode === 204 || res.statusCode === 304) {\n\t\t\t\tresponse = new Response(body, response_options);\n\t\t\t\tresolve(response);\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// For Node v6+\n\t\t\t// Be less strict when decoding compressed responses, since sometimes\n\t\t\t// servers send slightly invalid responses that are still accepted\n\t\t\t// by common browsers.\n\t\t\t// Always using Z_SYNC_FLUSH is what cURL does.\n\t\t\tconst zlibOptions = {\n\t\t\t\tflush: zlib.Z_SYNC_FLUSH,\n\t\t\t\tfinishFlush: zlib.Z_SYNC_FLUSH\n\t\t\t};\n\n\t\t\t// for gzip\n\t\t\tif (codings == 'gzip' || codings == 'x-gzip') {\n\t\t\t\tbody = body.pipe(zlib.createGunzip(zlibOptions));\n\t\t\t\tresponse = new Response(body, response_options);\n\t\t\t\tresolve(response);\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// for deflate\n\t\t\tif (codings == 'deflate' || codings == 'x-deflate') {\n\t\t\t\t// handle the infamous raw deflate response from old servers\n\t\t\t\t// a hack for old IIS and Apache servers\n\t\t\t\tconst raw = res.pipe(new PassThrough$1());\n\t\t\t\traw.once('data', function (chunk) {\n\t\t\t\t\t// see http://stackoverflow.com/questions/37519828\n\t\t\t\t\tif ((chunk[0] & 0x0F) === 0x08) {\n\t\t\t\t\t\tbody = body.pipe(zlib.createInflate());\n\t\t\t\t\t} else {\n\t\t\t\t\t\tbody = body.pipe(zlib.createInflateRaw());\n\t\t\t\t\t}\n\t\t\t\t\tresponse = new Response(body, response_options);\n\t\t\t\t\tresolve(response);\n\t\t\t\t});\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// for br\n\t\t\tif (codings == 'br' && typeof zlib.createBrotliDecompress === 'function') {\n\t\t\t\tbody = body.pipe(zlib.createBrotliDecompress());\n\t\t\t\tresponse = new Response(body, response_options);\n\t\t\t\tresolve(response);\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// otherwise, use response as-is\n\t\t\tresponse = new Response(body, response_options);\n\t\t\tresolve(response);\n\t\t});\n\n\t\twriteToStream(req, request);\n\t});\n}\n/**\n * Redirect code matching\n *\n * @param   Number   code  Status code\n * @return  Boolean\n */\nfetch.isRedirect = function (code) {\n\treturn code === 301 || code === 302 || code === 303 || code === 307 || code === 308;\n};\n\n// expose Promise\nfetch.Promise = global.Promise;\n\nexport default fetch;\nexport { Headers, Request, Response, FetchError };\n","import { Parser } from 'htmlparser2';\n\n// export const NO_CHILDS = ['title','base','meta','link','img','br','input',];\n// const SKIP = ['html','head','title','base','meta','script','link','body',];\n// document.createComment = nodeValue => { return new RxComment(null, nodeValue); };\n// document.createTextNode = nodeValue => { return new RxText(null, nodeValue); };\n\nexport enum RxNodeType {\n\tELEMENT_NODE = 1, //\tUn nodo Element come <p> o <div>.\n\tTEXT_NODE = 3, //\tL'attuale Text dentro un Element o Attr.\n\tCDATA_SECTION_NODE = 4, //\tUna CDATASection, ad esempio <!CDATA[[  ]]>.\n\tPROCESSING_INSTRUCTION_NODE = 7, //\tUna ProcessingInstruction di un documento XML, come <?xml-stylesheet  ?>.\n\tCOMMENT_NODE = 8, //\tUn nodo Comment, come <!--  -->.\n\tDOCUMENT_NODE = 9, //\tUn nodo Document.\n\tDOCUMENT_TYPE_NODE = 10, //\tUn nodo DocumentType, come <!DOCTYPE html>.\n\tDOCUMENT_FRAGMENT_NODE = 11, //\tUn nodo DocumentFragment.\n}\n\nexport enum SelectorType {\n\tNone = -1,\n\tId = 0,\n\tClass = 1,\n\tAttribute = 2,\n\tTagName = 3,\n}\n\nexport function isRxElement(x: RxNode): x is RxElement {\n\treturn x.nodeType === RxNodeType.ELEMENT_NODE;\n}\n\nexport function isRxText(x: RxNode): x is RxText {\n\treturn x.nodeType === RxNodeType.TEXT_NODE;\n}\n\nexport function isRxComment(x: RxNode): x is RxComment {\n\treturn x.nodeType === RxNodeType.COMMENT_NODE;\n}\n\nexport function isRxDocument(x: RxNode): x is RxDocument {\n\treturn x.nodeType === RxNodeType.DOCUMENT_NODE;\n}\n\nexport function isRxDocumentFragment(x: RxNode): x is RxDocumentFragment {\n\treturn x.nodeType === RxNodeType.DOCUMENT_FRAGMENT_NODE;\n}\n\nexport function isRxDocumentType(x: RxNode): x is RxDocumentType {\n\treturn x.nodeType === RxNodeType.DOCUMENT_TYPE_NODE;\n}\n\nexport function isRxProcessingInstruction(x: RxNode): x is RxProcessingInstruction {\n\treturn x.nodeType === RxNodeType.PROCESSING_INSTRUCTION_NODE;\n}\n\nexport function parse(html: string) {\n\tconst doc = new RxDocument();\n\tlet parentNode: RxElement = doc,\n\t\tnode;\n\tconst parser = new Parser(\n\t\t{\n\t\t\tonopentag: (nodeName, attributes) => {\n\t\t\t\t// console.log(nodeName);\n\t\t\t\tnode = new RxElement(parentNode, nodeName, attributes);\n\t\t\t\tparentNode.childNodes.push(node);\n\t\t\t\tparentNode = node;\n\t\t\t\t// if (NO_CHILDS.indexOf(nodeName) === -1) {\n\t\t\t\t//\tconsole.log(nodeName);\n\t\t\t\t//\tparentNode = node;\n\t\t\t\t// }\n\t\t\t},\n\t\t\tonclosetag: (nodeName) => {\n\t\t\t\tif (parentNode.parentNode) {\n\t\t\t\t\tparentNode = parentNode.parentNode;\n\t\t\t\t}\n\t\t\t},\n\t\t\tontext: (nodeValue) => {\n\t\t\t\t// console.log('ontext', nodeValue);\n\t\t\t\t// if (nodeValue.length) {\n\t\t\t\tconst textNode = new RxText(parentNode, nodeValue);\n\t\t\t\tparentNode.childNodes.push(textNode);\n\t\t\t\t// }\n\t\t\t},\n\t\t\tonprocessinginstruction: (nodeName, nodeValue) => {\n\t\t\t\t// console.log('onprocessinginstruction', nodeName, nodeValue);\n\t\t\t\tif (nodeName === '!doctype') {\n\t\t\t\t\tnode = new RxDocumentType(parentNode, nodeValue);\n\t\t\t\t} else {\n\t\t\t\t\tnode = new RxProcessingInstruction(parentNode, nodeValue);\n\t\t\t\t}\n\t\t\t\tparentNode.childNodes.push(node);\n\t\t\t},\n\t\t\toncomment: nodeValue => {\n\t\t\t\t// console.log('oncomment', nodeValue);\n\t\t\t\tnode = new RxComment(parentNode, nodeValue);\n\t\t\t\tparentNode.childNodes.push(node);\n\t\t\t\t// parentNode = node;\n\t\t\t},\n\t\t\toncommentend: () => {\n\t\t\t\t// console.log('oncommentend');\n\t\t\t\t// parentNode = parentNode.parentNode;\n\t\t\t},\n\t\t\toncdatastart: () => {\n\t\t\t\tconsole.log('oncdatastart');\n\t\t\t},\n\t\t\toncdataend: () => {\n\t\t\t\tconsole.log('oncdataend');\n\t\t\t},\n\t\t\tonerror: error => {\n\t\t\t\tconsole.log('error', error);\n\t\t\t},\n\t\t\t/*\n\t\t\tonopentagname: (name) => {\n\t\t\t\tconsole.log('onopentagname', name);\n\t\t\t},\n\t\t\tonattribute: (name, value) => {\n\t\t\t\tconsole.log('onattribute', name, value);\n\t\t\t},\n\t\t\tonreset: () => {\n\t\t\t\tconsole.log('reset');\n\t\t\t},\n\t\t\tonend: () => {\n\t\t\t\tconsole.log('end');\n\t\t\t},\n\t\t\t*/\n\t\t},\n\t\t{\n\t\t\tdecodeEntities: false,\n\t\t\tlowerCaseTags: true,\n\t\t}\n\t);\n\tparser.write(html);\n\tparser.end();\n\treturn doc;\n}\n\nexport function getQueries(selector: string): RxQuery[] {\n\tconst queries: RxQuery[] = [];\n\tselector\n\t\t.trim()\n\t\t.split(' ')\n\t\t.forEach((x: string) => {\n\t\t\tx.trim()\n\t\t\t\t.split('>')\n\t\t\t\t.forEach((x, i) => {\n\t\t\t\t\t// const regex = /\\.([^\\.[]+)|\\[([^\\.\\[]+)\\]|([^\\.\\[\\]]+)/g;\n\t\t\t\t\t// const regex = /\\#([^\\.[#]+)|\\.([^\\.[#]+)|\\[([^\\.\\[#]+)\\]|([^\\.\\[#\\]]+)/g;\n\t\t\t\t\tconst regex = /\\:not\\(\\#([^\\.[#:]+)\\)|\\:not\\(\\.([^\\.[#:]+)\\)|\\:not\\(\\[([^\\.\\[#:]+)\\]\\)|\\:not\\(([^\\.\\[#:\\]]+)\\)|\\#([^\\.[#:]+)|\\.([^\\.[#:]+)|\\[([^\\.\\[#:]+)\\]|([^\\.\\[#:\\]]+)/g;\n\t\t\t\t\t/* eslint no-useless-escape: \"off\" */\n\t\t\t\t\tconst selectors = [];\n\t\t\t\t\tconst matches = x.matchAll(regex);\n\t\t\t\t\tfor (const match of matches) {\n\t\t\t\t\t\tif (match[1]) {\n\t\t\t\t\t\t\tselectors.push({ selector: match[1], type: SelectorType.Id, negate: true });\n\t\t\t\t\t\t} else if (match[2]) {\n\t\t\t\t\t\t\tselectors.push({ selector: match[2], type: SelectorType.Class, negate: true });\n\t\t\t\t\t\t} else if (match[3]) {\n\t\t\t\t\t\t\tselectors.push({ selector: match[3], type: SelectorType.Attribute, negate: true });\n\t\t\t\t\t\t} else if (match[4]) {\n\t\t\t\t\t\t\tselectors.push({ selector: match[4], type: SelectorType.TagName, negate: true });\n\t\t\t\t\t\t} else if (match[5]) {\n\t\t\t\t\t\t\tselectors.push({ selector: match[5], type: SelectorType.Id, negate: false });\n\t\t\t\t\t\t} else if (match[6]) {\n\t\t\t\t\t\t\tselectors.push({ selector: match[6], type: SelectorType.Class, negate: false });\n\t\t\t\t\t\t} else if (match[7]) {\n\t\t\t\t\t\t\tselectors.push({ selector: match[7], type: SelectorType.Attribute, negate: false });\n\t\t\t\t\t\t} else if (match[8]) {\n\t\t\t\t\t\t\tselectors.push({ selector: match[8], type: SelectorType.TagName, negate: false });\n\t\t\t\t\t\t}\n\t\t\t\t\t\t// console.log('match', match);\n\t\t\t\t\t}\n\t\t\t\t\tconst selector =\n\t\t\t\t\t\ti > 0\n\t\t\t\t\t\t\t? { selector: x, selectors, inner: true }\n\t\t\t\t\t\t\t: { selector: x, selectors, inner: false };\n\t\t\t\t\tqueries.push.call(queries, selector);\n\t\t\t\t});\n\t\t});\n\treturn queries;\n}\n\nexport function matchSelector(child: RxElement, selector: RxSelector): boolean {\n\tswitch (selector.type) {\n\t\tcase SelectorType.Id:\n\t\t\treturn (selector.selector !== '' && child.attributes.id === selector.selector) !== selector.negate;\n\t\tcase SelectorType.Class:\n\t\t\treturn (child.classList.indexOf(selector.selector) !== -1) !== selector.negate;\n\t\tcase SelectorType.Attribute:\n\t\t\treturn (Object.keys(child.attributes).indexOf(selector.selector) !== -1) !== selector.negate;\n\t\tcase SelectorType.TagName:\n\t\t\treturn (child.nodeName === selector.selector) !== selector.negate;\n\t\tdefault:\n\t\t\treturn false;\n\t}\n}\n\nexport function matchSelectors(child: RxElement, selectors: RxSelector[]): boolean {\n\treturn selectors.reduce(function (p: boolean, selector: RxSelector) {\n\t\treturn p && matchSelector(child, selector);\n\t}, true);\n}\n\nexport function querySelectorAll(queries: RxQuery[], childNodes: RxNode[], query: RxQuery | null = null, nodes: RxElement[] = []): RxElement[] | null {\n\tif (query || queries.length) {\n\t\tquery = query || queries.shift() as RxQuery;\n\t\tfor (let child of childNodes) {\n\t\t\tif (child instanceof RxElement) {\n\t\t\t\tif (matchSelectors(child, query.selectors)) {\n\t\t\t\t\t// console.log(query);\n\t\t\t\t\tif (queries.length) {\n\t\t\t\t\t\tconst results: RxElement[] | null = querySelectorAll(queries, child.childNodes);\n\t\t\t\t\t\tif (results) {\n\t\t\t\t\t\t\tArray.prototype.push.apply(nodes, results);\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tnodes.push(child);\n\t\t\t\t\t}\n\t\t\t\t} else if (!query.inner) {\n\t\t\t\t\tconst results: RxElement[] | null = querySelectorAll(queries, child.childNodes, query);\n\t\t\t\t\tif (results) {\n\t\t\t\t\t\tArray.prototype.push.apply(nodes, results);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\treturn nodes.length ? nodes : null;\n}\n\nexport function querySelector(queries: RxQuery[], childNodes: RxNode[], query: RxQuery | null = null): RxElement | null {\n\tlet node = null;\n\tif (query || queries.length) {\n\t\tquery = query || queries.shift() as RxQuery;\n\t\tfor (let child of childNodes) {\n\t\t\tif (child instanceof RxElement) {\n\t\t\t\tif (matchSelectors(child, query.selectors)) {\n\t\t\t\t\t// console.log(query);\n\t\t\t\t\tif (queries.length) {\n\t\t\t\t\t\treturn querySelector(queries, child.childNodes);\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn child;\n\t\t\t\t\t}\n\t\t\t\t} else if (!query.inner) {\n\t\t\t\t\tnode = querySelector(queries, child.childNodes, query);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\treturn node;\n}\n\nexport function cloneNode(source: RxNode, deep: boolean = false, parentNode: RxElement | null = null): RxNode {\n\tlet node: RxNode;\n\tif (isRxElement(source)) {\n\t\tconst nodeElement: RxElement = new RxElement(\n\t\t\tparentNode,\n\t\t\tsource.nodeName,\n\t\t\tObject.assign({}, source.attributes),\n\t\t);\n\t\tif (deep) {\n\t\t\tnodeElement.childNodes = source.childNodes.map(x => cloneNode.apply(x, [x, deep, nodeElement]));\n\t\t}\n\t\tnode = nodeElement;\n\t} else if (isRxDocumentFragment(source)) {\n\t\tconst nodeDocumentFragment: RxDocumentFragment = new RxDocumentFragment();\n\t\tif (deep) {\n\t\t\tnodeDocumentFragment.childNodes = source.childNodes.map(x => cloneNode.apply(x, [x, deep, nodeDocumentFragment]));\n\t\t}\n\t\tnode = nodeDocumentFragment;\n\t} else if (isRxText(source)) {\n\t\tnode = new RxText(parentNode, source.nodeValue);\n\t} else if (isRxComment(source)) {\n\t\tnode = new RxComment(parentNode, source.nodeValue);\n\t} else if (isRxDocument(source)) {\n\t\tconst documentElement: RxDocument = new RxDocument();\n\t\tif (deep) {\n\t\t\tdocumentElement.childNodes = source.childNodes.map(x => cloneNode.apply(x, [x, deep, documentElement]));\n\t\t}\n\t\tnode = documentElement;\n\t} else {\n\t\tthrow ('Invalid node type');\n\t}\n\treturn node;\n}\n\nexport class RxSelector {\n\tselector: string = '';\n\ttype: SelectorType = SelectorType.None;\n\tnegate: boolean = false;\n\tconstructor(options: RxSelector) {\n\t\tif (options) {\n\t\t\tObject.assign(this, options);\n\t\t}\n\t}\n}\n\nexport class RxQuery {\n\tselector: string = '';\n\tselectors: RxSelector[] = [];\n\tinner: boolean = false;\n\tconstructor(options: RxQuery) {\n\t\tif (options) {\n\t\t\tObject.assign(this, options);\n\t\t}\n\t}\n}\n\nexport class RxNode {\n\tparentNode: RxElement | null;\n\tnodeType: RxNodeType;\n\tnodeValue: string | null = null;\n\n\tconstructor(parentNode: RxElement | null = null) {\n\t\tthis.parentNode = parentNode;\n\t\tthis.nodeType = -1;\n\t}\n\tcloneNode(deep: boolean = false) {\n\t\treturn cloneNode.apply(this, [this, deep]);\n\t}\n\tserialize(): string {\n\t\treturn ``;\n\t}\n}\n\nexport class RxStyle {\n\t[key: string]: any;\n\titem(index: number): string | undefined {\n\t\tconst keys = Object.keys(this);\n\t\tif (keys.length > index) {\n\t\t\treturn keys[index];\n\t\t} else {\n\t\t\treturn undefined;\n\t\t}\n\t}\n\tgetPropertyPriority(key: string): string {\n\t\tconst value = this[key];\n\t\tif (value && value.indexOf('!important')) {\n\t\t\treturn 'important';\n\t\t} else {\n\t\t\treturn '';\n\t\t}\n\t}\n\tgetPropertyValue(key: string): string {\n\t\treturn this[key];\n\t}\n\tsetProperty(key: string, value: string, important: 'important' | '' | undefined) {\n\t\tthis[key] = value + (important === 'important' ? '!important' : '');\n\t\tthis.serialize_();\n\t}\n\tremoveProperty(key: string) {\n\t\tdelete this[key];\n\t\tthis.serialize_();\n\t}\n\tprivate serialize_() {\n\t\tthis.node.attributes.style = Object.keys(this).map(key => {\n\t\t\treturn `${key}: ${this[key]};`;\n\t\t}).join(' ');\n\t}\n\tinit() {\n\t\tconst keys = Object.keys(this);\n\t\tkeys.forEach(key => delete this[key]);\n\t\tif (this.node.attributes?.style) {\n\t\t\tconst regex: RegExp = /([^:]+):([^;]+);?\\s*/gm\n\t\t\tconst matches: RegExpMatchArray[] = [...this.node.attributes.style.matchAll(regex)];\n\t\t\tmatches.forEach((match: RegExpMatchArray) => {\n\t\t\t\tconst key: string = match[1];\n\t\t\t\tconst value: string = match[2];\n\t\t\t\tthis[key] = value;\n\t\t\t});\n\t\t}\n\t}\n\tconstructor(node: RxElement) {\n\t\tObject.defineProperty(this, 'node', {\n\t\t\tvalue: node,\n\t\t\twritable: false,\n\t\t\tenumerable: false\n\t\t});\n\t\tthis.init();\n\t}\n}\n\nexport class RxClassList extends Array<string> {\n\tnode: RxElement;\n\titem(index: number) {\n\t\treturn this[index];\n\t}\n\tcontains(name: string): boolean {\n\t\treturn this.indexOf(name) !== -1;\n\t}\n\tadd(...names: string[]) {\n\t\tnames.forEach(name => {\n\t\t\tif (this.indexOf(name) !== -1) {\n\t\t\t\tthis.push(name);\n\t\t\t}\n\t\t});\n\t\tthis.serialize_();\n\t}\n\tremove(...names: string[]) {\n\t\tnames.forEach(name => {\n\t\t\tconst index: number = this.indexOf(name);\n\t\t\tif (index !== -1) {\n\t\t\t\tthis.splice(index, 1);\n\t\t\t}\n\t\t});\n\t\tthis.serialize_();\n\t}\n\ttoggle(name: string, force?: boolean): boolean {\n\t\tconst index: number = this.indexOf(name);\n\t\tif (force === false) {\n\t\t\tthis.splice(index, 1);\n\t\t\tthis.serialize_();\n\t\t\treturn false;\n\t\t} else if (force === true) {\n\t\t\tthis.push(name);\n\t\t\tthis.serialize_();\n\t\t\treturn true;\n\t\t} else if (index !== -1) {\n\t\t\tthis.splice(index, 1);\n\t\t\tthis.serialize_();\n\t\t\treturn false;\n\t\t} else {\n\t\t\tthis.push(name);\n\t\t\tthis.serialize_();\n\t\t\treturn true;\n\t\t}\n\t}\n\treplace(oldClass: string, newClass: string) {\n\t\tconst index: number = this.indexOf(oldClass);\n\t\tif (index !== -1) {\n\t\t\tthis.splice(index, 1);\n\t\t}\n\t\tthis.push(newClass);\n\t\tthis.serialize_();\n\t}\n\tprivate serialize_() {\n\t\tthis.node.attributes.class = this.join(' ');\n\t}\n\tinit() {\n\t\tthis.length = 0;\n\t\tif (this.node.attributes?.class) {\n\t\t\tArray.prototype.push.apply(this, this.node.attributes.class.split(' ').map(name => name.trim()));\n\t\t}\n\t}\n\tconstructor(node: RxElement) {\n\t\tsuper();\n\t\tthis.node = node;\n\t\tthis.init();\n\t}\n}\n\nexport class RxElement extends RxNode {\n\tnodeName: string;\n\tchildNodes: RxNode[];\n\tattributes: { [key: string]: string | null } = {};\n\tstyle: RxStyle;\n\tclassList: RxClassList;\n\tget children(): RxElement[] {\n\t\tlet children: RxElement[] = [],\n\t\t\ti = 0,\n\t\t\tnode,\n\t\t\tnodes = this.childNodes;\n\t\tnode = nodes[i++];\n\t\twhile (node) {\n\t\t\tnode = nodes[i++];\n\t\t\tif (node.nodeType === RxNodeType.ELEMENT_NODE) {\n\t\t\t\tchildren.push(node as RxElement);\n\t\t\t}\n\t\t}\n\t\treturn children;\n\t}\n\tget childElementCount(): number {\n\t\tlet i = 0,\n\t\t\tcount = 0,\n\t\t\tnode,\n\t\t\tnodes = this.childNodes;\n\t\tnode = nodes[i++];\n\t\twhile (node) {\n\t\t\tif (node.nodeType === RxNodeType.ELEMENT_NODE) {\n\t\t\t\tcount++;\n\t\t\t}\n\t\t\tnode = nodes[i++];\n\t\t}\n\t\treturn count;\n\t}\n\tget firstChild(): RxNode | null {\n\t\tlet node = null;\n\t\tif (this.childNodes.length) {\n\t\t\tnode = this.childNodes[0];\n\t\t}\n\t\treturn node;\n\t}\n\tget firstElementChild(): RxElement | null {\n\t\tfor (let node of this.childNodes) {\n\t\t\tif (isRxElement(node)) {\n\t\t\t\treturn node;\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t}\n\tget lastChild(): RxNode | null {\n\t\tlet node = null;\n\t\tif (this.childNodes.length) {\n\t\t\tnode = this.childNodes[this.childNodes.length - 1];\n\t\t}\n\t\treturn node;\n\t}\n\tget lastElementChild(): RxElement | null {\n\t\tconst nodes = this.childNodes;\n\t\tfor (let i = nodes.length - 1; i > -1; i--) {\n\t\t\tconst node = nodes[i];\n\t\t\tif (isRxElement(node)) {\n\t\t\t\treturn node;\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t}\n\tget previousSibling(): RxNode | null {\n\t\tlet node = null;\n\t\tif (this.parentNode) {\n\t\t\tconst index = this.parentNode.childNodes.indexOf(this);\n\t\t\tif (index > 0) {\n\t\t\t\tnode = this.parentNode.childNodes[index - 1];\n\t\t\t}\n\t\t}\n\t\treturn node;\n\t}\n\tget nextSibling(): RxNode | null {\n\t\tlet node = null;\n\t\tif (this.parentNode) {\n\t\t\tconst index = this.parentNode.childNodes.indexOf(this);\n\t\t\tif (index !== -1 && index < this.parentNode.childNodes.length - 1) {\n\t\t\t\tnode = this.parentNode.childNodes[index];\n\t\t\t}\n\t\t}\n\t\treturn node;\n\t}\n\tget wholeText() {\n\t\tlet nodeValue;\n\t\tif (this.nodeType === RxNodeType.TEXT_NODE) {\n\t\t\treturn this.nodeValue;\n\t\t}\n\t\treturn nodeValue;\n\t}\n\tget outerHTML(): string | null {\n\t\tlet html = null;\n\t\tif (this.parentNode) {\n\t\t\thtml = this.parentNode.serialize();\n\t\t}\n\t\treturn html;\n\t}\n\tset innerText(nodeValue: string | null) {\n\t\tthis.childNodes = [new RxText(this, nodeValue)];\n\t}\n\tget innerText(): string | null {\n\t\t// return this.childNodes.filter((n): n is RxText => isRxText(n)).map(n => n.innerText).join('');\n\t\treturn this.childNodes.filter((n): n is RxText | RxElement => isRxText(n) || isRxElement(n)).map(n => n.innerText).join('');\n\t}\n\tset textContent(nodeValue: string | null) {\n\t\tthis.innerText = String(nodeValue);\n\t}\n\tget textContent(): string | null {\n\t\treturn this.innerText;\n\t}\n\tget innerHTML(): string {\n\t\treturn this.childNodes.map(x => x.serialize()).join('');\n\t}\n\tset innerHTML(html: string) {\n\t\tconst doc = parse(html);\n\t\tconst childNodes = doc.childNodes.map(n => {\n\t\t\tn.parentNode = this;\n\t\t\treturn n;\n\t\t});\n\t\tthis.childNodes = childNodes;\n\t}\n\tconstructor(parentNode: RxElement | null = null, nodeName: string, attributes: { [key: string]: string | null } | null = null) {\n\t\tsuper(parentNode);\n\t\tthis.nodeType = RxNodeType.ELEMENT_NODE;\n\t\tthis.nodeName = nodeName;\n\t\tif (attributes && typeof attributes === 'object') {\n\t\t\tthis.attributes = attributes;\n\t\t}\n\t\tthis.style = new RxStyle(this);\n\t\tthis.classList = new RxClassList(this);\n\t\tthis.childNodes = [];\n\t\t/*\n\t\t\tif (SKIP.indexOf(nodeName) === -1) {\n\t\t\t\tconsole.log(parentNode.nodeName, '>', nodeName);\n\t\t}\n\t\t*/\n\t}\n\tappend(...nodesOrDOMStrings: (RxNode | string)[]) {\n\t\tnodesOrDOMStrings = nodesOrDOMStrings.map(nodeOrDomString => {\n\t\t\tlet node;\n\t\t\tif (typeof nodeOrDomString === 'string') {\n\t\t\t\tnode = new RxText(this, nodeOrDomString);\n\t\t\t} else {\n\t\t\t\tnode = nodeOrDomString;\n\t\t\t\tnode.parentNode = this;\n\t\t\t}\n\t\t\treturn node;\n\t\t});\n\t\tArray.prototype.push.apply(this.childNodes, nodesOrDOMStrings);\n\t\t/*\n\t\tfor (let nodeOrDomString of nodesOrDOMStrings) {\n\t\t\t\tlet node;\n\t\t\t\tif (typeof nodeOrDomString === 'string') {\n\t\t\t\t\tnode = new RxText(this, nodeOrDomString);\n\t\t\t\t} else {\n\t\t\t\t\tnode = nodeOrDomString;\n\t\t\t\t}\n\t\t\t\tthis.childNodes.push(node);\n\t\t}\n\t\t*/\n\t}\n\tprepend(...nodesOrDOMStrings: (RxNode | string)[]) {\n\t\tnodesOrDOMStrings = nodesOrDOMStrings.map(nodeOrDomString => {\n\t\t\tlet node;\n\t\t\tif (typeof nodeOrDomString === 'string') {\n\t\t\t\tnode = new RxText(this, nodeOrDomString);\n\t\t\t} else {\n\t\t\t\tnode = nodeOrDomString;\n\t\t\t\tnode.parentNode = this;\n\t\t\t}\n\t\t\treturn node;\n\t\t});\n\t\tArray.prototype.unshift.apply(this.childNodes, nodesOrDOMStrings);\n\t\t/*\n\t\t\tfor (let nodeOrDomString of nodesOrDOMStrings) {\n\t\t\t\tlet node;\n\t\t\t\tif (typeof nodeOrDomString === 'string') {\n\t\t\t\t\tnode = new RxText(this, nodeOrDomString);\n\t\t\t\t} else {\n\t\t\t\t\tnode = nodeOrDomString;\n\t\t\t\t}\n\t\t\t\tthis.childNodes.unshift(node);\n\t\t}\n\t\t*/\n\t}\n\treplaceChildren(...nodesOrDOMStrings: (RxNode | string)[]) {\n\t\tconst nodes: RxNode[] = nodesOrDOMStrings.map((nodeOrDomString) => {\n\t\t\tlet node: RxNode;\n\t\t\tif (typeof nodeOrDomString === 'string') {\n\t\t\t\tnode = new RxText(this, nodeOrDomString);\n\t\t\t} else {\n\t\t\t\tnode = nodeOrDomString as RxNode;\n\t\t\t\tnode.parentNode = this;\n\t\t\t}\n\t\t\treturn node;\n\t\t});\n\t\tthis.childNodes = nodes;\n\t}\n\tquerySelectorAll(selector: string): RxNode[] | null {\n\t\tconst queries = getQueries(selector);\n\t\tconst nodes = this.childNodes.filter(x => {\n\t\t\treturn true;\n\t\t});\n\t\tconsole.log(queries);\n\t\treturn nodes.length ? nodes : null;\n\t}\n\tquerySelector(selector: string): RxNode | null {\n\t\tconst queries = getQueries(selector);\n\t\tconst node = querySelector(queries, this.childNodes);\n\t\treturn node;\n\t}\n\thasAttribute(attribute: string): boolean {\n\t\treturn Object.keys(this.attributes).indexOf(attribute.toLowerCase()) !== -1;\n\t}\n\tgetAttribute(attribute: string): string | null {\n\t\treturn this.attributes[attribute.toLowerCase()] || null;\n\t}\n\tsetAttribute(attribute: string, value: any) {\n\t\tthis.attributes[attribute.toLowerCase()] = value.toString();\n\t\tif (attribute === 'style') {\n\t\t\tthis.style.init();\n\t\t} else if (attribute === 'class') {\n\t\t\tthis.classList.init();\n\t\t}\n\t}\n\tremoveAttribute(attribute: string) {\n\t\tdelete this.attributes[attribute];\n\t\tif (attribute === 'style') {\n\t\t\tthis.style.init();\n\t\t} else if (attribute === 'class') {\n\t\t\tthis.classList.init();\n\t\t}\n\t}\n\treplaceChild(newChild: RxNode, oldChild: RxNode): RxNode {\n\t\tconst index = this.childNodes.indexOf(oldChild);\n\t\tif (index !== -1) {\n\t\t\tthis.childNodes[index] = newChild;\n\t\t\tnewChild.parentNode = this;\n\t\t}\n\t\t// console.log('replaceChild', this, newChild, oldChild);\n\t\treturn oldChild;\n\t}\n\tremoveChild(child: RxNode): RxNode {\n\t\tif (!(child instanceof RxNode)) {\n\t\t\tthrow (`Uncaught TypeError: Failed to execute 'removeChild' on 'Node': parameter 1 is not of type 'Node'.`);\n\t\t}\n\t\tconst index = this.childNodes.indexOf(child);\n\t\tif (index === -1) {\n\t\t\tthrow (`Uncaught NotFoundError: Failed to execute 'removeChild' on 'Node': The node to be removed is not a child of this node.`);\n\t\t}\n\t\tthis.childNodes.splice(index, 1);\n\t\t// console.log('removeChild', this.childNodes.length);\n\t\treturn child;\n\t}\n\tinsertBefore(newNode: RxNode, referenceNode: RxNode | null = null): RxNode {\n\t\tconst index = referenceNode\n\t\t\t? this.childNodes.indexOf(referenceNode)\n\t\t\t: this.childNodes.length;\n\t\tif (index !== -1) {\n\t\t\tthis.childNodes.splice(index, 0, newNode);\n\t\t\tnewNode.parentNode = this;\n\t\t}\n\t\t// console.log('insertBefore', this, newNode, referenceNode);\n\t\treturn newNode;\n\t}\n\tcloneNode(deep: boolean = false) {\n\t\treturn cloneNode.apply(this, [this, deep]);\n\t}\n\taddListener(eventName: string, handler: (e: any) => {}) { }\n\tremoveListener(eventName: string, handler: (e: any) => {}) { }\n\tserialize(): string {\n\t\treturn `<${\n\t\t\tthis.nodeName\n\t\t\t}${this.serializeAttributes()}>${this.childNodes\n\t\t\t\t.map(x => x.serialize())\n\t\t\t\t.join('')}</${this.nodeName}>`;\n\t}\n\tserializeAttributes(): string {\n\t\tlet attributes = '';\n\t\tconst keys = Object.keys(this.attributes);\n\t\tif (keys.length) {\n\t\t\tattributes =\n\t\t\t\t' ' +\n\t\t\t\tkeys\n\t\t\t\t\t.map(k => {\n\t\t\t\t\t\treturn `${k}=\"${this.attributes[k]}\"`;\n\t\t\t\t\t})\n\t\t\t\t\t.join(' ');\n\t\t}\n\t\treturn attributes;\n\t}\n}\n\nexport class RxText extends RxNode {\n\tnodeValue: string;\n\tget outerHTML(): string | null {\n\t\tlet html = null;\n\t\tif (this.parentNode) {\n\t\t\thtml = this.parentNode.serialize();\n\t\t}\n\t\treturn html;\n\t}\n\tget wholeText(): string | null {\n\t\treturn this.nodeValue;\n\t}\n\tset innerText(nodeValue) {\n\t\tthis.nodeValue = String(nodeValue);\n\t}\n\tget innerText(): string | null {\n\t\treturn this.nodeValue;\n\t}\n\tset textContent(nodeValue) {\n\t\tthis.nodeValue = String(nodeValue);\n\t}\n\tget textContent(): string | null {\n\t\treturn this.nodeValue;\n\t}\n\tconstructor(parentNode: RxElement | null = null, nodeValue: any) {\n\t\tsuper(parentNode);\n\t\tthis.nodeType = RxNodeType.TEXT_NODE;\n\t\tthis.nodeValue = String(nodeValue);\n\t\t// console.log('RxText', nodeValue);\n\t}\n\tserialize(): string {\n\t\treturn this.nodeValue;\n\t}\n}\n\nexport class RxCData extends RxNode {\n\tnodeValue: string;\n\tget outerHTML(): string | null {\n\t\tlet html = null;\n\t\tif (this.parentNode) {\n\t\t\thtml = this.parentNode.serialize();\n\t\t}\n\t\treturn html;\n\t}\n\tget wholeText(): string | null {\n\t\treturn this.nodeValue;\n\t}\n\tset innerText(nodeValue) {\n\t\tthis.nodeValue = String(nodeValue);\n\t}\n\tget innerText(): string | null {\n\t\treturn this.nodeValue;\n\t}\n\tset textContent(nodeValue) {\n\t\tthis.nodeValue = String(nodeValue);\n\t}\n\tget textContent(): string | null {\n\t\treturn this.nodeValue;\n\t}\n\tconstructor(parentNode: RxElement | null = null, nodeValue: any) {\n\t\tsuper(parentNode);\n\t\tthis.nodeType = RxNodeType.CDATA_SECTION_NODE;\n\t\tthis.nodeValue = String(nodeValue);\n\t}\n\tserialize(): string {\n\t\treturn this.nodeValue;\n\t}\n}\n\nexport class RxComment extends RxNode {\n\tnodeValue: string;\n\tget outerHTML(): string | null {\n\t\tlet html = null;\n\t\tif (this.parentNode) {\n\t\t\thtml = this.parentNode.serialize();\n\t\t}\n\t\treturn html;\n\t}\n\tget wholeText(): string | null {\n\t\treturn this.nodeValue;\n\t}\n\tset innerText(nodeValue) {\n\t\tthis.nodeValue = String(nodeValue);\n\t}\n\tget innerText(): string | null {\n\t\treturn this.nodeValue;\n\t}\n\tset textContent(nodeValue) {\n\t\tthis.nodeValue = String(nodeValue);\n\t}\n\tget textContent(): string | null {\n\t\treturn this.nodeValue;\n\t}\n\tconstructor(parentNode: RxElement | null = null, nodeValue: any) {\n\t\tsuper(parentNode);\n\t\tthis.nodeType = RxNodeType.COMMENT_NODE;\n\t\tthis.nodeValue = String(nodeValue);\n\t}\n\tserialize(): string {\n\t\treturn `<!--${this.nodeValue}-->`;\n\t}\n}\n\nexport class RxProcessingInstruction extends RxNode {\n\tconstructor(parentNode: RxElement | null = null, nodeValue: any) {\n\t\tsuper(parentNode);\n\t\tthis.nodeType = RxNodeType.PROCESSING_INSTRUCTION_NODE;\n\t\tthis.nodeValue = String(nodeValue);\n\t}\n\tserialize(): string {\n\t\treturn `<${this.nodeValue}>`;\n\t}\n}\n\nexport class RxDocumentType extends RxNode {\n\tconstructor(parentNode: RxElement | null = null, nodeValue: any) {\n\t\tsuper(parentNode);\n\t\tthis.nodeType = RxNodeType.DOCUMENT_TYPE_NODE;\n\t\tthis.nodeValue = String(nodeValue);\n\t}\n\tserialize(): string {\n\t\treturn `<${this.nodeValue}>`;\n\t}\n}\n\nexport class RxDocumentFragment extends RxElement {\n\tconstructor() {\n\t\tsuper(null, '#document-fragment');\n\t\tthis.nodeType = RxNodeType.DOCUMENT_FRAGMENT_NODE;\n\t\tthis.childNodes = [];\n\t}\n}\n\nexport class RxDocument extends RxElement {\n\tget hidden(): true {\n\t\treturn true;\n\t}\n\tget visibilityState(): 'prerender' {\n\t\treturn 'prerender';\n\t}\n\tget doctype(): RxDocumentType | null {\n\t\treturn this.childNodes.find(x => isRxDocumentType(x)) as RxDocumentType;\n\t}\n\tget body(): RxElement | null {\n\t\treturn this.childNodes.find(x => isRxElement(x) && x.nodeName === 'body') as RxElement;\n\t}\n\tget head(): RxElement | null {\n\t\treturn this.childNodes.find(x => isRxElement(x) && x.nodeName === 'head') as RxElement;\n\t}\n\tget title(): string | null {\n\t\tconst title = this.childNodes.find(x => isRxElement(x) && x.nodeName === 'title') as RxElement;\n\t\tif (title) {\n\t\t\treturn title.innerText;\n\t\t} else {\n\t\t\treturn null;\n\t\t}\n\t}\n\tset title(nodeValue: string | null) {\n\t\tconst title = this.childNodes.find(x => isRxElement(x) && x.nodeName === 'title') as RxElement;\n\t\tif (title) {\n\t\t\ttitle.innerText = nodeValue;\n\t\t}\n\t}\n\tget documentElement(): RxElement | null {\n\t\treturn this.firstElementChild;\n\t}\n\tconstructor() {\n\t\tsuper(null, '#document');\n\t\tthis.nodeType = RxNodeType.DOCUMENT_NODE;\n\t\tthis.childNodes = [];\n\t}\n\tcreateAttribute() { }\n\t// Creates a new Attr object and returns it.\n\tcreateAttributeNS() { }\n\t// Creates a new attribute node in a given namespace and returns it.\n\tcreateCDATASection() { }\n\t// Creates a new CDATA node and returns it.\n\tcreateComment(nodeValue: string) {\n\t\treturn new RxComment(null, nodeValue);\n\t}\n\t// Creates a new comment node and returns it.\n\tcreateDocumentFragment() {\n\t\treturn new RxDocumentFragment();\n\t}\n\t// Creates a new document fragment.\n\tcreateElement(nodeName: string): RxElement {\n\t\treturn new RxElement(null, nodeName);\n\t}\n\t// Creates a new element with the given tag name.\n\tcreateElementNS(nodeName: string): RxElement {\n\t\treturn new RxElement(null, nodeName);\n\t}\n\t// Creates a new element with the given tag name and namespace URI.\n\tcreateEvent() { }\n\t// Creates an event object.\n\tcreateNodeIterator() { }\n\t// Creates a NodeIterator object.\n\tcreateProcessingInstruction(nodeValue: string) {\n\t\treturn new RxProcessingInstruction(null, nodeValue);\n\t}\n\t// Creates a new ProcessingInstruction object.\n\tcreateRange() { }\n\t// Creates a Range object.\n\tcreateTextNode(nodeValue: string) {\n\t\treturn new RxText(null, nodeValue);\n\t}\n\t// Creates a text node.\n\tcreateTouchList() { }\n\t// Creates a TouchList object.\n\tcreateTreeWalker() { }\n\t// Creates a TreeWalker object.\n\tserialize(): string {\n\t\treturn `${this.childNodes.map(x => x.serialize()).join('')}`;\n\t}\n}\n","var nodeFetch = require('node-fetch')\nvar realFetch = nodeFetch.default || nodeFetch\n\nvar fetch = function (url, options) {\n  // Support schemaless URIs on the server for parity with the browser.\n  // Ex: //github.com/ -> https://github.com/\n  if (/^\\/\\//.test(url)) {\n    url = 'https:' + url\n  }\n  return realFetch.call(this, url, options)\n}\n\nmodule.exports = exports = fetch\nexports.fetch = fetch\nexports.Headers = nodeFetch.Headers\nexports.Request = nodeFetch.Request\nexports.Response = nodeFetch.Response\n\n// Needed for TypeScript consumers without esModuleInterop.\nexports.default = fetch\n","var fetchNode = require('./node-ponyfill')\nvar fetch = fetchNode.fetch.bind({})\n\nfetch.polyfill = true\n\nif (!global.fetch) {\n  global.fetch = fetch\n  global.Response = fetchNode.Response\n  global.Headers = fetchNode.Headers\n  global.Request = fetchNode.Request\n}\n","import { isPlatformServer, Module, Platform } from 'rxcomp';\nimport { parse, RxDocument, RxElement, RxText } from '../nodes/nodes';\n\nexport default class Server extends Platform {\n\n\t/**\n\t * @param moduleFactory\n\t * @description This method returns a Server compiled module\n\t */\n\tstatic bootstrap(moduleFactory?: typeof Module, html?: string) {\n\t\tif (!isPlatformServer) {\n\t\t\tthrow 'missing platform server, node process not found';\n\t\t}\n\t\tif (!moduleFactory) {\n\t\t\tthrow 'missing moduleFactory';\n\t\t}\n\t\tif (!moduleFactory.meta) {\n\t\t\tthrow 'missing moduleFactory meta';\n\t\t}\n\t\tif (!moduleFactory.meta.bootstrap) {\n\t\t\tthrow 'missing bootstrap';\n\t\t}\n\t\tif (!moduleFactory.meta.bootstrap.meta) {\n\t\t\tthrow 'missing bootstrap meta';\n\t\t}\n\t\tif (!moduleFactory.meta.bootstrap.meta.selector) {\n\t\t\tthrow 'missing bootstrap meta selector';\n\t\t}\n\t\tif (!html) {\n\t\t\tthrow 'missing html template';\n\t\t}\n\t\tconst document = this.resolveGlobals(html);\n\t\tconst meta = this.resolveMeta(moduleFactory);\n\t\tif (meta.node instanceof RxElement) {\n\t\t\tconst node: RxElement = meta.node as RxElement;\n\t\t\tconst nodeInnerHTML = meta.nodeInnerHTML;\n\t\t\tconst rxcomp_hydrate_ = {\n\t\t\t\tselector: moduleFactory.meta.bootstrap.meta.selector,\n\t\t\t\tinnerHTML: nodeInnerHTML,\n\t\t\t};\n\t\t\tconst scriptNode = new RxElement(null, 'script');\n\t\t\tconst scriptText = new RxText(null, `var rxcomp_hydrate_ = ${JSON.stringify(rxcomp_hydrate_)};`);\n\t\t\tscriptNode.append(scriptText);\n\t\t\tnode.parentNode?.insertBefore(scriptNode, node);\n\t\t}\n\t\tconst module = new moduleFactory();\n\t\tmodule.meta = meta;\n\t\tconst instances = module.compile(meta.node, { document } as Window);\n\t\tmodule.instances = instances;\n\t\tconst root = instances[0];\n\t\troot.pushChanges();\n\t\treturn module;\n\t}\n\n\tstatic serialize(): string {\n\t\tconsole.log('Server.serialize');\n\t\tif (this.document instanceof RxDocument) {\n\t\t\tconst serialized = this.document.serialize();\n\t\t\t// console.log('serialized', serialized);\n\t\t\treturn serialized;\n\t\t} else {\n\t\t\tthrow ('document is not an instance of RxDocument');\n\t\t}\n\t}\n\n\tprotected static document: Document | RxDocument;\n\n\tprotected static resolveGlobals(documentOrHtml: Document | string): Document | RxDocument {\n\t\tconst document: Document | RxDocument = typeof documentOrHtml === 'string' ? parse(documentOrHtml) : documentOrHtml;\n\t\tthis.document = document as Document;\n\t\tglobal.document = this.document;\n\t\treturn this.document;\n\t}\n\n}\n","import { BehaviorSubject, from, Observable, throwError } from 'rxjs';\r\nimport { catchError, finalize } from 'rxjs/operators';\r\n\r\nexport class HttpResponse {\r\n\r\n\tdata?: any;\r\n\turl: string = '';\r\n\tstatus: number = 0;\r\n\tstatusText: string = '';\r\n\tok: boolean = false;\r\n\tredirected: boolean = false;\r\n\r\n\tget static() {\r\n\t\treturn this.url!.indexOf('.json') === this.url!.length - 5;\r\n\t}\r\n\r\n\tconstructor(response: Response) {\r\n\t\tthis.data = null;\r\n\t\tif (response) {\r\n\t\t\tthis.url = response.url;\r\n\t\t\tthis.status = response.status;\r\n\t\t\tthis.statusText = response.statusText;\r\n\t\t\tthis.ok = response.ok;\r\n\t\t\tthis.redirected = response.redirected;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nexport default class HttpService {\r\n\r\n\tstatic pendingRequests$: BehaviorSubject<number> = new BehaviorSubject<number>(0);\r\n\r\n\tstatic http$(method: string, url: string, data?: any, format: string = 'json'): Observable<any> {\r\n\t\tmethod = url.indexOf('.json') !== -1 ? 'GET' : method;\r\n\t\tconst methods = ['POST', 'PUT', 'PATCH'];\r\n\t\tlet response_: HttpResponse | null = null;\r\n\t\tthis.pendingRequests$.next(this.pendingRequests$.getValue() + 1);\r\n\t\treturn from(fetch(url, {\r\n\t\t\tmethod: method,\r\n\t\t\theaders: {\r\n\t\t\t\t'Accept': 'application/json',\r\n\t\t\t\t'Content-Type': 'application/json',\r\n\t\t\t},\r\n\t\t\tbody: methods.indexOf(method) !== -1 ? JSON.stringify(data) : undefined\r\n\t\t}).then((response: Response) => {\r\n\t\t\tresponse_ = new HttpResponse(response);\r\n\t\t\tif (typeof (response as any)[format] === 'function') {\r\n\t\t\t\treturn (response as any)[format]().then((json: any) => {\r\n\t\t\t\t\tresponse_!.data = json;\r\n\t\t\t\t\tif (response.ok) {\r\n\t\t\t\t\t\treturn Promise.resolve(response_);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\treturn Promise.reject(response_);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\treturn Promise.reject(response_);\r\n\t\t\t}\r\n\t\t})).pipe(\r\n\t\t\tcatchError(error => {\r\n\t\t\t\tconsole.log('error', error);\r\n\t\t\t\treturn throwError(this.getError(error, response_));\r\n\t\t\t}),\r\n\t\t\tfinalize(() => {\r\n\t\t\t\tthis.pendingRequests$.next(this.pendingRequests$.getValue() - 1);\r\n\t\t\t})\r\n\t\t);\r\n\t}\r\n\r\n\tstatic get$(url: string, data?: any, format?: string): Observable<any> {\r\n\t\tconst query = this.query(data);\r\n\t\treturn this.http$('GET', `${url}${query}`, undefined, format);\r\n\t}\r\n\r\n\tstatic delete$(url: string): Observable<any> {\r\n\t\treturn this.http$('DELETE', url);\r\n\t}\r\n\r\n\tstatic post$(url: string, data?: any): Observable<any> {\r\n\t\treturn this.http$('POST', url, data);\r\n\t}\r\n\r\n\tstatic put$(url: string, data?: any): Observable<any> {\r\n\t\treturn this.http$('PUT', url, data);\r\n\t}\r\n\r\n\tstatic patch$(url: string, data?: any): Observable<any> {\r\n\t\treturn this.http$('PATCH', url, data);\r\n\t}\r\n\r\n\tstatic query(data: any): string {\r\n\t\treturn ''; // todo\r\n\t}\r\n\r\n\tstatic getError(object: any, response: HttpResponse | null): any {\r\n\t\tlet error = typeof object === 'object' ? object : {};\r\n\t\tif (!error.statusCode) {\r\n\t\t\terror.statusCode = response ? response.status : 0;\r\n\t\t}\r\n\t\tif (!error.statusMessage) {\r\n\t\t\terror.statusMessage = response ? response.statusText : object;\r\n\t\t}\r\n\t\t// console.log('HttpService.getError', error, object);\r\n\t\treturn error;\r\n\t}\r\n\r\n}\r\n","import { Component, IFactoryMeta } from 'rxcomp';\r\nimport { first } from 'rxjs/operators';\r\nimport HttpService from './http/http.service';\r\n\r\nexport default class AppComponent extends Component {\r\n\r\n\tonInit() {\r\n\t\t// console.log('AppComponent.onInit', this);\r\n\t\tthis.items = [];\r\n\t\t// HttpService.get$('https://jsonplaceholder.typicode.com/users/1/todos').pipe(\r\n\t\tHttpService.get$('http://localhost:5000/data/todos.json').pipe(\r\n\t\t\tfirst(),\r\n\t\t).subscribe(response => {\r\n\t\t\tconsole.log('AppComponent.items', response);\r\n\t\t\tthis.items = response.data;\r\n\t\t\tthis.pushChanges();\r\n\t\t});\r\n\t}\r\n\r\n\tonClick(item: { title: string, completed: boolean }) {\r\n\t\titem.completed = !item.completed;\r\n\t\tthis.pushChanges();\r\n\t}\r\n\r\n\tstatic meta: IFactoryMeta = {\r\n\t\tselector: '[app-component]',\r\n\t};\r\n\r\n}\r\n","import { CoreModule, IModuleMeta, Module } from 'rxcomp';\r\nimport AppComponent from './app.component';\r\n\r\nexport default class AppModule extends Module {\r\n\r\n\tstatic meta: IModuleMeta = {\r\n\t\timports: [\r\n\t\t\tCoreModule,\r\n\t\t],\r\n\t\tdeclarations: [\r\n\t\t],\r\n\t\tbootstrap: AppComponent,\r\n\t};\r\n\r\n}\r\n","// import fetch from 'cross-fetch';\nimport 'cross-fetch/polyfill';\nimport { Observable } from 'rxjs';\nimport { filter, first, map } from 'rxjs/operators';\nimport { Server } from '../../src/rxcomp-server';\nimport AppModule from './app.module';\nimport HttpService from './http/http.service';\n\nexport function renderServer(html: string): Observable<string> {\n\tconst module = Server.bootstrap(AppModule, html);\n\tconsole.log(module);\n\t// return of(Server.serialize());\n\treturn HttpService.pendingRequests$.pipe(\n\t\tfilter(x => x === 0),\n\t\tmap(x => Server.serialize()),\n\t\tfirst(),\n\t);\n}\n"]}