{"version":3,"sources":["web/client/src/main.server.ts","../../../node_modules/node-fetch/lib/index.mjs","../../../node_modules/cross-fetch/dist/node-ponyfill.js","../../../node_modules/cross-fetch/dist/node-polyfill.js","../../../src/file/file.service.ts","../../../src/cache/cache.service.ts","../../../src/nodes/nodes.ts","../../../src/location/location.ts","../../../src/history/history.ts","../../../src/platform/server.ts","../../../client/src/app.component.ts","../../../client/src/custom-interceptor/custom.interceptor.ts","../../../client/src/pages/not-found.component.ts","../../../client/src/pages/todolist-item.component.ts","../../../client/src/vars.ts","../../../client/src/pages/todolist.component.ts","../../../client/src/app.module.ts","../../../client/src/main.server.ts"],"names":["g","f","exports","module","require","define","amd","globalThis","self","main","Stream","http","Url","https","zlib","rxcomp","rxjs","operators","htmlparser2","router","this","rxcompHttp","rxcompRouter","Object","prototype","hasOwnProperty","call","commonjsGlobal","window","global","Readable","BUFFER","Symbol","TYPE","Blob","[object Object]","blobParts","arguments","options","buffers","size","a","length","Number","i","element","buffer","Buffer","ArrayBuffer","isView","from","byteOffset","byteLength","String","push","concat","type","undefined","toLowerCase","test","Promise","resolve","toString","buf","ab","slice","readable","_read","start","end","relativeStart","relativeEnd","Math","max","min","span","slicedBuffer","blob","FetchError","message","systemError","Error","code","errno","captureStackTrace","constructor","convert","defineProperties","enumerable","defineProperty","toStringTag","value","writable","configurable","create","name","e","INTERNALS","PassThrough","Body","body","_this","_ref","_ref$size","_ref$timeout","timeout","isURLSearchParams","isBlob","isBuffer","disturbed","error","on","err","url","consumeBody","_this4","reject","TypeError","alloc","stream","accum","accumBytes","abort","resTimeout","setTimeout","chunk","clearTimeout","obj","append","delete","get","getAll","has","set","sort","arrayBuffer","clone","instance","p1","p2","bodyUsed","getBoundary","pipe","extractContentType","getTotalBytes","getLengthSync","_lengthRetrievers","hasKnownLength","then","ct","headers","assign","_this2","JSON","parse","_this3","res","str","charset","exec","pop","convertBody","json","text","mixIn","proto","getOwnPropertyNames","desc","getOwnPropertyDescriptor","invalidTokenRegex","invalidHeaderCharRegex","validateName","validateValue","find","map","key","MAP","Headers","init","rawHeaders","raw","headerNames","keys","headerName","method","iterator","pairs","pair","Array","join","callback","thisArg","getHeaders","_pairs$i","createHeadersIterator","kind","k","entries","forEach","values","INTERNAL","target","HeadersIteratorPrototype","index","setPrototypeOf","getPrototypeOf","_INTERNAL","done","exportNodeCompatibleHeaders","__proto__","hostHeaderKey","INTERNALS$1","STATUS_CODES","Response","opts","status","contentType","statusText","counter","ok","redirected","INTERNALS$2","parse_url","format_url","format","streamDestructionSupported","isRequest","input","Request","parsedURL","href","toUpperCase","inputBody","signal","isAbortSignal","redirect","follow","compress","agent","AbortError","PassThrough$1","resolve_url","fetch","request","protocol","hostname","contentLengthValue","totalBytes","getNodeRequestOptions","send","response","destroy","emit","aborted","abortAndFinalize","finalize","req","reqTimeout","removeEventListener","addEventListener","once","socket","isArray","val","createHeadersLenient","isRedirect","statusCode","location","locationURL","requestOpts","response_options","statusMessage","codings","zlibOptions","flush","Z_SYNC_FLUSH","finishFlush","createGunzip","createBrotliDecompress","createInflate","createInflateRaw","dest","write","writeToStream","n","nodeFetch","freeze","default","nodePonyfill","fn","basedir","path","base","commonjsRequire","createCommonjsModule","realFetch","fetchNode","bind","_defineProperties","props","descriptor","_createClass","Constructor","protoProps","staticProps","_inheritsLoose","subClass","superClass","_getPrototypeOf","o","_setPrototypeOf","p","_isNativeReflectConstruct","Reflect","construct","sham","Proxy","Date","_construct","Parent","args","Class","apply","Function","_wrapNativeSuper","_cache","Map","indexOf","Wrapper","_assertThisInitialized","ReferenceError","_arrayLikeToArray","arr","len","arr2","_createForOfIteratorHelperLoose","allowArrayLike","it","minLen","_unsupportedIterableToArray","next","polyfill","CacheMode","CacheControlType","fs","FileService","exists","pathname","existsSync","exists$","Observable","observer","access","constants","F_OK","complete","console","log","readFile","dirname","readFileSync","readFile$","data","writeFile","content","mkdirSync","writeFileSync","writeFile$","mkdir","recursive","unlinkFile","unlinkSync","unlinkFile$","unlink","CacheItem","date","maxAge","cacheControl","Public","toData","cacheItem","Serializer","encode","encodeJson","fromData","decode","decodeJson","NoStore","getTime","now","CacheService","filename","getPath","mode","File","Memory","cache_","_cacheItem","expired","has$","switchMap","of","get$","set$","delete$","getKey","folder","replace","RxNodeType","SelectorType","RxDOMStringList","_Array","_proto","contains","string","item","RxLocation","hash_","host_","hostname_","pathname_","port_","protocol_","search_","href_","ancestorOrigins_","_proto2","reload","hash","host","port","search","getLocationComponents","location_","RxHistory","currentIndex_","history_","scrollRestoration","back","forward","go","delta","pushState","title","replaceState","splice","RxNode","parentNode","nodeValue","nodeType","cloneNode","deep","serialize","RxStyle","node","_this$node$attributes","attributes","style","matchAll","match","getPropertyPriority","getPropertyValue","setProperty","important","serialize_","removeProperty","RxClassList","_len","_proto3","hasAttribute","getAttribute","split","trim","classList","add","_len2","names","remove","_len3","toggle","force","oldClass","newClass","setAttribute","node_","RxElement","_RxNode","nodeName","_this5","ELEMENT_NODE","childNodes","_proto4","_this6","_len4","nodesOrDOMStrings","nodeOrDomString","RxText","appendChild","newChild","removeChild","isRxDocumentFragment","prepend","_this7","_len5","unshift","replaceChildren","_this8","_len6","nodes","querySelectorAll","selector","getQueries","querySelector","attribute","removeAttribute","replaceChild","oldChild","child","insertBefore","newNode","referenceNode","addListener","eventName","handler","removeListener","serializeAttributes","x","_this9","children","count","_step","_iterator","isRxElement","TEXT_NODE","html","filter","isRxText","innerText","_this10","_RxNode2","_this11","RxComment","_RxNode4","_this13","COMMENT_NODE","RxProcessingInstruction","_RxNode5","_this14","PROCESSING_INSTRUCTION_NODE","RxDocumentType","_RxNode6","_this15","DOCUMENT_TYPE_NODE","RxDocumentFragment","_RxElement","_this16","DOCUMENT_FRAGMENT_NODE","RxDocument","_RxElement2","_this17","DOCUMENT_NODE","_proto10","createAttribute","createAttributeNS","createCDATASection","createComment","createDocumentFragment","createElement","createElementNS","createEvent","createNodeIterator","createProcessingInstruction","createRange","createTextNode","createTouchList","createTreeWalker","isRxDocumentType","head","documentElement","firstElementChild","RxWindow","_proto11","alert","blur","close","confirm","departFocus","navigationReason","origin","focus","getComputedStyle","elt","pseudoElt","getMatchedCSSRules","getSelection","matchMedia","query","moveBy","y","moveTo","msWriteProfilerMark","profilerMarkName","open","features","postMessage","targetOrigin","transfer","print","prompt","_default","resizeBy","resizeTo","scroll","scrollBy","scrollTo","stop","webkitCancelAnimationFrame","handle","webkitConvertPointFromNodeToPage","pt","webkitConvertPointFromPageToNode","webkitRequestAnimationFrame","listener","oncompassneedscalibration","event","ondevicelight","ondevicemotion","ondeviceorientation","ondeviceorientationabsolute","onmousewheel","onmsgesturechange","onmsgesturedoubletap","onmsgestureend","onmsgesturehold","onmsgesturestart","onmsgesturetap","onmsinertiastart","onmspointercancel","onmspointerdown","onmspointerenter","onmspointerleave","onmspointermove","onmspointerout","onmspointerover","onmspointerup","onreadystatechange","onvrdisplayactivate","onvrdisplayblur","onvrdisplayconnect","onvrdisplaydeactivate","onvrdisplaydisconnect","onvrdisplayfocus","onvrdisplaypointerrestricted","onvrdisplaypointerunrestricted","onvrdisplaypresentchange","doc","parser","Parser","onopentag","onclosetag","ontext","textNode","onprocessinginstruction","oncomment","oncommentend","decodeEntities","lowerCaseTags","queries","_step2","selectors","_iterator2","Id","negate","Attribute","TagName","inner","matchSelectors","reduce","id","matchSelector","shift","_step3","_iterator3","results","_step4","_iterator4","source","nodeElement","nodeDocumentFragment","isRxDocument","ServerRequest","vars","template","cacheMode","cache","root","ServerResponse","ServerErrorResponse","Server","_Platform","bootstrap","moduleFactory","isPlatformServer","ModuleError","meta","document","resolveGlobals","resolveMeta","_node$parentNode","nodeInnerHTML","rxcomp_hydrate_","innerHTML","scriptNode","scriptText","stringify","imports","instances","compile","pushChanges","history","documentOrHtml","devicePixelRatio","Platform","template$","src","throwError","iRequest","renderRequest$","fromCache$","fromRenderRequest$","AppComponent","_Component","onInit","getContext","Component","CustomRequestInterceptor","intercept","CustomResponseInterceptor","tap","HttpResponse","params","NotFoundComponent","TodolistItemComponent","_View","combineLatest","route","data$","params$","takeUntil","unsubscribe$","subscribe","datas","itemId","onEnter","transition$","gsap","opacity","to","duration","ease","Power3","easeOut","onComplete","onExit","View","Vars","resource","api","static","development","production","TodolistComponent","items","HttpService","first","getTodos","warn","errors$","onClick","completed","hosts","RouterOutletStructure","AppModule","_Module","Module","CoreModule","HttpModule","useInterceptors","RouterModule","forRoot","redirectTo","pathMatch","component","declarations","bootstrap$","pendingRequests$"],"mappings":"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","file":"web\\dist\\development\\server\\main.min.js","sourcesContent":[null,"import Stream from 'stream';\nimport http from 'http';\nimport Url from 'url';\nimport https from 'https';\nimport zlib from 'zlib';\n\n// Based on https://github.com/tmpvar/jsdom/blob/aa85b2abf07766ff7bf5c1f6daafb3726f2f2db5/lib/jsdom/living/blob.js\n\n// fix for \"Readable\" isn't a named export issue\nconst Readable = Stream.Readable;\n\nconst BUFFER = Symbol('buffer');\nconst TYPE = Symbol('type');\n\nclass Blob {\n\tconstructor() {\n\t\tthis[TYPE] = '';\n\n\t\tconst blobParts = arguments[0];\n\t\tconst options = arguments[1];\n\n\t\tconst buffers = [];\n\t\tlet size = 0;\n\n\t\tif (blobParts) {\n\t\t\tconst a = blobParts;\n\t\t\tconst length = Number(a.length);\n\t\t\tfor (let i = 0; i < length; i++) {\n\t\t\t\tconst element = a[i];\n\t\t\t\tlet buffer;\n\t\t\t\tif (element instanceof Buffer) {\n\t\t\t\t\tbuffer = element;\n\t\t\t\t} else if (ArrayBuffer.isView(element)) {\n\t\t\t\t\tbuffer = Buffer.from(element.buffer, element.byteOffset, element.byteLength);\n\t\t\t\t} else if (element instanceof ArrayBuffer) {\n\t\t\t\t\tbuffer = Buffer.from(element);\n\t\t\t\t} else if (element instanceof Blob) {\n\t\t\t\t\tbuffer = element[BUFFER];\n\t\t\t\t} else {\n\t\t\t\t\tbuffer = Buffer.from(typeof element === 'string' ? element : String(element));\n\t\t\t\t}\n\t\t\t\tsize += buffer.length;\n\t\t\t\tbuffers.push(buffer);\n\t\t\t}\n\t\t}\n\n\t\tthis[BUFFER] = Buffer.concat(buffers);\n\n\t\tlet type = options && options.type !== undefined && String(options.type).toLowerCase();\n\t\tif (type && !/[^\\u0020-\\u007E]/.test(type)) {\n\t\t\tthis[TYPE] = type;\n\t\t}\n\t}\n\tget size() {\n\t\treturn this[BUFFER].length;\n\t}\n\tget type() {\n\t\treturn this[TYPE];\n\t}\n\ttext() {\n\t\treturn Promise.resolve(this[BUFFER].toString());\n\t}\n\tarrayBuffer() {\n\t\tconst buf = this[BUFFER];\n\t\tconst ab = buf.buffer.slice(buf.byteOffset, buf.byteOffset + buf.byteLength);\n\t\treturn Promise.resolve(ab);\n\t}\n\tstream() {\n\t\tconst readable = new Readable();\n\t\treadable._read = function () {};\n\t\treadable.push(this[BUFFER]);\n\t\treadable.push(null);\n\t\treturn readable;\n\t}\n\ttoString() {\n\t\treturn '[object Blob]';\n\t}\n\tslice() {\n\t\tconst size = this.size;\n\n\t\tconst start = arguments[0];\n\t\tconst end = arguments[1];\n\t\tlet relativeStart, relativeEnd;\n\t\tif (start === undefined) {\n\t\t\trelativeStart = 0;\n\t\t} else if (start < 0) {\n\t\t\trelativeStart = Math.max(size + start, 0);\n\t\t} else {\n\t\t\trelativeStart = Math.min(start, size);\n\t\t}\n\t\tif (end === undefined) {\n\t\t\trelativeEnd = size;\n\t\t} else if (end < 0) {\n\t\t\trelativeEnd = Math.max(size + end, 0);\n\t\t} else {\n\t\t\trelativeEnd = Math.min(end, size);\n\t\t}\n\t\tconst span = Math.max(relativeEnd - relativeStart, 0);\n\n\t\tconst buffer = this[BUFFER];\n\t\tconst slicedBuffer = buffer.slice(relativeStart, relativeStart + span);\n\t\tconst blob = new Blob([], { type: arguments[2] });\n\t\tblob[BUFFER] = slicedBuffer;\n\t\treturn blob;\n\t}\n}\n\nObject.defineProperties(Blob.prototype, {\n\tsize: { enumerable: true },\n\ttype: { enumerable: true },\n\tslice: { enumerable: true }\n});\n\nObject.defineProperty(Blob.prototype, Symbol.toStringTag, {\n\tvalue: 'Blob',\n\twritable: false,\n\tenumerable: false,\n\tconfigurable: true\n});\n\n/**\n * fetch-error.js\n *\n * FetchError interface for operational errors\n */\n\n/**\n * Create FetchError instance\n *\n * @param   String      message      Error message for human\n * @param   String      type         Error type for machine\n * @param   String      systemError  For Node.js system error\n * @return  FetchError\n */\nfunction FetchError(message, type, systemError) {\n  Error.call(this, message);\n\n  this.message = message;\n  this.type = type;\n\n  // when err.type is `system`, err.code contains system error code\n  if (systemError) {\n    this.code = this.errno = systemError.code;\n  }\n\n  // hide custom error implementation details from end-users\n  Error.captureStackTrace(this, this.constructor);\n}\n\nFetchError.prototype = Object.create(Error.prototype);\nFetchError.prototype.constructor = FetchError;\nFetchError.prototype.name = 'FetchError';\n\nlet convert;\ntry {\n\tconvert = require('encoding').convert;\n} catch (e) {}\n\nconst INTERNALS = Symbol('Body internals');\n\n// fix an issue where \"PassThrough\" isn't a named export for node <10\nconst PassThrough = Stream.PassThrough;\n\n/**\n * Body mixin\n *\n * Ref: https://fetch.spec.whatwg.org/#body\n *\n * @param   Stream  body  Readable stream\n * @param   Object  opts  Response options\n * @return  Void\n */\nfunction Body(body) {\n\tvar _this = this;\n\n\tvar _ref = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {},\n\t    _ref$size = _ref.size;\n\n\tlet size = _ref$size === undefined ? 0 : _ref$size;\n\tvar _ref$timeout = _ref.timeout;\n\tlet timeout = _ref$timeout === undefined ? 0 : _ref$timeout;\n\n\tif (body == null) {\n\t\t// body is undefined or null\n\t\tbody = null;\n\t} else if (isURLSearchParams(body)) {\n\t\t// body is a URLSearchParams\n\t\tbody = Buffer.from(body.toString());\n\t} else if (isBlob(body)) ; else if (Buffer.isBuffer(body)) ; else if (Object.prototype.toString.call(body) === '[object ArrayBuffer]') {\n\t\t// body is ArrayBuffer\n\t\tbody = Buffer.from(body);\n\t} else if (ArrayBuffer.isView(body)) {\n\t\t// body is ArrayBufferView\n\t\tbody = Buffer.from(body.buffer, body.byteOffset, body.byteLength);\n\t} else if (body instanceof Stream) ; else {\n\t\t// none of the above\n\t\t// coerce to string then buffer\n\t\tbody = Buffer.from(String(body));\n\t}\n\tthis[INTERNALS] = {\n\t\tbody,\n\t\tdisturbed: false,\n\t\terror: null\n\t};\n\tthis.size = size;\n\tthis.timeout = timeout;\n\n\tif (body instanceof Stream) {\n\t\tbody.on('error', function (err) {\n\t\t\tconst error = err.name === 'AbortError' ? err : new FetchError(`Invalid response body while trying to fetch ${_this.url}: ${err.message}`, 'system', err);\n\t\t\t_this[INTERNALS].error = error;\n\t\t});\n\t}\n}\n\nBody.prototype = {\n\tget body() {\n\t\treturn this[INTERNALS].body;\n\t},\n\n\tget bodyUsed() {\n\t\treturn this[INTERNALS].disturbed;\n\t},\n\n\t/**\n  * Decode response as ArrayBuffer\n  *\n  * @return  Promise\n  */\n\tarrayBuffer() {\n\t\treturn consumeBody.call(this).then(function (buf) {\n\t\t\treturn buf.buffer.slice(buf.byteOffset, buf.byteOffset + buf.byteLength);\n\t\t});\n\t},\n\n\t/**\n  * Return raw response as Blob\n  *\n  * @return Promise\n  */\n\tblob() {\n\t\tlet ct = this.headers && this.headers.get('content-type') || '';\n\t\treturn consumeBody.call(this).then(function (buf) {\n\t\t\treturn Object.assign(\n\t\t\t// Prevent copying\n\t\t\tnew Blob([], {\n\t\t\t\ttype: ct.toLowerCase()\n\t\t\t}), {\n\t\t\t\t[BUFFER]: buf\n\t\t\t});\n\t\t});\n\t},\n\n\t/**\n  * Decode response as json\n  *\n  * @return  Promise\n  */\n\tjson() {\n\t\tvar _this2 = this;\n\n\t\treturn consumeBody.call(this).then(function (buffer) {\n\t\t\ttry {\n\t\t\t\treturn JSON.parse(buffer.toString());\n\t\t\t} catch (err) {\n\t\t\t\treturn Body.Promise.reject(new FetchError(`invalid json response body at ${_this2.url} reason: ${err.message}`, 'invalid-json'));\n\t\t\t}\n\t\t});\n\t},\n\n\t/**\n  * Decode response as text\n  *\n  * @return  Promise\n  */\n\ttext() {\n\t\treturn consumeBody.call(this).then(function (buffer) {\n\t\t\treturn buffer.toString();\n\t\t});\n\t},\n\n\t/**\n  * Decode response as buffer (non-spec api)\n  *\n  * @return  Promise\n  */\n\tbuffer() {\n\t\treturn consumeBody.call(this);\n\t},\n\n\t/**\n  * Decode response as text, while automatically detecting the encoding and\n  * trying to decode to UTF-8 (non-spec api)\n  *\n  * @return  Promise\n  */\n\ttextConverted() {\n\t\tvar _this3 = this;\n\n\t\treturn consumeBody.call(this).then(function (buffer) {\n\t\t\treturn convertBody(buffer, _this3.headers);\n\t\t});\n\t}\n};\n\n// In browsers, all properties are enumerable.\nObject.defineProperties(Body.prototype, {\n\tbody: { enumerable: true },\n\tbodyUsed: { enumerable: true },\n\tarrayBuffer: { enumerable: true },\n\tblob: { enumerable: true },\n\tjson: { enumerable: true },\n\ttext: { enumerable: true }\n});\n\nBody.mixIn = function (proto) {\n\tfor (const name of Object.getOwnPropertyNames(Body.prototype)) {\n\t\t// istanbul ignore else: future proof\n\t\tif (!(name in proto)) {\n\t\t\tconst desc = Object.getOwnPropertyDescriptor(Body.prototype, name);\n\t\t\tObject.defineProperty(proto, name, desc);\n\t\t}\n\t}\n};\n\n/**\n * Consume and convert an entire Body to a Buffer.\n *\n * Ref: https://fetch.spec.whatwg.org/#concept-body-consume-body\n *\n * @return  Promise\n */\nfunction consumeBody() {\n\tvar _this4 = this;\n\n\tif (this[INTERNALS].disturbed) {\n\t\treturn Body.Promise.reject(new TypeError(`body used already for: ${this.url}`));\n\t}\n\n\tthis[INTERNALS].disturbed = true;\n\n\tif (this[INTERNALS].error) {\n\t\treturn Body.Promise.reject(this[INTERNALS].error);\n\t}\n\n\tlet body = this.body;\n\n\t// body is null\n\tif (body === null) {\n\t\treturn Body.Promise.resolve(Buffer.alloc(0));\n\t}\n\n\t// body is blob\n\tif (isBlob(body)) {\n\t\tbody = body.stream();\n\t}\n\n\t// body is buffer\n\tif (Buffer.isBuffer(body)) {\n\t\treturn Body.Promise.resolve(body);\n\t}\n\n\t// istanbul ignore if: should never happen\n\tif (!(body instanceof Stream)) {\n\t\treturn Body.Promise.resolve(Buffer.alloc(0));\n\t}\n\n\t// body is stream\n\t// get ready to actually consume the body\n\tlet accum = [];\n\tlet accumBytes = 0;\n\tlet abort = false;\n\n\treturn new Body.Promise(function (resolve, reject) {\n\t\tlet resTimeout;\n\n\t\t// allow timeout on slow response body\n\t\tif (_this4.timeout) {\n\t\t\tresTimeout = setTimeout(function () {\n\t\t\t\tabort = true;\n\t\t\t\treject(new FetchError(`Response timeout while trying to fetch ${_this4.url} (over ${_this4.timeout}ms)`, 'body-timeout'));\n\t\t\t}, _this4.timeout);\n\t\t}\n\n\t\t// handle stream errors\n\t\tbody.on('error', function (err) {\n\t\t\tif (err.name === 'AbortError') {\n\t\t\t\t// if the request was aborted, reject with this Error\n\t\t\t\tabort = true;\n\t\t\t\treject(err);\n\t\t\t} else {\n\t\t\t\t// other errors, such as incorrect content-encoding\n\t\t\t\treject(new FetchError(`Invalid response body while trying to fetch ${_this4.url}: ${err.message}`, 'system', err));\n\t\t\t}\n\t\t});\n\n\t\tbody.on('data', function (chunk) {\n\t\t\tif (abort || chunk === null) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (_this4.size && accumBytes + chunk.length > _this4.size) {\n\t\t\t\tabort = true;\n\t\t\t\treject(new FetchError(`content size at ${_this4.url} over limit: ${_this4.size}`, 'max-size'));\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\taccumBytes += chunk.length;\n\t\t\taccum.push(chunk);\n\t\t});\n\n\t\tbody.on('end', function () {\n\t\t\tif (abort) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tclearTimeout(resTimeout);\n\n\t\t\ttry {\n\t\t\t\tresolve(Buffer.concat(accum, accumBytes));\n\t\t\t} catch (err) {\n\t\t\t\t// handle streams that have accumulated too much data (issue #414)\n\t\t\t\treject(new FetchError(`Could not create Buffer from response body for ${_this4.url}: ${err.message}`, 'system', err));\n\t\t\t}\n\t\t});\n\t});\n}\n\n/**\n * Detect buffer encoding and convert to target encoding\n * ref: http://www.w3.org/TR/2011/WD-html5-20110113/parsing.html#determining-the-character-encoding\n *\n * @param   Buffer  buffer    Incoming buffer\n * @param   String  encoding  Target encoding\n * @return  String\n */\nfunction convertBody(buffer, headers) {\n\tif (typeof convert !== 'function') {\n\t\tthrow new Error('The package `encoding` must be installed to use the textConverted() function');\n\t}\n\n\tconst ct = headers.get('content-type');\n\tlet charset = 'utf-8';\n\tlet res, str;\n\n\t// header\n\tif (ct) {\n\t\tres = /charset=([^;]*)/i.exec(ct);\n\t}\n\n\t// no charset in content type, peek at response body for at most 1024 bytes\n\tstr = buffer.slice(0, 1024).toString();\n\n\t// html5\n\tif (!res && str) {\n\t\tres = /<meta.+?charset=(['\"])(.+?)\\1/i.exec(str);\n\t}\n\n\t// html4\n\tif (!res && str) {\n\t\tres = /<meta[\\s]+?http-equiv=(['\"])content-type\\1[\\s]+?content=(['\"])(.+?)\\2/i.exec(str);\n\n\t\tif (res) {\n\t\t\tres = /charset=(.*)/i.exec(res.pop());\n\t\t}\n\t}\n\n\t// xml\n\tif (!res && str) {\n\t\tres = /<\\?xml.+?encoding=(['\"])(.+?)\\1/i.exec(str);\n\t}\n\n\t// found charset\n\tif (res) {\n\t\tcharset = res.pop();\n\n\t\t// prevent decode issues when sites use incorrect encoding\n\t\t// ref: https://hsivonen.fi/encoding-menu/\n\t\tif (charset === 'gb2312' || charset === 'gbk') {\n\t\t\tcharset = 'gb18030';\n\t\t}\n\t}\n\n\t// turn raw buffers into a single utf-8 buffer\n\treturn convert(buffer, 'UTF-8', charset).toString();\n}\n\n/**\n * Detect a URLSearchParams object\n * ref: https://github.com/bitinn/node-fetch/issues/296#issuecomment-307598143\n *\n * @param   Object  obj     Object to detect by type or brand\n * @return  String\n */\nfunction isURLSearchParams(obj) {\n\t// Duck-typing as a necessary condition.\n\tif (typeof obj !== 'object' || typeof obj.append !== 'function' || typeof obj.delete !== 'function' || typeof obj.get !== 'function' || typeof obj.getAll !== 'function' || typeof obj.has !== 'function' || typeof obj.set !== 'function') {\n\t\treturn false;\n\t}\n\n\t// Brand-checking and more duck-typing as optional condition.\n\treturn obj.constructor.name === 'URLSearchParams' || Object.prototype.toString.call(obj) === '[object URLSearchParams]' || typeof obj.sort === 'function';\n}\n\n/**\n * Check if `obj` is a W3C `Blob` object (which `File` inherits from)\n * @param  {*} obj\n * @return {boolean}\n */\nfunction isBlob(obj) {\n\treturn typeof obj === 'object' && typeof obj.arrayBuffer === 'function' && typeof obj.type === 'string' && typeof obj.stream === 'function' && typeof obj.constructor === 'function' && typeof obj.constructor.name === 'string' && /^(Blob|File)$/.test(obj.constructor.name) && /^(Blob|File)$/.test(obj[Symbol.toStringTag]);\n}\n\n/**\n * Clone body given Res/Req instance\n *\n * @param   Mixed  instance  Response or Request instance\n * @return  Mixed\n */\nfunction clone(instance) {\n\tlet p1, p2;\n\tlet body = instance.body;\n\n\t// don't allow cloning a used body\n\tif (instance.bodyUsed) {\n\t\tthrow new Error('cannot clone body after it is used');\n\t}\n\n\t// check that body is a stream and not form-data object\n\t// note: we can't clone the form-data object without having it as a dependency\n\tif (body instanceof Stream && typeof body.getBoundary !== 'function') {\n\t\t// tee instance body\n\t\tp1 = new PassThrough();\n\t\tp2 = new PassThrough();\n\t\tbody.pipe(p1);\n\t\tbody.pipe(p2);\n\t\t// set instance body to teed body and return the other teed body\n\t\tinstance[INTERNALS].body = p1;\n\t\tbody = p2;\n\t}\n\n\treturn body;\n}\n\n/**\n * Performs the operation \"extract a `Content-Type` value from |object|\" as\n * specified in the specification:\n * https://fetch.spec.whatwg.org/#concept-bodyinit-extract\n *\n * This function assumes that instance.body is present.\n *\n * @param   Mixed  instance  Any options.body input\n */\nfunction extractContentType(body) {\n\tif (body === null) {\n\t\t// body is null\n\t\treturn null;\n\t} else if (typeof body === 'string') {\n\t\t// body is string\n\t\treturn 'text/plain;charset=UTF-8';\n\t} else if (isURLSearchParams(body)) {\n\t\t// body is a URLSearchParams\n\t\treturn 'application/x-www-form-urlencoded;charset=UTF-8';\n\t} else if (isBlob(body)) {\n\t\t// body is blob\n\t\treturn body.type || null;\n\t} else if (Buffer.isBuffer(body)) {\n\t\t// body is buffer\n\t\treturn null;\n\t} else if (Object.prototype.toString.call(body) === '[object ArrayBuffer]') {\n\t\t// body is ArrayBuffer\n\t\treturn null;\n\t} else if (ArrayBuffer.isView(body)) {\n\t\t// body is ArrayBufferView\n\t\treturn null;\n\t} else if (typeof body.getBoundary === 'function') {\n\t\t// detect form data input from form-data module\n\t\treturn `multipart/form-data;boundary=${body.getBoundary()}`;\n\t} else if (body instanceof Stream) {\n\t\t// body is stream\n\t\t// can't really do much about this\n\t\treturn null;\n\t} else {\n\t\t// Body constructor defaults other things to string\n\t\treturn 'text/plain;charset=UTF-8';\n\t}\n}\n\n/**\n * The Fetch Standard treats this as if \"total bytes\" is a property on the body.\n * For us, we have to explicitly get it with a function.\n *\n * ref: https://fetch.spec.whatwg.org/#concept-body-total-bytes\n *\n * @param   Body    instance   Instance of Body\n * @return  Number?            Number of bytes, or null if not possible\n */\nfunction getTotalBytes(instance) {\n\tconst body = instance.body;\n\n\n\tif (body === null) {\n\t\t// body is null\n\t\treturn 0;\n\t} else if (isBlob(body)) {\n\t\treturn body.size;\n\t} else if (Buffer.isBuffer(body)) {\n\t\t// body is buffer\n\t\treturn body.length;\n\t} else if (body && typeof body.getLengthSync === 'function') {\n\t\t// detect form data input from form-data module\n\t\tif (body._lengthRetrievers && body._lengthRetrievers.length == 0 || // 1.x\n\t\tbody.hasKnownLength && body.hasKnownLength()) {\n\t\t\t// 2.x\n\t\t\treturn body.getLengthSync();\n\t\t}\n\t\treturn null;\n\t} else {\n\t\t// body is stream\n\t\treturn null;\n\t}\n}\n\n/**\n * Write a Body to a Node.js WritableStream (e.g. http.Request) object.\n *\n * @param   Body    instance   Instance of Body\n * @return  Void\n */\nfunction writeToStream(dest, instance) {\n\tconst body = instance.body;\n\n\n\tif (body === null) {\n\t\t// body is null\n\t\tdest.end();\n\t} else if (isBlob(body)) {\n\t\tbody.stream().pipe(dest);\n\t} else if (Buffer.isBuffer(body)) {\n\t\t// body is buffer\n\t\tdest.write(body);\n\t\tdest.end();\n\t} else {\n\t\t// body is stream\n\t\tbody.pipe(dest);\n\t}\n}\n\n// expose Promise\nBody.Promise = global.Promise;\n\n/**\n * headers.js\n *\n * Headers class offers convenient helpers\n */\n\nconst invalidTokenRegex = /[^\\^_`a-zA-Z\\-0-9!#$%&'*+.|~]/;\nconst invalidHeaderCharRegex = /[^\\t\\x20-\\x7e\\x80-\\xff]/;\n\nfunction validateName(name) {\n\tname = `${name}`;\n\tif (invalidTokenRegex.test(name) || name === '') {\n\t\tthrow new TypeError(`${name} is not a legal HTTP header name`);\n\t}\n}\n\nfunction validateValue(value) {\n\tvalue = `${value}`;\n\tif (invalidHeaderCharRegex.test(value)) {\n\t\tthrow new TypeError(`${value} is not a legal HTTP header value`);\n\t}\n}\n\n/**\n * Find the key in the map object given a header name.\n *\n * Returns undefined if not found.\n *\n * @param   String  name  Header name\n * @return  String|Undefined\n */\nfunction find(map, name) {\n\tname = name.toLowerCase();\n\tfor (const key in map) {\n\t\tif (key.toLowerCase() === name) {\n\t\t\treturn key;\n\t\t}\n\t}\n\treturn undefined;\n}\n\nconst MAP = Symbol('map');\nclass Headers {\n\t/**\n  * Headers class\n  *\n  * @param   Object  headers  Response headers\n  * @return  Void\n  */\n\tconstructor() {\n\t\tlet init = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : undefined;\n\n\t\tthis[MAP] = Object.create(null);\n\n\t\tif (init instanceof Headers) {\n\t\t\tconst rawHeaders = init.raw();\n\t\t\tconst headerNames = Object.keys(rawHeaders);\n\n\t\t\tfor (const headerName of headerNames) {\n\t\t\t\tfor (const value of rawHeaders[headerName]) {\n\t\t\t\t\tthis.append(headerName, value);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn;\n\t\t}\n\n\t\t// We don't worry about converting prop to ByteString here as append()\n\t\t// will handle it.\n\t\tif (init == null) ; else if (typeof init === 'object') {\n\t\t\tconst method = init[Symbol.iterator];\n\t\t\tif (method != null) {\n\t\t\t\tif (typeof method !== 'function') {\n\t\t\t\t\tthrow new TypeError('Header pairs must be iterable');\n\t\t\t\t}\n\n\t\t\t\t// sequence<sequence<ByteString>>\n\t\t\t\t// Note: per spec we have to first exhaust the lists then process them\n\t\t\t\tconst pairs = [];\n\t\t\t\tfor (const pair of init) {\n\t\t\t\t\tif (typeof pair !== 'object' || typeof pair[Symbol.iterator] !== 'function') {\n\t\t\t\t\t\tthrow new TypeError('Each header pair must be iterable');\n\t\t\t\t\t}\n\t\t\t\t\tpairs.push(Array.from(pair));\n\t\t\t\t}\n\n\t\t\t\tfor (const pair of pairs) {\n\t\t\t\t\tif (pair.length !== 2) {\n\t\t\t\t\t\tthrow new TypeError('Each header pair must be a name/value tuple');\n\t\t\t\t\t}\n\t\t\t\t\tthis.append(pair[0], pair[1]);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t// record<ByteString, ByteString>\n\t\t\t\tfor (const key of Object.keys(init)) {\n\t\t\t\t\tconst value = init[key];\n\t\t\t\t\tthis.append(key, value);\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tthrow new TypeError('Provided initializer must be an object');\n\t\t}\n\t}\n\n\t/**\n  * Return combined header value given name\n  *\n  * @param   String  name  Header name\n  * @return  Mixed\n  */\n\tget(name) {\n\t\tname = `${name}`;\n\t\tvalidateName(name);\n\t\tconst key = find(this[MAP], name);\n\t\tif (key === undefined) {\n\t\t\treturn null;\n\t\t}\n\n\t\treturn this[MAP][key].join(', ');\n\t}\n\n\t/**\n  * Iterate over all headers\n  *\n  * @param   Function  callback  Executed for each item with parameters (value, name, thisArg)\n  * @param   Boolean   thisArg   `this` context for callback function\n  * @return  Void\n  */\n\tforEach(callback) {\n\t\tlet thisArg = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : undefined;\n\n\t\tlet pairs = getHeaders(this);\n\t\tlet i = 0;\n\t\twhile (i < pairs.length) {\n\t\t\tvar _pairs$i = pairs[i];\n\t\t\tconst name = _pairs$i[0],\n\t\t\t      value = _pairs$i[1];\n\n\t\t\tcallback.call(thisArg, value, name, this);\n\t\t\tpairs = getHeaders(this);\n\t\t\ti++;\n\t\t}\n\t}\n\n\t/**\n  * Overwrite header values given name\n  *\n  * @param   String  name   Header name\n  * @param   String  value  Header value\n  * @return  Void\n  */\n\tset(name, value) {\n\t\tname = `${name}`;\n\t\tvalue = `${value}`;\n\t\tvalidateName(name);\n\t\tvalidateValue(value);\n\t\tconst key = find(this[MAP], name);\n\t\tthis[MAP][key !== undefined ? key : name] = [value];\n\t}\n\n\t/**\n  * Append a value onto existing header\n  *\n  * @param   String  name   Header name\n  * @param   String  value  Header value\n  * @return  Void\n  */\n\tappend(name, value) {\n\t\tname = `${name}`;\n\t\tvalue = `${value}`;\n\t\tvalidateName(name);\n\t\tvalidateValue(value);\n\t\tconst key = find(this[MAP], name);\n\t\tif (key !== undefined) {\n\t\t\tthis[MAP][key].push(value);\n\t\t} else {\n\t\t\tthis[MAP][name] = [value];\n\t\t}\n\t}\n\n\t/**\n  * Check for header name existence\n  *\n  * @param   String   name  Header name\n  * @return  Boolean\n  */\n\thas(name) {\n\t\tname = `${name}`;\n\t\tvalidateName(name);\n\t\treturn find(this[MAP], name) !== undefined;\n\t}\n\n\t/**\n  * Delete all header values given name\n  *\n  * @param   String  name  Header name\n  * @return  Void\n  */\n\tdelete(name) {\n\t\tname = `${name}`;\n\t\tvalidateName(name);\n\t\tconst key = find(this[MAP], name);\n\t\tif (key !== undefined) {\n\t\t\tdelete this[MAP][key];\n\t\t}\n\t}\n\n\t/**\n  * Return raw headers (non-spec api)\n  *\n  * @return  Object\n  */\n\traw() {\n\t\treturn this[MAP];\n\t}\n\n\t/**\n  * Get an iterator on keys.\n  *\n  * @return  Iterator\n  */\n\tkeys() {\n\t\treturn createHeadersIterator(this, 'key');\n\t}\n\n\t/**\n  * Get an iterator on values.\n  *\n  * @return  Iterator\n  */\n\tvalues() {\n\t\treturn createHeadersIterator(this, 'value');\n\t}\n\n\t/**\n  * Get an iterator on entries.\n  *\n  * This is the default iterator of the Headers object.\n  *\n  * @return  Iterator\n  */\n\t[Symbol.iterator]() {\n\t\treturn createHeadersIterator(this, 'key+value');\n\t}\n}\nHeaders.prototype.entries = Headers.prototype[Symbol.iterator];\n\nObject.defineProperty(Headers.prototype, Symbol.toStringTag, {\n\tvalue: 'Headers',\n\twritable: false,\n\tenumerable: false,\n\tconfigurable: true\n});\n\nObject.defineProperties(Headers.prototype, {\n\tget: { enumerable: true },\n\tforEach: { enumerable: true },\n\tset: { enumerable: true },\n\tappend: { enumerable: true },\n\thas: { enumerable: true },\n\tdelete: { enumerable: true },\n\tkeys: { enumerable: true },\n\tvalues: { enumerable: true },\n\tentries: { enumerable: true }\n});\n\nfunction getHeaders(headers) {\n\tlet kind = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 'key+value';\n\n\tconst keys = Object.keys(headers[MAP]).sort();\n\treturn keys.map(kind === 'key' ? function (k) {\n\t\treturn k.toLowerCase();\n\t} : kind === 'value' ? function (k) {\n\t\treturn headers[MAP][k].join(', ');\n\t} : function (k) {\n\t\treturn [k.toLowerCase(), headers[MAP][k].join(', ')];\n\t});\n}\n\nconst INTERNAL = Symbol('internal');\n\nfunction createHeadersIterator(target, kind) {\n\tconst iterator = Object.create(HeadersIteratorPrototype);\n\titerator[INTERNAL] = {\n\t\ttarget,\n\t\tkind,\n\t\tindex: 0\n\t};\n\treturn iterator;\n}\n\nconst HeadersIteratorPrototype = Object.setPrototypeOf({\n\tnext() {\n\t\t// istanbul ignore if\n\t\tif (!this || Object.getPrototypeOf(this) !== HeadersIteratorPrototype) {\n\t\t\tthrow new TypeError('Value of `this` is not a HeadersIterator');\n\t\t}\n\n\t\tvar _INTERNAL = this[INTERNAL];\n\t\tconst target = _INTERNAL.target,\n\t\t      kind = _INTERNAL.kind,\n\t\t      index = _INTERNAL.index;\n\n\t\tconst values = getHeaders(target, kind);\n\t\tconst len = values.length;\n\t\tif (index >= len) {\n\t\t\treturn {\n\t\t\t\tvalue: undefined,\n\t\t\t\tdone: true\n\t\t\t};\n\t\t}\n\n\t\tthis[INTERNAL].index = index + 1;\n\n\t\treturn {\n\t\t\tvalue: values[index],\n\t\t\tdone: false\n\t\t};\n\t}\n}, Object.getPrototypeOf(Object.getPrototypeOf([][Symbol.iterator]())));\n\nObject.defineProperty(HeadersIteratorPrototype, Symbol.toStringTag, {\n\tvalue: 'HeadersIterator',\n\twritable: false,\n\tenumerable: false,\n\tconfigurable: true\n});\n\n/**\n * Export the Headers object in a form that Node.js can consume.\n *\n * @param   Headers  headers\n * @return  Object\n */\nfunction exportNodeCompatibleHeaders(headers) {\n\tconst obj = Object.assign({ __proto__: null }, headers[MAP]);\n\n\t// http.request() only supports string as Host header. This hack makes\n\t// specifying custom Host header possible.\n\tconst hostHeaderKey = find(headers[MAP], 'Host');\n\tif (hostHeaderKey !== undefined) {\n\t\tobj[hostHeaderKey] = obj[hostHeaderKey][0];\n\t}\n\n\treturn obj;\n}\n\n/**\n * Create a Headers object from an object of headers, ignoring those that do\n * not conform to HTTP grammar productions.\n *\n * @param   Object  obj  Object of headers\n * @return  Headers\n */\nfunction createHeadersLenient(obj) {\n\tconst headers = new Headers();\n\tfor (const name of Object.keys(obj)) {\n\t\tif (invalidTokenRegex.test(name)) {\n\t\t\tcontinue;\n\t\t}\n\t\tif (Array.isArray(obj[name])) {\n\t\t\tfor (const val of obj[name]) {\n\t\t\t\tif (invalidHeaderCharRegex.test(val)) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tif (headers[MAP][name] === undefined) {\n\t\t\t\t\theaders[MAP][name] = [val];\n\t\t\t\t} else {\n\t\t\t\t\theaders[MAP][name].push(val);\n\t\t\t\t}\n\t\t\t}\n\t\t} else if (!invalidHeaderCharRegex.test(obj[name])) {\n\t\t\theaders[MAP][name] = [obj[name]];\n\t\t}\n\t}\n\treturn headers;\n}\n\nconst INTERNALS$1 = Symbol('Response internals');\n\n// fix an issue where \"STATUS_CODES\" aren't a named export for node <10\nconst STATUS_CODES = http.STATUS_CODES;\n\n/**\n * Response class\n *\n * @param   Stream  body  Readable stream\n * @param   Object  opts  Response options\n * @return  Void\n */\nclass Response {\n\tconstructor() {\n\t\tlet body = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : null;\n\t\tlet opts = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n\t\tBody.call(this, body, opts);\n\n\t\tconst status = opts.status || 200;\n\t\tconst headers = new Headers(opts.headers);\n\n\t\tif (body != null && !headers.has('Content-Type')) {\n\t\t\tconst contentType = extractContentType(body);\n\t\t\tif (contentType) {\n\t\t\t\theaders.append('Content-Type', contentType);\n\t\t\t}\n\t\t}\n\n\t\tthis[INTERNALS$1] = {\n\t\t\turl: opts.url,\n\t\t\tstatus,\n\t\t\tstatusText: opts.statusText || STATUS_CODES[status],\n\t\t\theaders,\n\t\t\tcounter: opts.counter\n\t\t};\n\t}\n\n\tget url() {\n\t\treturn this[INTERNALS$1].url || '';\n\t}\n\n\tget status() {\n\t\treturn this[INTERNALS$1].status;\n\t}\n\n\t/**\n  * Convenience property representing if the request ended normally\n  */\n\tget ok() {\n\t\treturn this[INTERNALS$1].status >= 200 && this[INTERNALS$1].status < 300;\n\t}\n\n\tget redirected() {\n\t\treturn this[INTERNALS$1].counter > 0;\n\t}\n\n\tget statusText() {\n\t\treturn this[INTERNALS$1].statusText;\n\t}\n\n\tget headers() {\n\t\treturn this[INTERNALS$1].headers;\n\t}\n\n\t/**\n  * Clone this response\n  *\n  * @return  Response\n  */\n\tclone() {\n\t\treturn new Response(clone(this), {\n\t\t\turl: this.url,\n\t\t\tstatus: this.status,\n\t\t\tstatusText: this.statusText,\n\t\t\theaders: this.headers,\n\t\t\tok: this.ok,\n\t\t\tredirected: this.redirected\n\t\t});\n\t}\n}\n\nBody.mixIn(Response.prototype);\n\nObject.defineProperties(Response.prototype, {\n\turl: { enumerable: true },\n\tstatus: { enumerable: true },\n\tok: { enumerable: true },\n\tredirected: { enumerable: true },\n\tstatusText: { enumerable: true },\n\theaders: { enumerable: true },\n\tclone: { enumerable: true }\n});\n\nObject.defineProperty(Response.prototype, Symbol.toStringTag, {\n\tvalue: 'Response',\n\twritable: false,\n\tenumerable: false,\n\tconfigurable: true\n});\n\nconst INTERNALS$2 = Symbol('Request internals');\n\n// fix an issue where \"format\", \"parse\" aren't a named export for node <10\nconst parse_url = Url.parse;\nconst format_url = Url.format;\n\nconst streamDestructionSupported = 'destroy' in Stream.Readable.prototype;\n\n/**\n * Check if a value is an instance of Request.\n *\n * @param   Mixed   input\n * @return  Boolean\n */\nfunction isRequest(input) {\n\treturn typeof input === 'object' && typeof input[INTERNALS$2] === 'object';\n}\n\nfunction isAbortSignal(signal) {\n\tconst proto = signal && typeof signal === 'object' && Object.getPrototypeOf(signal);\n\treturn !!(proto && proto.constructor.name === 'AbortSignal');\n}\n\n/**\n * Request class\n *\n * @param   Mixed   input  Url or Request instance\n * @param   Object  init   Custom options\n * @return  Void\n */\nclass Request {\n\tconstructor(input) {\n\t\tlet init = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n\t\tlet parsedURL;\n\n\t\t// normalize input\n\t\tif (!isRequest(input)) {\n\t\t\tif (input && input.href) {\n\t\t\t\t// in order to support Node.js' Url objects; though WHATWG's URL objects\n\t\t\t\t// will fall into this branch also (since their `toString()` will return\n\t\t\t\t// `href` property anyway)\n\t\t\t\tparsedURL = parse_url(input.href);\n\t\t\t} else {\n\t\t\t\t// coerce input to a string before attempting to parse\n\t\t\t\tparsedURL = parse_url(`${input}`);\n\t\t\t}\n\t\t\tinput = {};\n\t\t} else {\n\t\t\tparsedURL = parse_url(input.url);\n\t\t}\n\n\t\tlet method = init.method || input.method || 'GET';\n\t\tmethod = method.toUpperCase();\n\n\t\tif ((init.body != null || isRequest(input) && input.body !== null) && (method === 'GET' || method === 'HEAD')) {\n\t\t\tthrow new TypeError('Request with GET/HEAD method cannot have body');\n\t\t}\n\n\t\tlet inputBody = init.body != null ? init.body : isRequest(input) && input.body !== null ? clone(input) : null;\n\n\t\tBody.call(this, inputBody, {\n\t\t\ttimeout: init.timeout || input.timeout || 0,\n\t\t\tsize: init.size || input.size || 0\n\t\t});\n\n\t\tconst headers = new Headers(init.headers || input.headers || {});\n\n\t\tif (inputBody != null && !headers.has('Content-Type')) {\n\t\t\tconst contentType = extractContentType(inputBody);\n\t\t\tif (contentType) {\n\t\t\t\theaders.append('Content-Type', contentType);\n\t\t\t}\n\t\t}\n\n\t\tlet signal = isRequest(input) ? input.signal : null;\n\t\tif ('signal' in init) signal = init.signal;\n\n\t\tif (signal != null && !isAbortSignal(signal)) {\n\t\t\tthrow new TypeError('Expected signal to be an instanceof AbortSignal');\n\t\t}\n\n\t\tthis[INTERNALS$2] = {\n\t\t\tmethod,\n\t\t\tredirect: init.redirect || input.redirect || 'follow',\n\t\t\theaders,\n\t\t\tparsedURL,\n\t\t\tsignal\n\t\t};\n\n\t\t// node-fetch-only options\n\t\tthis.follow = init.follow !== undefined ? init.follow : input.follow !== undefined ? input.follow : 20;\n\t\tthis.compress = init.compress !== undefined ? init.compress : input.compress !== undefined ? input.compress : true;\n\t\tthis.counter = init.counter || input.counter || 0;\n\t\tthis.agent = init.agent || input.agent;\n\t}\n\n\tget method() {\n\t\treturn this[INTERNALS$2].method;\n\t}\n\n\tget url() {\n\t\treturn format_url(this[INTERNALS$2].parsedURL);\n\t}\n\n\tget headers() {\n\t\treturn this[INTERNALS$2].headers;\n\t}\n\n\tget redirect() {\n\t\treturn this[INTERNALS$2].redirect;\n\t}\n\n\tget signal() {\n\t\treturn this[INTERNALS$2].signal;\n\t}\n\n\t/**\n  * Clone this request\n  *\n  * @return  Request\n  */\n\tclone() {\n\t\treturn new Request(this);\n\t}\n}\n\nBody.mixIn(Request.prototype);\n\nObject.defineProperty(Request.prototype, Symbol.toStringTag, {\n\tvalue: 'Request',\n\twritable: false,\n\tenumerable: false,\n\tconfigurable: true\n});\n\nObject.defineProperties(Request.prototype, {\n\tmethod: { enumerable: true },\n\turl: { enumerable: true },\n\theaders: { enumerable: true },\n\tredirect: { enumerable: true },\n\tclone: { enumerable: true },\n\tsignal: { enumerable: true }\n});\n\n/**\n * Convert a Request to Node.js http request options.\n *\n * @param   Request  A Request instance\n * @return  Object   The options object to be passed to http.request\n */\nfunction getNodeRequestOptions(request) {\n\tconst parsedURL = request[INTERNALS$2].parsedURL;\n\tconst headers = new Headers(request[INTERNALS$2].headers);\n\n\t// fetch step 1.3\n\tif (!headers.has('Accept')) {\n\t\theaders.set('Accept', '*/*');\n\t}\n\n\t// Basic fetch\n\tif (!parsedURL.protocol || !parsedURL.hostname) {\n\t\tthrow new TypeError('Only absolute URLs are supported');\n\t}\n\n\tif (!/^https?:$/.test(parsedURL.protocol)) {\n\t\tthrow new TypeError('Only HTTP(S) protocols are supported');\n\t}\n\n\tif (request.signal && request.body instanceof Stream.Readable && !streamDestructionSupported) {\n\t\tthrow new Error('Cancellation of streamed requests with AbortSignal is not supported in node < 8');\n\t}\n\n\t// HTTP-network-or-cache fetch steps 2.4-2.7\n\tlet contentLengthValue = null;\n\tif (request.body == null && /^(POST|PUT)$/i.test(request.method)) {\n\t\tcontentLengthValue = '0';\n\t}\n\tif (request.body != null) {\n\t\tconst totalBytes = getTotalBytes(request);\n\t\tif (typeof totalBytes === 'number') {\n\t\t\tcontentLengthValue = String(totalBytes);\n\t\t}\n\t}\n\tif (contentLengthValue) {\n\t\theaders.set('Content-Length', contentLengthValue);\n\t}\n\n\t// HTTP-network-or-cache fetch step 2.11\n\tif (!headers.has('User-Agent')) {\n\t\theaders.set('User-Agent', 'node-fetch/1.0 (+https://github.com/bitinn/node-fetch)');\n\t}\n\n\t// HTTP-network-or-cache fetch step 2.15\n\tif (request.compress && !headers.has('Accept-Encoding')) {\n\t\theaders.set('Accept-Encoding', 'gzip,deflate');\n\t}\n\n\tlet agent = request.agent;\n\tif (typeof agent === 'function') {\n\t\tagent = agent(parsedURL);\n\t}\n\n\tif (!headers.has('Connection') && !agent) {\n\t\theaders.set('Connection', 'close');\n\t}\n\n\t// HTTP-network fetch step 4.2\n\t// chunked encoding is handled by Node.js\n\n\treturn Object.assign({}, parsedURL, {\n\t\tmethod: request.method,\n\t\theaders: exportNodeCompatibleHeaders(headers),\n\t\tagent\n\t});\n}\n\n/**\n * abort-error.js\n *\n * AbortError interface for cancelled requests\n */\n\n/**\n * Create AbortError instance\n *\n * @param   String      message      Error message for human\n * @return  AbortError\n */\nfunction AbortError(message) {\n  Error.call(this, message);\n\n  this.type = 'aborted';\n  this.message = message;\n\n  // hide custom error implementation details from end-users\n  Error.captureStackTrace(this, this.constructor);\n}\n\nAbortError.prototype = Object.create(Error.prototype);\nAbortError.prototype.constructor = AbortError;\nAbortError.prototype.name = 'AbortError';\n\n// fix an issue where \"PassThrough\", \"resolve\" aren't a named export for node <10\nconst PassThrough$1 = Stream.PassThrough;\nconst resolve_url = Url.resolve;\n\n/**\n * Fetch function\n *\n * @param   Mixed    url   Absolute url or Request instance\n * @param   Object   opts  Fetch options\n * @return  Promise\n */\nfunction fetch(url, opts) {\n\n\t// allow custom promise\n\tif (!fetch.Promise) {\n\t\tthrow new Error('native promise missing, set fetch.Promise to your favorite alternative');\n\t}\n\n\tBody.Promise = fetch.Promise;\n\n\t// wrap http.request into fetch\n\treturn new fetch.Promise(function (resolve, reject) {\n\t\t// build request object\n\t\tconst request = new Request(url, opts);\n\t\tconst options = getNodeRequestOptions(request);\n\n\t\tconst send = (options.protocol === 'https:' ? https : http).request;\n\t\tconst signal = request.signal;\n\n\t\tlet response = null;\n\n\t\tconst abort = function abort() {\n\t\t\tlet error = new AbortError('The user aborted a request.');\n\t\t\treject(error);\n\t\t\tif (request.body && request.body instanceof Stream.Readable) {\n\t\t\t\trequest.body.destroy(error);\n\t\t\t}\n\t\t\tif (!response || !response.body) return;\n\t\t\tresponse.body.emit('error', error);\n\t\t};\n\n\t\tif (signal && signal.aborted) {\n\t\t\tabort();\n\t\t\treturn;\n\t\t}\n\n\t\tconst abortAndFinalize = function abortAndFinalize() {\n\t\t\tabort();\n\t\t\tfinalize();\n\t\t};\n\n\t\t// send request\n\t\tconst req = send(options);\n\t\tlet reqTimeout;\n\n\t\tif (signal) {\n\t\t\tsignal.addEventListener('abort', abortAndFinalize);\n\t\t}\n\n\t\tfunction finalize() {\n\t\t\treq.abort();\n\t\t\tif (signal) signal.removeEventListener('abort', abortAndFinalize);\n\t\t\tclearTimeout(reqTimeout);\n\t\t}\n\n\t\tif (request.timeout) {\n\t\t\treq.once('socket', function (socket) {\n\t\t\t\treqTimeout = setTimeout(function () {\n\t\t\t\t\treject(new FetchError(`network timeout at: ${request.url}`, 'request-timeout'));\n\t\t\t\t\tfinalize();\n\t\t\t\t}, request.timeout);\n\t\t\t});\n\t\t}\n\n\t\treq.on('error', function (err) {\n\t\t\treject(new FetchError(`request to ${request.url} failed, reason: ${err.message}`, 'system', err));\n\t\t\tfinalize();\n\t\t});\n\n\t\treq.on('response', function (res) {\n\t\t\tclearTimeout(reqTimeout);\n\n\t\t\tconst headers = createHeadersLenient(res.headers);\n\n\t\t\t// HTTP fetch step 5\n\t\t\tif (fetch.isRedirect(res.statusCode)) {\n\t\t\t\t// HTTP fetch step 5.2\n\t\t\t\tconst location = headers.get('Location');\n\n\t\t\t\t// HTTP fetch step 5.3\n\t\t\t\tconst locationURL = location === null ? null : resolve_url(request.url, location);\n\n\t\t\t\t// HTTP fetch step 5.5\n\t\t\t\tswitch (request.redirect) {\n\t\t\t\t\tcase 'error':\n\t\t\t\t\t\treject(new FetchError(`redirect mode is set to error: ${request.url}`, 'no-redirect'));\n\t\t\t\t\t\tfinalize();\n\t\t\t\t\t\treturn;\n\t\t\t\t\tcase 'manual':\n\t\t\t\t\t\t// node-fetch-specific step: make manual redirect a bit easier to use by setting the Location header value to the resolved URL.\n\t\t\t\t\t\tif (locationURL !== null) {\n\t\t\t\t\t\t\t// handle corrupted header\n\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\theaders.set('Location', locationURL);\n\t\t\t\t\t\t\t} catch (err) {\n\t\t\t\t\t\t\t\t// istanbul ignore next: nodejs server prevent invalid response headers, we can't test this through normal request\n\t\t\t\t\t\t\t\treject(err);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'follow':\n\t\t\t\t\t\t// HTTP-redirect fetch step 2\n\t\t\t\t\t\tif (locationURL === null) {\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// HTTP-redirect fetch step 5\n\t\t\t\t\t\tif (request.counter >= request.follow) {\n\t\t\t\t\t\t\treject(new FetchError(`maximum redirect reached at: ${request.url}`, 'max-redirect'));\n\t\t\t\t\t\t\tfinalize();\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// HTTP-redirect fetch step 6 (counter increment)\n\t\t\t\t\t\t// Create a new Request object.\n\t\t\t\t\t\tconst requestOpts = {\n\t\t\t\t\t\t\theaders: new Headers(request.headers),\n\t\t\t\t\t\t\tfollow: request.follow,\n\t\t\t\t\t\t\tcounter: request.counter + 1,\n\t\t\t\t\t\t\tagent: request.agent,\n\t\t\t\t\t\t\tcompress: request.compress,\n\t\t\t\t\t\t\tmethod: request.method,\n\t\t\t\t\t\t\tbody: request.body,\n\t\t\t\t\t\t\tsignal: request.signal,\n\t\t\t\t\t\t\ttimeout: request.timeout\n\t\t\t\t\t\t};\n\n\t\t\t\t\t\t// HTTP-redirect fetch step 9\n\t\t\t\t\t\tif (res.statusCode !== 303 && request.body && getTotalBytes(request) === null) {\n\t\t\t\t\t\t\treject(new FetchError('Cannot follow redirect with body being a readable stream', 'unsupported-redirect'));\n\t\t\t\t\t\t\tfinalize();\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// HTTP-redirect fetch step 11\n\t\t\t\t\t\tif (res.statusCode === 303 || (res.statusCode === 301 || res.statusCode === 302) && request.method === 'POST') {\n\t\t\t\t\t\t\trequestOpts.method = 'GET';\n\t\t\t\t\t\t\trequestOpts.body = undefined;\n\t\t\t\t\t\t\trequestOpts.headers.delete('content-length');\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// HTTP-redirect fetch step 15\n\t\t\t\t\t\tresolve(fetch(new Request(locationURL, requestOpts)));\n\t\t\t\t\t\tfinalize();\n\t\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// prepare response\n\t\t\tres.once('end', function () {\n\t\t\t\tif (signal) signal.removeEventListener('abort', abortAndFinalize);\n\t\t\t});\n\t\t\tlet body = res.pipe(new PassThrough$1());\n\n\t\t\tconst response_options = {\n\t\t\t\turl: request.url,\n\t\t\t\tstatus: res.statusCode,\n\t\t\t\tstatusText: res.statusMessage,\n\t\t\t\theaders: headers,\n\t\t\t\tsize: request.size,\n\t\t\t\ttimeout: request.timeout,\n\t\t\t\tcounter: request.counter\n\t\t\t};\n\n\t\t\t// HTTP-network fetch step 12.1.1.3\n\t\t\tconst codings = headers.get('Content-Encoding');\n\n\t\t\t// HTTP-network fetch step 12.1.1.4: handle content codings\n\n\t\t\t// in following scenarios we ignore compression support\n\t\t\t// 1. compression support is disabled\n\t\t\t// 2. HEAD request\n\t\t\t// 3. no Content-Encoding header\n\t\t\t// 4. no content response (204)\n\t\t\t// 5. content not modified response (304)\n\t\t\tif (!request.compress || request.method === 'HEAD' || codings === null || res.statusCode === 204 || res.statusCode === 304) {\n\t\t\t\tresponse = new Response(body, response_options);\n\t\t\t\tresolve(response);\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// For Node v6+\n\t\t\t// Be less strict when decoding compressed responses, since sometimes\n\t\t\t// servers send slightly invalid responses that are still accepted\n\t\t\t// by common browsers.\n\t\t\t// Always using Z_SYNC_FLUSH is what cURL does.\n\t\t\tconst zlibOptions = {\n\t\t\t\tflush: zlib.Z_SYNC_FLUSH,\n\t\t\t\tfinishFlush: zlib.Z_SYNC_FLUSH\n\t\t\t};\n\n\t\t\t// for gzip\n\t\t\tif (codings == 'gzip' || codings == 'x-gzip') {\n\t\t\t\tbody = body.pipe(zlib.createGunzip(zlibOptions));\n\t\t\t\tresponse = new Response(body, response_options);\n\t\t\t\tresolve(response);\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// for deflate\n\t\t\tif (codings == 'deflate' || codings == 'x-deflate') {\n\t\t\t\t// handle the infamous raw deflate response from old servers\n\t\t\t\t// a hack for old IIS and Apache servers\n\t\t\t\tconst raw = res.pipe(new PassThrough$1());\n\t\t\t\traw.once('data', function (chunk) {\n\t\t\t\t\t// see http://stackoverflow.com/questions/37519828\n\t\t\t\t\tif ((chunk[0] & 0x0F) === 0x08) {\n\t\t\t\t\t\tbody = body.pipe(zlib.createInflate());\n\t\t\t\t\t} else {\n\t\t\t\t\t\tbody = body.pipe(zlib.createInflateRaw());\n\t\t\t\t\t}\n\t\t\t\t\tresponse = new Response(body, response_options);\n\t\t\t\t\tresolve(response);\n\t\t\t\t});\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// for br\n\t\t\tif (codings == 'br' && typeof zlib.createBrotliDecompress === 'function') {\n\t\t\t\tbody = body.pipe(zlib.createBrotliDecompress());\n\t\t\t\tresponse = new Response(body, response_options);\n\t\t\t\tresolve(response);\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// otherwise, use response as-is\n\t\t\tresponse = new Response(body, response_options);\n\t\t\tresolve(response);\n\t\t});\n\n\t\twriteToStream(req, request);\n\t});\n}\n/**\n * Redirect code matching\n *\n * @param   Number   code  Status code\n * @return  Boolean\n */\nfetch.isRedirect = function (code) {\n\treturn code === 301 || code === 302 || code === 303 || code === 307 || code === 308;\n};\n\n// expose Promise\nfetch.Promise = global.Promise;\n\nexport default fetch;\nexport { Headers, Request, Response, FetchError };\n","var nodeFetch = require('node-fetch')\nvar realFetch = nodeFetch.default || nodeFetch\n\nvar fetch = function (url, options) {\n  // Support schemaless URIs on the server for parity with the browser.\n  // Ex: //github.com/ -> https://github.com/\n  if (/^\\/\\//.test(url)) {\n    url = 'https:' + url\n  }\n  return realFetch.call(this, url, options)\n}\n\nmodule.exports = exports = fetch\nexports.fetch = fetch\nexports.Headers = nodeFetch.Headers\nexports.Request = nodeFetch.Request\nexports.Response = nodeFetch.Response\n\n// Needed for TypeScript consumers without esModuleInterop.\nexports.default = fetch\n","var fetchNode = require('./node-ponyfill')\nvar fetch = fetchNode.fetch.bind({})\n\nfetch.polyfill = true\n\nif (!global.fetch) {\n  global.fetch = fetch\n  global.Response = fetchNode.Response\n  global.Headers = fetchNode.Headers\n  global.Request = fetchNode.Request\n}\n","import { Observable, Observer } from \"rxjs\";\r\nconst path = require('path');\r\nconst fs = require('fs');\r\n\r\nexport default class FileService {\r\n\tstatic exists(pathname: string): boolean {\r\n\t\treturn fs.existsSync(pathname);\r\n\t}\r\n\tstatic exists$(pathname: string): Observable<boolean> {\r\n\t\treturn Observable.create((observer: Observer<boolean>) => {\r\n\t\t\ttry {\r\n\t\t\t\tfs.access(pathname, fs.constants.F_OK, (error: Error) => {\r\n\t\t\t\t\tconst exists: boolean = !error;\r\n\t\t\t\t\tobserver.next(exists);\r\n\t\t\t\t\tobserver.complete();\r\n\t\t\t\t});\r\n\t\t\t} catch (error) {\r\n\t\t\t\tconsole.log('FileService.exists$.error', error);\r\n\t\t\t\tobserver.next(false);\r\n\t\t\t\tobserver.complete();\r\n\t\t\t\t// observer.error(error);\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\tstatic readFile(pathname: string): string | null {\r\n\t\tconst dirname: string = path.dirname(pathname);\r\n\t\tif (!fs.existsSync(dirname)) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\treturn fs.readFileSync(pathname, 'utf8');\r\n\t}\r\n\tstatic readFile$(pathname: string): Observable<string | null> {\r\n\t\treturn Observable.create((observer: Observer<string | null>) => {\r\n\t\t\ttry {\r\n\t\t\t\tfs.readFile(pathname, 'utf8', (error: Error, data: string) => {\r\n\t\t\t\t\t// return observer.error(error);\r\n\t\t\t\t\tobserver.next(error ? null : data);\r\n\t\t\t\t\tobserver.complete();\r\n\t\t\t\t});\r\n\t\t\t\t// sync\r\n\t\t\t\t// observer.next(this.readFile(pathname));\r\n\t\t\t\t// observer.complete();\r\n\t\t\t} catch (error) {\r\n\t\t\t\tconsole.log('FileService.readFile$.error', error);\r\n\t\t\t\tobserver.next(null);\r\n\t\t\t\tobserver.complete();\r\n\t\t\t\t// observer.error(error);\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\tstatic writeFile(pathname: string, content: string): boolean {\r\n\t\ttry {\r\n\t\t\tconst dirname: string = path.dirname(pathname);\r\n\t\t\tif (!fs.existsSync(dirname)) {\r\n\t\t\t\tfs.mkdirSync(dirname);\r\n\t\t\t}\r\n\t\t\tfs.writeFileSync(pathname, content, 'utf8');\r\n\t\t\treturn true;\r\n\t\t} catch (error) {\r\n\t\t\tconsole.log('FileService.writeFile.error', error);\r\n\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n\tstatic writeFile$(pathname: string, content: string): Observable<boolean> {\r\n\t\treturn Observable.create((observer: Observer<boolean>) => {\r\n\t\t\ttry {\r\n\t\t\t\tconst dirname: string = path.dirname(pathname);\r\n\t\t\t\tfs.mkdir(dirname, { recursive: true }, (error: Error) => {\r\n\t\t\t\t\tif (error) {\r\n\t\t\t\t\t\tobserver.next(false);\r\n\t\t\t\t\t\tobserver.complete();\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t// return observer.error(error);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tfs.writeFile(pathname, content, 'utf8', (error: Error) => {\r\n\t\t\t\t\t\tobserver.next(!error);\r\n\t\t\t\t\t\tobserver.complete();\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t\t// sync\r\n\t\t\t\t// this.writeFile(pathname, content);\r\n\t\t\t\t// observer.next(true);\r\n\t\t\t\t// observer.complete();\r\n\t\t\t} catch (error) {\r\n\t\t\t\tconsole.log('FileService.writeFile$.error', error);\r\n\t\t\t\tobserver.next(false);\r\n\t\t\t\tobserver.complete();\r\n\t\t\t\t// observer.error(error);\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\tstatic unlinkFile(pathname: string): boolean {\r\n\t\ttry {\r\n\t\t\tif (fs.existsSync(pathname)) {\r\n\t\t\t\tfs.unlinkSync(pathname);\r\n\t\t\t\treturn true;\r\n\t\t\t} else {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t} catch (error) {\r\n\t\t\tconsole.log('FileService.unlinkFile.error', error);\r\n\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n\tstatic unlinkFile$(pathname: string): Observable<boolean> {\r\n\t\treturn Observable.create((observer: Observer<boolean>) => {\r\n\t\t\ttry {\r\n\t\t\t\tfs.unlink(pathname, (error: Error) => {\r\n\t\t\t\t\tobserver.next(!error);\r\n\t\t\t\t\tobserver.complete();\r\n\t\t\t\t\t// return observer.error(error);\r\n\t\t\t\t});\r\n\t\t\t\t// sync\r\n\t\t\t\t// this.unlinkFile(pathname);\r\n\t\t\t\t// observer.next(true);\r\n\t\t\t\t// observer.complete();\r\n\t\t\t} catch (error) {\r\n\t\t\t\tconsole.log('FileService.unlinkFile$.error', error);\r\n\t\t\t\tobserver.next(false);\r\n\t\t\t\t// observer.error(error);\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n}\r\n","import { decodeJson, encodeJson, Serializer } from \"rxcomp\";\r\nimport { Observable, Observer, of } from \"rxjs\";\r\nimport { map, switchMap } from \"rxjs/operators\";\r\nimport FileService from \"../file/file.service\";\r\n\r\nexport enum CacheMode {\r\n\tMemory = 'memory',\r\n\tFile = 'file',\r\n}\r\nexport enum CacheControlType {\r\n\tPublic = 'public', // The response may be stored by any cache, even if the response is normally non-cacheable.\r\n\tPrivate = 'private', // The response may be stored only by a browser's cache, even if the response is normally non-cacheable. If you mean to not store the response in any cache, use no-store instead. This directive is not effective in preventing caches from storing your response.\r\n\tNoCache = 'no-cache', // The response may be stored by any cache, even if the response is normally non-cacheable. However, the stored response MUST always go through validation with the origin server first before using it, therefore, you cannot use no-cache in-conjunction with immutable. If you mean to not store the response in any cache, use no-store instead. This directive is not effective in preventing caches from storing your response.\r\n\tNoStore = 'no-store', // The response may not be stored in any cache. Although other directives may be set, this alone is the only directive you need in preventing cached responses on modern browsers. max-age=0 is already implied. Setting must-revalidate does not make sense because in order to go through revalidation you need the response to be stored in a cache, which no-store prevents.\r\n}\r\nexport interface ICacheItem {\r\n\tvalue: any;\r\n\tdate?: Date,\r\n\tmaxAge?: number;\r\n\tcacheControl?: CacheControlType;\r\n}\r\nexport class CacheItem {\r\n\tvalue: any;\r\n\tdate: Date = new Date();\r\n\tmaxAge: number = 0;\r\n\tcacheControl: CacheControlType = CacheControlType.Public;\r\n\tget expired(): boolean {\r\n\t\treturn this.cacheControl === CacheControlType.NoStore\r\n\t\t\t|| this.maxAge === 0\r\n\t\t\t|| (this.date.getTime() + (this.maxAge * 1000) < Date.now());\r\n\t}\r\n\tconstructor(options?: ICacheItem) {\r\n\t\tif (options) {\r\n\t\t\tthis.value = options.value;\r\n\t\t\tthis.date = options.date ? new Date(options.date) : this.date;\r\n\t\t\tthis.maxAge = options.maxAge || this.maxAge;\r\n\t\t\tthis.cacheControl = options.cacheControl || this.cacheControl;\r\n\t\t}\r\n\t}\r\n\tstatic toData(cacheItem: CacheItem): string | undefined {\r\n\t\treturn Serializer.encode(cacheItem, [encodeJson]);\r\n\t}\r\n\tstatic fromData(data: string): CacheItem {\r\n\t\treturn new CacheItem(Serializer.decode<ICacheItem>(data, [decodeJson]));\r\n\t}\r\n}\r\nexport default class CacheService {\r\n\tprivate static cache_: { [key: string]: string } = {};\r\n\tstatic mode: CacheMode = CacheMode.Memory;\r\n\tstatic folder: string;\r\n\tstatic has(type: string = 'cache', filename: string): boolean {\r\n\t\tlet has: boolean = false;\r\n\t\ttry {\r\n\t\t\tconst key: string = this.getPath(type, filename);\r\n\t\t\tswitch (this.mode) {\r\n\t\t\t\tcase CacheMode.File:\r\n\t\t\t\t\thas = FileService.exists(key);\r\n\t\t\t\t\t// has = this.hasFile(type, filename);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase CacheMode.Memory:\r\n\t\t\t\tdefault:\r\n\t\t\t\t\thas = Object.keys(this.cache_).indexOf(key) !== -1;\r\n\t\t\t}\r\n\t\t} catch (error) {\r\n\t\t\tconsole.log('CacheService.has.error', error);\r\n\t\t}\r\n\t\treturn has;\r\n\t}\r\n\tstatic get<T>(type: string, filename: string): T;\r\n\tstatic get(type: string = 'cache', filename: string): any {\r\n\t\tlet value = null, cacheItem: CacheItem | null;\r\n\t\ttry {\r\n\t\t\tconst key: string = this.getPath(type, filename);\r\n\t\t\tswitch (this.mode) {\r\n\t\t\t\tcase CacheMode.File:\r\n\t\t\t\t\tif (FileService.exists(key)) {\r\n\t\t\t\t\t\tconst data: string | null = FileService.readFile(key);\r\n\t\t\t\t\t\tif (data) {\r\n\t\t\t\t\t\t\tcacheItem = CacheItem.fromData(data);\r\n\t\t\t\t\t\t\tif (cacheItem.expired) {\r\n\t\t\t\t\t\t\t\tFileService.unlinkFile(key);\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tvalue = cacheItem?.value;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase CacheMode.Memory:\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tif (Object.keys(this.cache_).indexOf(key) !== -1) {\r\n\t\t\t\t\t\tconst data: string | undefined = this.cache_[key];\r\n\t\t\t\t\t\tif (data) {\r\n\t\t\t\t\t\t\tcacheItem = CacheItem.fromData(data);\r\n\t\t\t\t\t\t\tif (cacheItem) {\r\n\t\t\t\t\t\t\t\tif (cacheItem.expired) {\r\n\t\t\t\t\t\t\t\t\tdelete this.cache_[key];\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\tvalue = cacheItem.value;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t}\r\n\t\t} catch (error) {\r\n\t\t\tconsole.log('CacheService.get.error', error);\r\n\t\t}\r\n\t\treturn value;\r\n\t}\r\n\tstatic set(type: string = 'cache', filename: string, value: any, maxAge: number = 0, cacheControl: CacheControlType = CacheControlType.Public): any {\r\n\t\ttry {\r\n\t\t\tconst key: string = this.getPath(type, filename);\r\n\t\t\tconst cacheItem: CacheItem = new CacheItem({ value, maxAge, cacheControl });\r\n\t\t\tlet data: string | undefined;\r\n\t\t\tswitch (this.mode) {\r\n\t\t\t\tcase CacheMode.File:\r\n\t\t\t\t\tdata = CacheItem.toData(cacheItem);\r\n\t\t\t\t\tif (data) {\r\n\t\t\t\t\t\tFileService.writeFile(key, data);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase CacheMode.Memory:\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tdata = CacheItem.toData(cacheItem);\r\n\t\t\t\t\tif (data) {\r\n\t\t\t\t\t\tthis.cache_[key] = data;\r\n\t\t\t\t\t}\r\n\t\t\t}\r\n\t\t} catch (error) {\r\n\t\t\tconsole.log('CacheService.set.error', error);\r\n\t\t}\r\n\t\treturn value;\r\n\t}\r\n\tstatic delete(type: string = 'cache', filename: string): void {\r\n\t\ttry {\r\n\t\t\tconst key: string = this.getPath(type, filename);\r\n\t\t\tswitch (this.mode) {\r\n\t\t\t\tcase CacheMode.File:\r\n\t\t\t\t\tFileService.unlinkFile(key);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase CacheMode.Memory:\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tif (Object.keys(this.cache_).indexOf(key) !== -1) {\r\n\t\t\t\t\t\tdelete this.cache_[key];\r\n\t\t\t\t\t}\r\n\t\t\t}\r\n\t\t} catch (error) {\r\n\t\t\tconsole.log('CacheService.delete.error', error);\r\n\t\t}\r\n\t}\r\n\tstatic has$(type: string = 'cache', filename: string): Observable<boolean> {\r\n\t\tconst key$: Observable<string> = Observable.create((observer: Observer<string>) => {\r\n\t\t\tconst key: string = this.getPath(type, filename);\r\n\t\t\tobserver.next(key);\r\n\t\t\tobserver.complete();\r\n\t\t});\r\n\t\treturn key$.pipe(\r\n\t\t\tswitchMap((key: string) => {\r\n\t\t\t\tif (this.mode === CacheMode.File) {\r\n\t\t\t\t\treturn FileService.exists$(key);\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn of(Object.keys(this.cache_).indexOf(key) !== -1);\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t);\r\n\t}\r\n\tstatic get$<T>(type: string, filename: string): Observable<T>;\r\n\tstatic get$(type: string = 'cache', filename: string): Observable<any> {\r\n\t\tlet key: string;\r\n\t\tconst key$: Observable<string> = Observable.create((observer: Observer<string>) => {\r\n\t\t\tkey = this.getPath(type, filename);\r\n\t\t\tobserver.next(key);\r\n\t\t\tobserver.complete();\r\n\t\t});\r\n\t\treturn key$.pipe(\r\n\t\t\tswitchMap((key: string) => {\r\n\t\t\t\tif (this.mode === CacheMode.File) {\r\n\t\t\t\t\treturn FileService.readFile$(key);\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn of(this.cache_[key]);\r\n\t\t\t\t}\r\n\t\t\t}),\r\n\t\t\tswitchMap((data: string | undefined | null) => {\r\n\t\t\t\tconst cacheItem: CacheItem | null = data ? CacheItem.fromData(data) : null;\r\n\t\t\t\tif (cacheItem && cacheItem.expired) {\r\n\t\t\t\t\treturn FileService.unlinkFile$(key).pipe(map(() => null));\r\n\t\t\t\t}\r\n\t\t\t\treturn of(cacheItem ? cacheItem.value : null);\r\n\t\t\t}),\r\n\t\t);\r\n\t}\r\n\tstatic set$(type: string = 'cache', filename: string, value: any, maxAge: number = 0, cacheControl: CacheControlType = CacheControlType.Public): any {\r\n\t\tlet key: string, cacheItem: CacheItem, data: string | undefined;\r\n\t\tconst data$: Observable<string> = Observable.create((observer: Observer<string | undefined>) => {\r\n\t\t\tkey = this.getPath(type, filename);\r\n\t\t\tcacheItem = new CacheItem({ value, maxAge, cacheControl });\r\n\t\t\tdata = CacheItem.toData(cacheItem);\r\n\t\t\tobserver.next(data);\r\n\t\t\tobserver.complete();\r\n\t\t});\r\n\t\treturn data$.pipe(\r\n\t\t\tswitchMap((data: string | undefined) => {\r\n\t\t\t\tif (data) {\r\n\t\t\t\t\tif (this.mode === CacheMode.File) {\r\n\t\t\t\t\t\treturn FileService.writeFile$(key, data);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis.cache_[key] = data;\r\n\t\t\t\t\t\treturn of(true);\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn of(false);\r\n\t\t\t\t}\r\n\t\t\t}),\r\n\t\t);\r\n\t}\r\n\tstatic delete$(type: string = 'cache', filename: string): Observable<boolean> {\r\n\t\tlet key: string;\r\n\t\tconst key$: Observable<string> = Observable.create((observer: Observer<string>) => {\r\n\t\t\tkey = this.getPath(type, filename);\r\n\t\t\tobserver.next(key);\r\n\t\t\tobserver.complete();\r\n\t\t});\r\n\t\treturn key$.pipe(\r\n\t\t\tswitchMap((key: string) => {\r\n\t\t\t\tif (this.mode === CacheMode.File) {\r\n\t\t\t\t\treturn FileService.unlinkFile$(key);\r\n\t\t\t\t} else if (Object.keys(this.cache_).indexOf(key) !== -1) {\r\n\t\t\t\t\tdelete this.cache_[key];\r\n\t\t\t\t\treturn of(true);\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn of(false);\r\n\t\t\t\t}\r\n\t\t\t}),\r\n\t\t);\r\n\t}\r\n\tprotected static getPath(type: string = 'cache', filename: string): string {\r\n\t\tconst key: string = this.getKey(type, filename);\r\n\t\treturn `${this.folder}${key}`;\r\n\t}\r\n\tprotected static getKey(type: string = 'cache', filename: string): string {\r\n\t\tlet key: string = `${type}-${filename}`.toLowerCase();\r\n\t\tkey = key.replace(/(\\s+)|(\\W+)/g, function (...matches) { return matches[1] ? '' : '_' });\r\n\t\treturn key;\r\n\t}\r\n}\r\n/*\r\nCache-Control: max-age=0, private, must-revalidate\r\nDate: Fri, 14 Aug 2020 20:09:02 GMT\r\nExpect-CT: max-age=2592000, report-uri=\"https://api.github.com/_private/browser/errors\"\r\nStatus: 200 OK\r\nStrict-Transport-Security: max-age=31536000; includeSubdomains; preload\r\nCache-Control: no-cache\r\nConnection: keep-alive\r\nPragma: no-cache\r\n*/\r\n","import { Parser } from 'htmlparser2';\r\nimport { ILocation, RxLocation } from '../location/location';\r\n\r\nexport enum RxNodeType {\r\n\tELEMENT_NODE = 1, //\tUn nodo Element come <p> o <div>.\r\n\tTEXT_NODE = 3, //\tL'attuale Text dentro un Element o Attr.\r\n\tCDATA_SECTION_NODE = 4, //\tUna CDATASection, ad esempio <!CDATA[[ … ]]>.\r\n\tPROCESSING_INSTRUCTION_NODE = 7, //\tUna ProcessingInstruction di un documento XML, come <?xml-stylesheet … ?>.\r\n\tCOMMENT_NODE = 8, //\tUn nodo Comment, come <!-- … -->.\r\n\tDOCUMENT_NODE = 9, //\tUn nodo Document.\r\n\tDOCUMENT_TYPE_NODE = 10, //\tUn nodo DocumentType, come <!DOCTYPE html>.\r\n\tDOCUMENT_FRAGMENT_NODE = 11, //\tUn nodo DocumentFragment.\r\n}\r\nexport enum SelectorType {\r\n\tNone = -1,\r\n\tId = 0,\r\n\tClass = 1,\r\n\tAttribute = 2,\r\n\tTagName = 3,\r\n}\r\nexport class RxSelector {\r\n\tselector: string = '';\r\n\ttype: SelectorType = SelectorType.None;\r\n\tnegate: boolean = false;\r\n\tconstructor(options: RxSelector) {\r\n\t\tif (options) {\r\n\t\t\tObject.assign(this, options);\r\n\t\t}\r\n\t}\r\n}\r\nexport class RxQuery {\r\n\tselector: string = '';\r\n\tselectors: RxSelector[] = [];\r\n\tinner: boolean = false;\r\n\tconstructor(options: RxQuery) {\r\n\t\tif (options) {\r\n\t\t\tObject.assign(this, options);\r\n\t\t}\r\n\t}\r\n}\r\nexport class RxNode {\r\n\tparentNode: RxElement | null;\r\n\tnodeType: RxNodeType;\r\n\tnodeValue: string | null = null;\r\n\tconstructor(parentNode: RxElement | null = null) {\r\n\t\tthis.parentNode = parentNode;\r\n\t\tthis.nodeType = -1;\r\n\t}\r\n\tcloneNode(deep: boolean = false) {\r\n\t\treturn cloneNode.apply(this, [this, deep]);\r\n\t}\r\n\tserialize(): string {\r\n\t\treturn ``;\r\n\t}\r\n}\r\nexport class RxStyle {\r\n\t[key: string]: any;\r\n\tconstructor(node: RxElement) {\r\n\t\tObject.defineProperty(this, 'node', {\r\n\t\t\tvalue: node,\r\n\t\t\twritable: false,\r\n\t\t\tenumerable: false\r\n\t\t});\r\n\t\tthis.init();\r\n\t}\r\n\tinit() {\r\n\t\tconst keys = Object.keys(this);\r\n\t\tkeys.forEach(key => delete this[key]);\r\n\t\tif (this.node.attributes?.style) {\r\n\t\t\tconst regex: RegExp = /([^:]+):([^;]+);?\\s*/gm\r\n\t\t\tconst matches: RegExpMatchArray[] = [...this.node.attributes.style.matchAll(regex)];\r\n\t\t\tmatches.forEach((match: RegExpMatchArray) => {\r\n\t\t\t\tconst key: string = match[1];\r\n\t\t\t\tconst value: string = match[2];\r\n\t\t\t\tthis[key] = value;\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\titem(index: number): string | undefined {\r\n\t\tconst keys = Object.keys(this);\r\n\t\tif (keys.length > index) {\r\n\t\t\treturn keys[index];\r\n\t\t} else {\r\n\t\t\treturn undefined;\r\n\t\t}\r\n\t}\r\n\tgetPropertyPriority(key: string): string {\r\n\t\tconst value = this[key];\r\n\t\tif (value && value.indexOf('!important')) {\r\n\t\t\treturn 'important';\r\n\t\t} else {\r\n\t\t\treturn '';\r\n\t\t}\r\n\t}\r\n\tgetPropertyValue(key: string): string {\r\n\t\treturn this[key];\r\n\t}\r\n\tsetProperty(key: string, value: string, important: 'important' | '' | undefined) {\r\n\t\tthis[key] = value + (important === 'important' ? '!important' : '');\r\n\t\tthis.serialize_();\r\n\t}\r\n\tremoveProperty(key: string) {\r\n\t\tdelete this[key];\r\n\t\tthis.serialize_();\r\n\t}\r\n\tprivate serialize_() {\r\n\t\tthis.node.attributes.style = Object.keys(this).map(key => {\r\n\t\t\treturn `${key}: ${this[key]};`;\r\n\t\t}).join(' ');\r\n\t}\r\n}\r\nexport class RxClassList extends Array<string> {\r\n\tprivate node_!: RxElement;\r\n\tget node(): RxElement {\r\n\t\treturn this.node_;\r\n\t}\r\n\tset node(node) {\r\n\t\tif (this.node_ !== node) {\r\n\t\t\tthis.node_ = node;\r\n\t\t\tthis.init();\r\n\t\t}\r\n\t}\r\n\tconstructor(...args: any[]) {\r\n\t\tsuper(...args);\r\n\t}\r\n\tinit() {\r\n\t\tthis.length = 0;\r\n\t\t// console.log('RxClassList.node', this.node);\r\n\t\tif (this.node.hasAttribute('class')) {\r\n\t\t\tArray.prototype.push.apply(this, this.node.getAttribute('class')!.split(' ').map(name => name.trim()));\r\n\t\t}\r\n\t}\r\n\tslice(start?: number, end?: number): RxClassList {\r\n\t\tconst length = this.length;\r\n\t\tstart = start || 0;\r\n\t\tstart = (start >= 0) ? start : Math.max(0, length + start);\r\n\t\tend = (typeof end !== 'undefined') ? end : length;\r\n\t\tend = (end >= 0) ? Math.min(end, length) : length + end;\r\n\t\tconst size: number = end - start;\r\n\t\tconst classList: RxClassList = size > 0 ? new RxClassList(size) : new RxClassList();\r\n\t\tlet i: number;\r\n\t\tfor (i = 0; i < size; i++) {\r\n\t\t\tclassList[i] = this[start + i];\r\n\t\t}\r\n\t\tclassList.node = this.node;\r\n\t\t/*\r\n\t\t// !!! from string ?\r\n\t\tif (this.charAt) {\r\n\t\t\tfor (i = 0; i < size; i++) {\r\n\t\t\t\tclassList[i] = this.charAt(from + i);\r\n\t\t\t}\r\n\t\t}\r\n\t\t*/\r\n\t\treturn classList;\r\n\t}\r\n\titem(index: number) {\r\n\t\treturn this[index];\r\n\t}\r\n\tcontains(name: string): boolean {\r\n\t\treturn this.indexOf(name) !== -1;\r\n\t}\r\n\tadd(...names: string[]) {\r\n\t\tnames.forEach(name => {\r\n\t\t\tif (this.indexOf(name) === -1) {\r\n\t\t\t\tthis.push(name);\r\n\t\t\t}\r\n\t\t});\r\n\t\tthis.serialize_();\r\n\t\t// console.log('RxClasslist.add', `[${this.join(', ')}]`, this.node.attributes.class, names);\r\n\t}\r\n\tremove(...names: string[]) {\r\n\t\tnames.forEach(name => {\r\n\t\t\tconst index: number = this.indexOf(name);\r\n\t\t\tif (index !== -1) {\r\n\t\t\t\tthis.splice(index, 1);\r\n\t\t\t}\r\n\t\t});\r\n\t\tthis.serialize_();\r\n\t}\r\n\ttoggle(name: string, force?: boolean): boolean {\r\n\t\tconst index: number = this.indexOf(name);\r\n\t\tif (force === false) {\r\n\t\t\tthis.splice(index, 1);\r\n\t\t\tthis.serialize_();\r\n\t\t\treturn false;\r\n\t\t} else if (force === true) {\r\n\t\t\tthis.push(name);\r\n\t\t\tthis.serialize_();\r\n\t\t\treturn true;\r\n\t\t} else if (index !== -1) {\r\n\t\t\tthis.splice(index, 1);\r\n\t\t\tthis.serialize_();\r\n\t\t\treturn false;\r\n\t\t} else {\r\n\t\t\tthis.push(name);\r\n\t\t\tthis.serialize_();\r\n\t\t\treturn true;\r\n\t\t}\r\n\t}\r\n\treplace(oldClass: string, newClass: string) {\r\n\t\tconst index: number = this.indexOf(oldClass);\r\n\t\tif (index !== -1) {\r\n\t\t\tthis.splice(index, 1);\r\n\t\t}\r\n\t\tthis.push(newClass);\r\n\t\tthis.serialize_();\r\n\t}\r\n\tprivate serialize_() {\r\n\t\tthis.node.setAttribute('class', this.join(' '));\r\n\t}\r\n}\r\nexport class RxElement extends RxNode {\r\n\tnodeName: string;\r\n\tchildNodes: RxNode[];\r\n\tattributes: { [key: string]: string | null } = {};\r\n\tstyle: RxStyle;\r\n\tclassList: RxClassList;\r\n\tget children(): RxElement[] {\r\n\t\tlet children: RxElement[] = [],\r\n\t\t\ti = 0,\r\n\t\t\tnode,\r\n\t\t\tnodes = this.childNodes;\r\n\t\tnode = nodes[i++];\r\n\t\twhile (node) {\r\n\t\t\tif (node.nodeType === RxNodeType.ELEMENT_NODE) {\r\n\t\t\t\tchildren.push(node as RxElement);\r\n\t\t\t}\r\n\t\t\tnode = nodes[i++];\r\n\t\t}\r\n\t\treturn children;\r\n\t}\r\n\tget childElementCount(): number {\r\n\t\tlet i = 0,\r\n\t\t\tcount = 0,\r\n\t\t\tnode,\r\n\t\t\tnodes = this.childNodes;\r\n\t\tnode = nodes[i++];\r\n\t\twhile (node) {\r\n\t\t\tif (node.nodeType === RxNodeType.ELEMENT_NODE) {\r\n\t\t\t\tcount++;\r\n\t\t\t}\r\n\t\t\tnode = nodes[i++];\r\n\t\t}\r\n\t\treturn count;\r\n\t}\r\n\tget firstChild(): RxNode | null {\r\n\t\tlet node = null;\r\n\t\tif (this.childNodes.length) {\r\n\t\t\tnode = this.childNodes[0];\r\n\t\t}\r\n\t\treturn node;\r\n\t}\r\n\tget firstElementChild(): RxElement | null {\r\n\t\tfor (let node of this.childNodes) {\r\n\t\t\tif (isRxElement(node)) {\r\n\t\t\t\treturn node;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn null;\r\n\t}\r\n\tget lastChild(): RxNode | null {\r\n\t\tlet node = null;\r\n\t\tif (this.childNodes.length) {\r\n\t\t\tnode = this.childNodes[this.childNodes.length - 1];\r\n\t\t}\r\n\t\treturn node;\r\n\t}\r\n\tget lastElementChild(): RxElement | null {\r\n\t\tconst nodes = this.childNodes;\r\n\t\tfor (let i = nodes.length - 1; i > -1; i--) {\r\n\t\t\tconst node = nodes[i];\r\n\t\t\tif (isRxElement(node)) {\r\n\t\t\t\treturn node;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn null;\r\n\t}\r\n\tget previousSibling(): RxNode | null {\r\n\t\tlet node = null;\r\n\t\tif (this.parentNode) {\r\n\t\t\tconst index = this.parentNode.childNodes.indexOf(this);\r\n\t\t\tif (index > 0) {\r\n\t\t\t\tnode = this.parentNode.childNodes[index - 1];\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn node;\r\n\t}\r\n\tget nextSibling(): RxNode | null {\r\n\t\tlet node = null;\r\n\t\tif (this.parentNode) {\r\n\t\t\tconst index = this.parentNode.childNodes.indexOf(this);\r\n\t\t\tif (index !== -1 && index < this.parentNode.childNodes.length - 1) {\r\n\t\t\t\tnode = this.parentNode.childNodes[index];\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn node;\r\n\t}\r\n\tget wholeText() {\r\n\t\tlet nodeValue;\r\n\t\tif (this.nodeType === RxNodeType.TEXT_NODE) {\r\n\t\t\treturn this.nodeValue;\r\n\t\t}\r\n\t\treturn nodeValue;\r\n\t}\r\n\tget outerHTML(): string | null {\r\n\t\tlet html = null;\r\n\t\tif (this.parentNode) {\r\n\t\t\thtml = this.parentNode.serialize();\r\n\t\t}\r\n\t\treturn html;\r\n\t}\r\n\tset innerText(nodeValue: string | null) {\r\n\t\tthis.childNodes = [new RxText(this, nodeValue)];\r\n\t}\r\n\tget innerText(): string | null {\r\n\t\t// return this.childNodes.filter((n): n is RxText => isRxText(n)).map(n => n.innerText).join('');\r\n\t\treturn this.childNodes.filter((n): n is RxText | RxElement => isRxText(n) || isRxElement(n)).map(n => n.innerText).join('');\r\n\t}\r\n\tset textContent(nodeValue: string | null) {\r\n\t\tthis.innerText = String(nodeValue);\r\n\t}\r\n\tget textContent(): string | null {\r\n\t\treturn this.innerText;\r\n\t}\r\n\tget innerHTML(): string {\r\n\t\treturn this.childNodes.map(x => x.serialize()).join('');\r\n\t}\r\n\tset innerHTML(html: string) {\r\n\t\tconst doc = parse(html);\r\n\t\tconst childNodes = doc.childNodes.map(n => {\r\n\t\t\tn.parentNode = this;\r\n\t\t\treturn n;\r\n\t\t});\r\n\t\tthis.childNodes = childNodes;\r\n\t}\r\n\tconstructor(parentNode: RxElement | null = null, nodeName: string, attributes: { [key: string]: string | null } | null = null) {\r\n\t\tsuper(parentNode);\r\n\t\tthis.nodeType = RxNodeType.ELEMENT_NODE;\r\n\t\tthis.nodeName = nodeName;\r\n\t\tif (attributes && typeof attributes === 'object') {\r\n\t\t\tthis.attributes = attributes;\r\n\t\t}\r\n\t\t// console.log('RxElement.constructor', this);\r\n\t\tthis.style = new RxStyle(this);\r\n\t\tconst classList = new RxClassList();\r\n\t\tclassList.node = this;\r\n\t\tthis.classList = classList;\r\n\t\tthis.childNodes = [];\r\n\t\t/*\r\n\t\tif (SKIP.indexOf(nodeName) === -1) {\r\n\t\t\t// console.log(parentNode.nodeName, '>', nodeName);\r\n\t\t}\r\n\t\t*/\r\n\t}\r\n\tappend(...nodesOrDOMStrings: (RxNode | string)[]) {\r\n\t\tnodesOrDOMStrings = nodesOrDOMStrings.map(nodeOrDomString => {\r\n\t\t\tlet node;\r\n\t\t\tif (typeof nodeOrDomString === 'string') {\r\n\t\t\t\tnode = new RxText(this, nodeOrDomString);\r\n\t\t\t} else {\r\n\t\t\t\tnode = nodeOrDomString;\r\n\t\t\t\tnode.parentNode = this;\r\n\t\t\t}\r\n\t\t\treturn node;\r\n\t\t});\r\n\t\tArray.prototype.push.apply(this.childNodes, nodesOrDOMStrings);\r\n\t\t/*\r\n\t\tfor (let nodeOrDomString of nodesOrDOMStrings) {\r\n\t\t\t\tlet node;\r\n\t\t\t\tif (typeof nodeOrDomString === 'string') {\r\n\t\t\t\t\tnode = new RxText(this, nodeOrDomString);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tnode = nodeOrDomString;\r\n\t\t\t\t}\r\n\t\t\t\tthis.childNodes.push(node);\r\n\t\t}\r\n\t\t*/\r\n\t}\r\n\tappendChild<T extends RxNode>(newChild: T): T {\r\n\t\tif (newChild.parentNode) {\r\n\t\t\tnewChild.parentNode.removeChild(newChild);\r\n\t\t}\r\n\t\tif (isRxDocumentFragment(newChild)) {\r\n\t\t\tthis.append.apply(this, newChild.childNodes);\r\n\t\t} else {\r\n\t\t\tthis.append(newChild);\r\n\t\t}\r\n\t\treturn newChild;\r\n\t}\r\n\tprepend(...nodesOrDOMStrings: (RxNode | string)[]) {\r\n\t\tnodesOrDOMStrings = nodesOrDOMStrings.map(nodeOrDomString => {\r\n\t\t\tlet node;\r\n\t\t\tif (typeof nodeOrDomString === 'string') {\r\n\t\t\t\tnode = new RxText(this, nodeOrDomString);\r\n\t\t\t} else {\r\n\t\t\t\tnode = nodeOrDomString;\r\n\t\t\t\tnode.parentNode = this;\r\n\t\t\t}\r\n\t\t\treturn node;\r\n\t\t});\r\n\t\tArray.prototype.unshift.apply(this.childNodes, nodesOrDOMStrings);\r\n\t\t/*\r\n\t\t\tfor (let nodeOrDomString of nodesOrDOMStrings) {\r\n\t\t\t\tlet node;\r\n\t\t\t\tif (typeof nodeOrDomString === 'string') {\r\n\t\t\t\t\tnode = new RxText(this, nodeOrDomString);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tnode = nodeOrDomString;\r\n\t\t\t\t}\r\n\t\t\t\tthis.childNodes.unshift(node);\r\n\t\t}\r\n\t\t*/\r\n\t}\r\n\treplaceChildren(...nodesOrDOMStrings: (RxNode | string)[]) {\r\n\t\tconst nodes: RxNode[] = nodesOrDOMStrings.map((nodeOrDomString) => {\r\n\t\t\tlet node: RxNode;\r\n\t\t\tif (typeof nodeOrDomString === 'string') {\r\n\t\t\t\tnode = new RxText(this, nodeOrDomString);\r\n\t\t\t} else {\r\n\t\t\t\tnode = nodeOrDomString as RxNode;\r\n\t\t\t\tnode.parentNode = this;\r\n\t\t\t}\r\n\t\t\treturn node;\r\n\t\t});\r\n\t\tthis.childNodes = nodes;\r\n\t}\r\n\tquerySelectorAll(selector: string): RxNode[] | null {\r\n\t\tconst queries = getQueries(selector);\r\n\t\tconst nodes = querySelectorAll(queries, this.childNodes);\r\n\t\treturn (nodes && nodes.length) ? nodes : null;\r\n\t}\r\n\tquerySelector(selector: string): RxNode | null {\r\n\t\tconst queries = getQueries(selector);\r\n\t\tconst node = querySelector(queries, this.childNodes);\r\n\t\treturn node;\r\n\t}\r\n\thasAttribute(attribute: string): boolean {\r\n\t\treturn Object.keys(this.attributes).indexOf(attribute.toLowerCase()) !== -1;\r\n\t}\r\n\tgetAttribute(attribute: string): string | null {\r\n\t\treturn this.attributes[attribute.toLowerCase()] || null;\r\n\t}\r\n\tsetAttribute(attribute: string, value: any) {\r\n\t\tthis.attributes[attribute.toLowerCase()] = value.toString();\r\n\t\tif (attribute === 'style') {\r\n\t\t\tthis.style.init();\r\n\t\t} else if (attribute === 'class') {\r\n\t\t\tthis.classList.init();\r\n\t\t}\r\n\t}\r\n\tremoveAttribute(attribute: string) {\r\n\t\tdelete this.attributes[attribute];\r\n\t\tif (attribute === 'style') {\r\n\t\t\tthis.style.init();\r\n\t\t} else if (attribute === 'class') {\r\n\t\t\tthis.classList.init();\r\n\t\t}\r\n\t}\r\n\treplaceChild(newChild: RxNode, oldChild: RxNode): RxNode {\r\n\t\tconst index = this.childNodes.indexOf(oldChild);\r\n\t\tif (index !== -1) {\r\n\t\t\tthis.childNodes[index] = newChild;\r\n\t\t\tnewChild.parentNode = this;\r\n\t\t}\r\n\t\t// console.log('replaceChild', this, newChild, oldChild);\r\n\t\treturn oldChild;\r\n\t}\r\n\tremoveChild(child: RxNode): RxNode {\r\n\t\tif (!(child instanceof RxNode)) {\r\n\t\t\tthrow new Error(`Uncaught TypeError: Failed to execute 'removeChild' on 'Node': parameter 1 is not of type 'Node'.`);\r\n\t\t}\r\n\t\tconst index = this.childNodes.indexOf(child);\r\n\t\tif (index === -1) {\r\n\t\t\tthrow new Error(`Uncaught NotFoundError: Failed to execute 'removeChild' on 'Node': The node to be removed is not a child of this node.`);\r\n\t\t}\r\n\t\tthis.childNodes.splice(index, 1);\r\n\t\t// console.log('removeChild', this.childNodes.length);\r\n\t\treturn child;\r\n\t}\r\n\tinsertBefore(newNode: RxNode, referenceNode: RxNode | null = null): RxNode {\r\n\t\tconst index = referenceNode\r\n\t\t\t? this.childNodes.indexOf(referenceNode)\r\n\t\t\t: this.childNodes.length;\r\n\t\tif (index !== -1) {\r\n\t\t\tthis.childNodes.splice(index, 0, newNode);\r\n\t\t\tnewNode.parentNode = this;\r\n\t\t}\r\n\t\t// console.log('insertBefore', this, newNode, referenceNode);\r\n\t\treturn newNode;\r\n\t}\r\n\tcloneNode(deep: boolean = false): RxNode {\r\n\t\treturn cloneNode.apply(this, [this, deep]);\r\n\t}\r\n\taddListener(eventName: string, handler: (e: any) => {}) { }\r\n\tremoveListener(eventName: string, handler: (e: any) => {}) { }\r\n\tserialize(): string {\r\n\t\treturn `<${\r\n\t\t\tthis.nodeName\r\n\t\t\t}${this.serializeAttributes()}>${this.childNodes\r\n\t\t\t\t.map(x => x.serialize())\r\n\t\t\t\t.join('')}</${this.nodeName}>`;\r\n\t}\r\n\tserializeAttributes(): string {\r\n\t\tlet attributes = '';\r\n\t\tconst keys = Object.keys(this.attributes);\r\n\t\tif (keys.length) {\r\n\t\t\tattributes =\r\n\t\t\t\t' ' +\r\n\t\t\t\tkeys\r\n\t\t\t\t\t.map(k => {\r\n\t\t\t\t\t\treturn `${k}=\"${this.attributes[k]}\"`;\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.join(' ');\r\n\t\t}\r\n\t\treturn attributes;\r\n\t}\r\n}\r\nexport class RxText extends RxNode {\r\n\tnodeValue: string;\r\n\tget outerHTML(): string | null {\r\n\t\tlet html = null;\r\n\t\tif (this.parentNode) {\r\n\t\t\thtml = this.parentNode.serialize();\r\n\t\t}\r\n\t\treturn html;\r\n\t}\r\n\tget wholeText(): string | null {\r\n\t\treturn this.nodeValue;\r\n\t}\r\n\tset innerText(nodeValue) {\r\n\t\tthis.nodeValue = String(nodeValue);\r\n\t}\r\n\tget innerText(): string | null {\r\n\t\treturn this.nodeValue;\r\n\t}\r\n\tset textContent(nodeValue) {\r\n\t\tthis.nodeValue = String(nodeValue);\r\n\t}\r\n\tget textContent(): string | null {\r\n\t\treturn this.nodeValue;\r\n\t}\r\n\tconstructor(parentNode: RxElement | null = null, nodeValue: any) {\r\n\t\tsuper(parentNode);\r\n\t\tthis.nodeType = RxNodeType.TEXT_NODE;\r\n\t\tthis.nodeValue = String(nodeValue);\r\n\t\t// console.log('RxText', nodeValue);\r\n\t}\r\n\tserialize(): string {\r\n\t\treturn this.nodeValue;\r\n\t}\r\n}\r\nexport class RxCData extends RxNode {\r\n\tnodeValue: string;\r\n\tget outerHTML(): string | null {\r\n\t\tlet html = null;\r\n\t\tif (this.parentNode) {\r\n\t\t\thtml = this.parentNode.serialize();\r\n\t\t}\r\n\t\treturn html;\r\n\t}\r\n\tget wholeText(): string | null {\r\n\t\treturn this.nodeValue;\r\n\t}\r\n\tset innerText(nodeValue) {\r\n\t\tthis.nodeValue = String(nodeValue);\r\n\t}\r\n\tget innerText(): string | null {\r\n\t\treturn this.nodeValue;\r\n\t}\r\n\tset textContent(nodeValue) {\r\n\t\tthis.nodeValue = String(nodeValue);\r\n\t}\r\n\tget textContent(): string | null {\r\n\t\treturn this.nodeValue;\r\n\t}\r\n\tconstructor(parentNode: RxElement | null = null, nodeValue: any) {\r\n\t\tsuper(parentNode);\r\n\t\tthis.nodeType = RxNodeType.CDATA_SECTION_NODE;\r\n\t\tthis.nodeValue = String(nodeValue);\r\n\t}\r\n\tserialize(): string {\r\n\t\treturn this.nodeValue;\r\n\t}\r\n}\r\nexport class RxComment extends RxNode {\r\n\tnodeValue: string;\r\n\tget outerHTML(): string | null {\r\n\t\tlet html = null;\r\n\t\tif (this.parentNode) {\r\n\t\t\thtml = this.parentNode.serialize();\r\n\t\t}\r\n\t\treturn html;\r\n\t}\r\n\tget wholeText(): string | null {\r\n\t\treturn this.nodeValue;\r\n\t}\r\n\tset innerText(nodeValue) {\r\n\t\tthis.nodeValue = String(nodeValue);\r\n\t}\r\n\tget innerText(): string | null {\r\n\t\treturn this.nodeValue;\r\n\t}\r\n\tset textContent(nodeValue) {\r\n\t\tthis.nodeValue = String(nodeValue);\r\n\t}\r\n\tget textContent(): string | null {\r\n\t\treturn this.nodeValue;\r\n\t}\r\n\tconstructor(parentNode: RxElement | null = null, nodeValue: any) {\r\n\t\tsuper(parentNode);\r\n\t\tthis.nodeType = RxNodeType.COMMENT_NODE;\r\n\t\tthis.nodeValue = String(nodeValue);\r\n\t}\r\n\tserialize(): string {\r\n\t\treturn `<!--${this.nodeValue}-->`;\r\n\t}\r\n}\r\nexport class RxProcessingInstruction extends RxNode {\r\n\tconstructor(parentNode: RxElement | null = null, nodeValue: any) {\r\n\t\tsuper(parentNode);\r\n\t\tthis.nodeType = RxNodeType.PROCESSING_INSTRUCTION_NODE;\r\n\t\tthis.nodeValue = String(nodeValue);\r\n\t}\r\n\tserialize(): string {\r\n\t\treturn `<${this.nodeValue}>`;\r\n\t}\r\n}\r\nexport class RxDocumentType extends RxNode {\r\n\tconstructor(parentNode: RxElement | null = null, nodeValue: any) {\r\n\t\tsuper(parentNode);\r\n\t\tthis.nodeType = RxNodeType.DOCUMENT_TYPE_NODE;\r\n\t\tthis.nodeValue = String(nodeValue);\r\n\t}\r\n\tserialize(): string {\r\n\t\treturn `<${this.nodeValue}>`;\r\n\t}\r\n}\r\nexport class RxDocumentFragment extends RxElement {\r\n\tconstructor() {\r\n\t\tsuper(null, '#document-fragment');\r\n\t\tthis.nodeType = RxNodeType.DOCUMENT_FRAGMENT_NODE;\r\n\t\tthis.childNodes = [];\r\n\t}\r\n}\r\n// !!! TODO\r\n// Any web page loaded in the browser and serves as an entry point into the web page's content, which is the DOM tree.//\r\n// interface Document extends Node, DocumentAndElementEventHandlers, DocumentOrShadowRoot, GlobalEventHandlers, NonElementParentNode, ParentNode, XPathEvaluatorBase {\r\nexport interface IDocument extends Document {\r\n\t/*\r\n\treadonly URL: string; // Sets or gets the URL for the current document.\r\n\treadonly characterSet: string; // Returns document's encoding.\r\n\treadonly charset: string; // Gets or sets the character set used to encode the object.\r\n\treadonly compatMode: string; // Gets a value that indicates whether standards-compliant mode is switched on for the object.\r\n\treadonly contentType: string; // Returns document's content type.\r\n\treadonly currentScript: HTMLOrSVGScriptElement | null; // Returns the script element, or the SVG script element, that is currently executing, as long as the element represents a classic script. In the case of reentrant script execution, returns the one that most recently started executing amongst those that have not yet finished executing.\r\n\treadonly defaultView: (WindowProxy & typeof globalThis) | null; // Returns null if the Document is not currently executing a script or SVG script element (e.g., because the running script is an event handler, or a timeout), or if the currently executing script or SVG script element represents a module script.\r\n\treadonly doctype: DocumentType | null; // Gets an object representing the document type declaration associated with the current document.\r\n\treadonly documentElement: HTMLElement; // Gets a reference to the root node of the document.\r\n\treadonly documentURI: string; // Returns document's URL.\r\n\treadonly embeds: HTMLCollectionOf<HTMLEmbedElement>; // Retrieves a collection of all embed objects in the document.\r\n\treadonly forms: HTMLCollectionOf<HTMLFormElement>; // Retrieves a collection, in source order, of all form objects in the document.\r\n\treadonly fullscreenEnabled: boolean; // Returns true if document has the ability to display elements fullscreen and fullscreen is supported, or false otherwise.\r\n\treadonly head: HTMLHeadElement; // Returns the head element.\r\n\treadonly hidden: boolean;\r\n\treadonly images: HTMLCollectionOf<HTMLImageElement>; // Retrieves a collection, in source order, of img objects in the document.\r\n\treadonly implementation: DOMImplementation; // Gets the implementation object of the current document.\r\n\treadonly inputEncoding: string; // Returns the character encoding used to create the webpage that is loaded into the document object.\r\n\treadonly lastModified: string; // Gets the date that the page was last modified, if the page supplies one.\r\n\treadonly links: HTMLCollectionOf<HTMLAnchorElement | HTMLAreaElement>; // Retrieves a collection of all a objects that specify the href property and all area objects in the document.\r\n\treadonly origin: string; // Returns document's origin.\r\n\treadonly ownerDocument: null;\r\n\treadonly plugins: HTMLCollectionOf<HTMLEmbedElement>; // Return an HTMLCollection of the embed elements in the Document.\r\n\treadonly readyState: DocumentReadyState; // Retrieves a value that indicates the current state of the object.\r\n\treadonly referrer: string; // Gets the URL of the location that referred the user to the current page.\r\n\treadonly scripts: HTMLCollectionOf<HTMLScriptElement>; // Retrieves a collection of all script objects in the document.\r\n\treadonly scrollingElement: Element | null;\r\n\treadonly timeline: DocumentTimeline;\r\n\treadonly visibilityState: VisibilityState;\r\n\tbody: HTMLElement; // Specifies the beginning and end of the document body.\r\n\tcookie: string; // Returns the HTTP cookies that apply to the Document. If there are no cookies or cookies can't be applied to this resource, the empty string will be returned.\r\n\t// Can be set, to add a new cookie to the element's set of HTTP cookies.\r\n\t// If the contents are sandboxed into a unique origin (e.g. in an iframe with the sandbox attribute), a \"SecurityError\" DOMException will be thrown on getting and setting.\r\n\tdesignMode: string; // Sets or gets a value that indicates whether the document can be edited.\r\n\tdir: string; // Sets or retrieves a value that indicates the reading order of the object.\r\n\tdomain: string; // Sets or gets the security domain of the document.\r\n\tlocation: Location; // Contains information about the current URL.\r\n\ttitle: string; // Contains the title of the document.\r\n\t// METHODS\r\n\tonfullscreenchange: ((this: Document, ev: Event) => any) | null;\r\n\tonfullscreenerror: ((this: Document, ev: Event) => any) | null;\r\n\tonpointerlockchange: ((this: Document, ev: Event) => any) | null;\r\n\tonpointerlockerror: ((this: Document, ev: Event) => any) | null;\r\n\tonreadystatechange: ((this: Document, ev: Event) => any) | null; // Fires when the state of the object has changed.\r\n\t// @param ev The event\r\n\tonvisibilitychange: ((this: Document, ev: Event) => any) | null;\r\n\tadoptNode<T extends Node>(source: T): T; // Moves node from another document and returns it.\r\n\t// If node is a document, throws a \"NotSupportedError\" DOMException or, if node is a shadow root, throws a \"HierarchyRequestError\" DOMException.\r\n\tcaretPositionFromPoint(x: number, y: number): CaretPosition | null;\r\n\tclose(): void; // Closes an output stream and forces the sent data to display.\r\n\tcreateAttribute(localName: string): Attr; // Creates an attribute object with a specified name.\r\n\t// @param name String that sets the attribute object's name.\r\n\tcreateAttributeNS(namespace: string | null, qualifiedName: string): Attr;\r\n\tcreateCDATASection(data: string): CDATASection; // Returns a CDATASection node whose data is data.\r\n\tcreateComment(data: string): Comment; // Creates a comment object with the specified data.\r\n\t// @param data Sets the comment object's data.\r\n\tcreateDocumentFragment(): DocumentFragment; // Creates a new document.\r\n\tcreateElement<K extends keyof HTMLElementTagNameMap>(tagName: K, options?: ElementCreationOptions): HTMLElementTagNameMap[K]; // Creates an instance of the element for the specified tag.\r\n\t// @param tagName The name of an element.\r\n\tcreateElement(tagName: string, options?: ElementCreationOptions): HTMLElement;\r\n\tcreateElementNS(namespaceURI: 'http://www.w3.org/1999/xhtml', qualifiedName: string): HTMLElement;\r\n\tcreateElementNS<K extends keyof SVGElementTagNameMap>(namespaceURI: 'http://www.w3.org/2000/svg', qualifiedName: K): SVGElementTagNameMap[K];\r\n\tcreateElementNS(namespaceURI: 'http://www.w3.org/2000/svg', qualifiedName: string): SVGElement;\r\n\tcreateElementNS(namespaceURI: string | null, qualifiedName: string, options?: ElementCreationOptions): Element;\r\n\tcreateElementNS(namespace: string | null, qualifiedName: string, options?: string | ElementCreationOptions): Element; // Returns an element with namespace namespace. Its namespace prefix will be everything before \":\" (U+003E) in qualifiedName or null. Its local name will be everything after \":\" (U+003E) in qualifiedName or qualifiedName.\r\n\t// If localName does not match the Name production an 'InvalidCharacterError' DOMException will be thrown.\r\n\t// If one of the following conditions is true a 'NamespaceError' DOMException will be thrown:\r\n\t// localName does not match the QName production.\r\n\t// Namespace prefix is not null and namespace is the empty string.\r\n\t// Namespace prefix is 'xml' and namespace is not the XML namespace.\r\n\t// qualifiedName or namespace prefix is 'xmlns' and namespace is not the XMLNS namespace.\r\n\t// namespace is the XMLNS namespace and neither qualifiedName nor namespace prefix is 'xmlns'.\r\n\t// When supplied, options's is can be used to create a customized built-in element.\r\n\tcreateEvent(eventInterface: 'AnimationEvent'): AnimationEvent;\r\n\tcreateEvent(eventInterface: 'AnimationPlaybackEvent'): AnimationPlaybackEvent;\r\n\tcreateEvent(eventInterface: 'AudioProcessingEvent'): AudioProcessingEvent;\r\n\tcreateEvent(eventInterface: 'BeforeUnloadEvent'): BeforeUnloadEvent;\r\n\tcreateEvent(eventInterface: 'ClipboardEvent'): ClipboardEvent;\r\n\tcreateEvent(eventInterface: 'CloseEvent'): CloseEvent;\r\n\tcreateEvent(eventInterface: 'CompositionEvent'): CompositionEvent;\r\n\tcreateEvent(eventInterface: 'CustomEvent'): CustomEvent;\r\n\tcreateEvent(eventInterface: 'DeviceLightEvent'): DeviceLightEvent;\r\n\tcreateEvent(eventInterface: 'DeviceMotionEvent'): DeviceMotionEvent;\r\n\tcreateEvent(eventInterface: 'DeviceOrientationEvent'): DeviceOrientationEvent;\r\n\tcreateEvent(eventInterface: 'DragEvent'): DragEvent;\r\n\tcreateEvent(eventInterface: 'ErrorEvent'): ErrorEvent;\r\n\tcreateEvent(eventInterface: 'Event'): Event;\r\n\tcreateEvent(eventInterface: 'Events'): Event;\r\n\tcreateEvent(eventInterface: 'FocusEvent'): FocusEvent;\r\n\tcreateEvent(eventInterface: 'FocusNavigationEvent'): FocusNavigationEvent;\r\n\tcreateEvent(eventInterface: 'GamepadEvent'): GamepadEvent;\r\n\tcreateEvent(eventInterface: 'HashChangeEvent'): HashChangeEvent;\r\n\tcreateEvent(eventInterface: 'IDBVersionChangeEvent'): IDBVersionChangeEvent;\r\n\tcreateEvent(eventInterface: 'InputEvent'): InputEvent;\r\n\tcreateEvent(eventInterface: 'KeyboardEvent'): KeyboardEvent;\r\n\tcreateEvent(eventInterface: 'ListeningStateChangedEvent'): ListeningStateChangedEvent;\r\n\tcreateEvent(eventInterface: 'MSGestureEvent'): MSGestureEvent;\r\n\tcreateEvent(eventInterface: 'MSMediaKeyMessageEvent'): MSMediaKeyMessageEvent;\r\n\tcreateEvent(eventInterface: 'MSMediaKeyNeededEvent'): MSMediaKeyNeededEvent;\r\n\tcreateEvent(eventInterface: 'MSPointerEvent'): MSPointerEvent;\r\n\tcreateEvent(eventInterface: 'MediaEncryptedEvent'): MediaEncryptedEvent;\r\n\tcreateEvent(eventInterface: 'MediaKeyMessageEvent'): MediaKeyMessageEvent;\r\n\tcreateEvent(eventInterface: 'MediaQueryListEvent'): MediaQueryListEvent;\r\n\tcreateEvent(eventInterface: 'MediaStreamErrorEvent'): MediaStreamErrorEvent;\r\n\tcreateEvent(eventInterface: 'MediaStreamEvent'): MediaStreamEvent;\r\n\tcreateEvent(eventInterface: 'MediaStreamTrackEvent'): MediaStreamTrackEvent;\r\n\tcreateEvent(eventInterface: 'MessageEvent'): MessageEvent;\r\n\tcreateEvent(eventInterface: 'MouseEvent'): MouseEvent;\r\n\tcreateEvent(eventInterface: 'MouseEvents'): MouseEvent;\r\n\tcreateEvent(eventInterface: 'MutationEvent'): MutationEvent;\r\n\tcreateEvent(eventInterface: 'MutationEvents'): MutationEvent;\r\n\tcreateEvent(eventInterface: 'OfflineAudioCompletionEvent'): OfflineAudioCompletionEvent;\r\n\tcreateEvent(eventInterface: 'OverflowEvent'): OverflowEvent;\r\n\tcreateEvent(eventInterface: 'PageTransitionEvent'): PageTransitionEvent;\r\n\tcreateEvent(eventInterface: 'PaymentRequestUpdateEvent'): PaymentRequestUpdateEvent;\r\n\tcreateEvent(eventInterface: 'PermissionRequestedEvent'): PermissionRequestedEvent;\r\n\tcreateEvent(eventInterface: 'PointerEvent'): PointerEvent;\r\n\tcreateEvent(eventInterface: 'PopStateEvent'): PopStateEvent;\r\n\tcreateEvent(eventInterface: 'ProgressEvent'): ProgressEvent;\r\n\tcreateEvent(eventInterface: 'PromiseRejectionEvent'): PromiseRejectionEvent;\r\n\tcreateEvent(eventInterface: 'RTCDTMFToneChangeEvent'): RTCDTMFToneChangeEvent;\r\n\tcreateEvent(eventInterface: 'RTCDataChannelEvent'): RTCDataChannelEvent;\r\n\tcreateEvent(eventInterface: 'RTCDtlsTransportStateChangedEvent'): RTCDtlsTransportStateChangedEvent;\r\n\tcreateEvent(eventInterface: 'RTCErrorEvent'): RTCErrorEvent;\r\n\tcreateEvent(eventInterface: 'RTCIceCandidatePairChangedEvent'): RTCIceCandidatePairChangedEvent;\r\n\tcreateEvent(eventInterface: 'RTCIceGathererEvent'): RTCIceGathererEvent;\r\n\tcreateEvent(eventInterface: 'RTCIceTransportStateChangedEvent'): RTCIceTransportStateChangedEvent;\r\n\tcreateEvent(eventInterface: 'RTCPeerConnectionIceErrorEvent'): RTCPeerConnectionIceErrorEvent;\r\n\tcreateEvent(eventInterface: 'RTCPeerConnectionIceEvent'): RTCPeerConnectionIceEvent;\r\n\tcreateEvent(eventInterface: 'RTCSsrcConflictEvent'): RTCSsrcConflictEvent;\r\n\tcreateEvent(eventInterface: 'RTCStatsEvent'): RTCStatsEvent;\r\n\tcreateEvent(eventInterface: 'RTCTrackEvent'): RTCTrackEvent;\r\n\tcreateEvent(eventInterface: 'SVGZoomEvent'): SVGZoomEvent;\r\n\tcreateEvent(eventInterface: 'SVGZoomEvents'): SVGZoomEvent;\r\n\tcreateEvent(eventInterface: 'SecurityPolicyViolationEvent'): SecurityPolicyViolationEvent;\r\n\tcreateEvent(eventInterface: 'ServiceWorkerMessageEvent'): ServiceWorkerMessageEvent;\r\n\tcreateEvent(eventInterface: 'SpeechRecognitionEvent'): SpeechRecognitionEvent;\r\n\tcreateEvent(eventInterface: 'SpeechSynthesisErrorEvent'): SpeechSynthesisErrorEvent;\r\n\tcreateEvent(eventInterface: 'SpeechSynthesisEvent'): SpeechSynthesisEvent;\r\n\tcreateEvent(eventInterface: 'StorageEvent'): StorageEvent;\r\n\tcreateEvent(eventInterface: 'TextEvent'): TextEvent;\r\n\tcreateEvent(eventInterface: 'TouchEvent'): TouchEvent;\r\n\tcreateEvent(eventInterface: 'TrackEvent'): TrackEvent;\r\n\tcreateEvent(eventInterface: 'TransitionEvent'): TransitionEvent;\r\n\tcreateEvent(eventInterface: 'UIEvent'): UIEvent;\r\n\tcreateEvent(eventInterface: 'UIEvents'): UIEvent;\r\n\tcreateEvent(eventInterface: 'VRDisplayEvent'): VRDisplayEvent;\r\n\tcreateEvent(eventInterface: 'VRDisplayEvent '): VRDisplayEvent;\r\n\tcreateEvent(eventInterface: 'WebGLContextEvent'): WebGLContextEvent;\r\n\tcreateEvent(eventInterface: 'WheelEvent'): WheelEvent;\r\n\tcreateEvent(eventInterface: string): Event;\r\n\tcreateNodeIterator(root: Node, whatToShow?: number, filter?: NodeFilter | null): NodeIterator; // Creates a NodeIterator object that you can use to traverse filtered lists of nodes or elements in a document.\r\n\t// @param root The root element or node to start traversing on.\r\n\t// @param whatToShow The type of nodes or elements to appear in the node list\r\n\t// @param filter A custom NodeFilter function to use. For more information, see filter. Use null for no filter.\r\n\t// @param entityReferenceExpansion A flag that specifies whether entity reference nodes are expanded.\r\n\tcreateProcessingInstruction(target: string, data: string): ProcessingInstruction; // Returns a ProcessingInstruction node whose target is target and data is data. If target does not match the Name production an 'InvalidCharacterError' DOMException will be thrown. If data contains \"?>\" an \"InvalidCharacterError\" DOMException will be thrown.\r\n\tcreateRange(): Range; // Returns an empty range object that has both of its boundary points positioned at the beginning of the document.\r\n\tcreateTextNode(data: string): Text; // Creates a text string from the specified value.\r\n\t// @param data String that specifies the nodeValue property of the text node.\r\n\tcreateTreeWalker(root: Node, whatToShow?: number, filter?: NodeFilter | null): TreeWalker; // Creates a TreeWalker object that you can use to traverse filtered lists of nodes or elements in a document.\r\n\t// @param root The root element or node to start traversing on.\r\n\t// @param whatToShow The type of nodes or elements to appear in the node list. For more information, see whatToShow.\r\n\t// @param filter A custom NodeFilter function to use.\r\n\t// @param entityReferenceExpansion A flag that specifies whether entity reference nodes are expanded.\r\n\telementFromPoint(x: number, y: number): Element | null; // Returns the element for the specified x coordinate and the specified y coordinate.\r\n\t// @param x The x-offset\r\n\t// @param y The y-offset\r\n\telementsFromPoint(x: number, y: number): Element[];\r\n\texecCommand(commandId: string, showUI?: boolean, value?: string): boolean; // Executes a command on the current document, current selection, or the given range.\r\n\t// @param commandId String that specifies the command to execute. This command can be any of the command identifiers that can be executed in script.\r\n\t// @param showUI Display the user interface, defaults to false.\r\n\t// @param value Value to assign.\r\n\texitFullscreen(): Promise<void>; // Stops document's fullscreen element from being displayed fullscreen and resolves promise when done.\r\n\texitPointerLock(): void;\r\n\tgetAnimations(): Animation[];\r\n\tgetElementById(elementId: string): HTMLElement | null; // Returns a reference to the first object with the specified value of the ID or NAME attribute.\r\n\t// @param elementId String that specifies the ID value. Case-insensitive.\r\n\tgetElementsByClassName(classNames: string): HTMLCollectionOf<Element>; // Returns a HTMLCollection of the elements in the object on which the method was invoked (a document or an element) that have all the classes given by classNames. The classNames argument is interpreted as a space-separated list of classes.\r\n\tgetElementsByName(elementName: string): NodeListOf<HTMLElement>; // Gets a collection of objects based on the value of the NAME or ID attribute.\r\n\t// @param elementName Gets a collection of objects based on the value of the NAME or ID attribute.\r\n\tgetElementsByTagName<K extends keyof HTMLElementTagNameMap>(qualifiedName: K): HTMLCollectionOf<HTMLElementTagNameMap[K]>;\r\n\tgetElementsByTagName<K extends keyof SVGElementTagNameMap>(qualifiedName: K): HTMLCollectionOf<SVGElementTagNameMap[K]>;\r\n\tgetElementsByTagName(qualifiedName: string): HTMLCollectionOf<Element>; // Retrieves a collection of objects based on the specified element name.\r\n\t// @param name Specifies the name of an element.\r\n\tgetElementsByTagNameNS(namespaceURI: 'http://www.w3.org/1999/xhtml', localName: string): HTMLCollectionOf<HTMLElement>;\r\n\tgetElementsByTagNameNS(namespaceURI: 'http://www.w3.org/2000/svg', localName: string): HTMLCollectionOf<SVGElement>;\r\n\tgetElementsByTagNameNS(namespaceURI: string, localName: string): HTMLCollectionOf<Element>; // If namespace and localName are '*' returns a HTMLCollection of all descendant elements.\r\n\t// If only namespace is '*' returns a HTMLCollection of all descendant elements whose local name is localName.\r\n\t// If only localName is '*' returns a HTMLCollection of all descendant elements whose namespace is namespace.\r\n\t// Otherwise, returns a HTMLCollection of all descendant elements whose namespace is namespace and local name is localName.\r\n\tgetSelection(): Selection | null; // Returns an object representing the current selection of the document that is loaded into the object displaying a webpage.\r\n\thasFocus(): boolean; // Gets a value indicating whether the object currently has focus.\r\n\timportNode<T extends Node>(importedNode: T, deep: boolean): T; // Returns a copy of node. If deep is true, the copy also includes the node's descendants.\r\n\t// If node is a document or a shadow root, throws a 'NotSupportedError' DOMException.\r\n\topen(url?: string, name?: string, features?: string, replace?: boolean): Document; // Opens a new window and loads a document specified by a given URL. Also, opens a new window that uses the url parameter and the name parameter to collect the output of the write method and the writeln method.\r\n\t// @param url Specifies a MIME type for the document.\r\n\t// @param name Specifies the name of the window. This name is used as the value for the TARGET attribute on a form or an anchor element.\r\n\t// @param features Contains a list of items separated by commas. Each item consists of an option and a value, separated by an equals sign (for example, \"fullscreen=yes, toolbar=yes\"). The following values are supported.\r\n\t// @param replace Specifies whether the existing entry for the document is replaced in the history list.\r\n\tqueryCommandEnabled(commandId: string): boolean; // Returns a Boolean value that indicates whether a specified command can be successfully executed using execCommand, given the current state of the document.\r\n\t// @param commandId Specifies a command identifier.\r\n\tqueryCommandIndeterm(commandId: string): boolean; // Returns a Boolean value that indicates whether the specified command is in the indeterminate state.\r\n\t// @param commandId String that specifies a command identifier.\r\n\tqueryCommandState(commandId: string): boolean; // Returns a Boolean value that indicates the current state of the command.\r\n\t// @param commandId String that specifies a command identifier.\r\n\tqueryCommandSupported(commandId: string): boolean; // Returns a Boolean value that indicates whether the current command is supported on the current range.\r\n\t// @param commandId Specifies a command identifier.\r\n\tqueryCommandValue(commandId: string): string; // Returns the current value of the document, range, or current selection for the given command.\r\n\t// @param commandId String that specifies a command identifier.\r\n\twrite(...text: string[]): void; // Writes one or more HTML expressions to a document in the specified window.\r\n\t// @param content Specifies the text and HTML tags to write.\r\n\twriteln(...text: string[]): void; // Writes one or more HTML expressions, followed by a carriage return, to a document in the specified window.\r\n\t// @param content The text and HTML tags to write.\r\n\taddEventListener<K extends keyof DocumentEventMap>(type: K, listener: (this: Document, ev: DocumentEventMap[K]) => any, options?: boolean | AddEventListenerOptions): void;\r\n\taddEventListener(type: string, listener: EventListenerOrEventListenerObject, options?: boolean | AddEventListenerOptions): void;\r\n\tremoveEventListener<K extends keyof DocumentEventMap>(type: K, listener: (this: Document, ev: DocumentEventMap[K]) => any, options?: boolean | EventListenerOptions): void;\r\n\tremoveEventListener(type: string, listener: EventListenerOrEventListenerObject, options?: boolean | EventListenerOptions): void;\r\n\t// DEPRECATED !!!\r\n\t// @deprecated\r\n\t// createElement<K extends keyof HTMLElementDeprecatedTagNameMap>(tagName: K, options?: ElementCreationOptions): HTMLElementDeprecatedTagNameMap[K];\r\n\t// @deprecated\r\n\t// createTreeWalker(root: Node, whatToShow: number, filter: NodeFilter | null, entityReferenceExpansion?: boolean): TreeWalker;\r\n\t// Sets or gets the color of all active links in the document.\r\n\t// @deprecated\r\n\t// alinkColor: string; // Returns a reference to the collection of elements contained by the object.\r\n\t// @deprecated\r\n\t// readonly all: HTMLAllCollection; // Retrieves a collection of all a objects that have a name and/or id property. Objects in this collection are in HTML source order.\r\n\t// @deprecated\r\n\t// readonly anchors: HTMLCollectionOf<HTMLAnchorElement>; // Retrieves a collection of all applet objects in the document.\r\n\t// @deprecated\r\n\t// readonly applets: HTMLCollectionOf<HTMLAppletElement>; // Deprecated. Sets or retrieves a value that indicates the background color behind the object.\r\n\t// @deprecated\r\n\t// bgColor: string; // Sets or gets the foreground (text) color of the document.\r\n\t// @deprecated\r\n\t// fgColor: string; // @deprecated\r\n\t// readonly fullscreen: boolean; // Sets or gets the color of the document links.\r\n\t// @deprecated\r\n\t// linkColor: string; // Sets or gets the color of the links that the user has visited.\r\n\t// @deprecated\r\n\t// vlinkColor: string; // @deprecated\r\n\t// captureEvents(): void; // @deprecated\r\n\t// caretRangeFromPoint(x: number, y: number): Range; // @deprecated\r\n\t// clear(): void; // @deprecated\r\n\t// releaseEvents(): void;\r\n\t*/\r\n}\r\nexport class RxDocument extends RxElement {\r\n\tprivate location_: ILocation = RxLocation.location;\r\n\tget location() {\r\n\t\treturn this.location_;\r\n\t}\r\n\tget URL(): string {\r\n\t\treturn this.location_.href;\r\n\t}\r\n\tget hidden(): true {\r\n\t\treturn true;\r\n\t}\r\n\tget visibilityState(): 'prerender' {\r\n\t\treturn 'prerender';\r\n\t}\r\n\tget doctype(): RxDocumentType | null {\r\n\t\treturn this.childNodes.find(x => isRxDocumentType(x)) as RxDocumentType;\r\n\t}\r\n\tget head(): RxElement {\r\n\t\t// console.log('childNodes', this.childNodes);\r\n\t\tlet head: RxElement | null = this.documentElement.childNodes.find(x => isRxElement(x) && x.nodeName === 'head') as RxElement;\r\n\t\tif (!head) {\r\n\t\t\thead = new RxElement(this.documentElement, 'head');\r\n\t\t\tthis.documentElement.append(head);\r\n\t\t}\r\n\t\treturn head;\r\n\t}\r\n\tget body(): RxElement | null {\r\n\t\tlet body: RxElement | null = this.childNodes.find(x => isRxElement(x) && x.nodeName === 'body') as RxElement;\r\n\t\tif (!body) {\r\n\t\t\tbody = new RxElement(this.documentElement, 'body');\r\n\t\t\tthis.documentElement.append(body);\r\n\t\t}\r\n\t\treturn body;\r\n\t}\r\n\tget title(): string | null {\r\n\t\tconst title = this.head.childNodes.find(x => isRxElement(x) && x.nodeName === 'title') as RxElement;\r\n\t\tif (title) {\r\n\t\t\treturn title.innerText;\r\n\t\t} else {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t}\r\n\tset title(nodeValue: string | null) {\r\n\t\tlet title: RxElement | null = this.head.childNodes.find(x => isRxElement(x) && x.nodeName === 'title') as RxElement | null;\r\n\t\tif (!title) {\r\n\t\t\ttitle = new RxElement(this.head, 'title');\r\n\t\t}\r\n\t\ttitle.innerText = String(nodeValue);\r\n\t}\r\n\tget documentElement(): RxElement {\r\n\t\tlet element: RxElement | null = this.firstElementChild;\r\n\t\tif (!element) {\r\n\t\t\telement = new RxElement(this, 'html');\r\n\t\t}\r\n\t\treturn element;\r\n\t}\r\n\t/*\r\n\t\treadonly characterSet: string; // Returns document's encoding.\r\n\t\treadonly charset: string; // Gets or sets the character set used to encode the object.\r\n\t\treadonly compatMode: string; // Gets a value that indicates whether standards-compliant mode is switched on for the object.\r\n\t\treadonly contentType: string; // Returns document's content type.\r\n\t\treadonly currentScript: HTMLOrSVGScriptElement | null; // Returns the script element, or the SVG script element, that is currently executing, as long as the element represents a classic script. In the case of reentrant script execution, returns the one that most recently started executing amongst those that have not yet finished executing.\r\n\t\treadonly defaultView: (WindowProxy & typeof globalThis) | null; // Returns null if the Document is not currently executing a script or SVG script element (e.g., because the running script is an event handler, or a timeout), or if the currently executing script or SVG script element represents a module script.\r\n\t\treadonly documentElement: HTMLElement; // Gets a reference to the root node of the document.\r\n\t\treadonly documentURI: string; // Returns document's URL.\r\n\t\treadonly embeds: HTMLCollectionOf<HTMLEmbedElement>; // Retrieves a collection of all embed objects in the document.\r\n\t\treadonly forms: HTMLCollectionOf<HTMLFormElement>; // Retrieves a collection, in source order, of all form objects in the document.\r\n\t\treadonly fullscreenEnabled: boolean; // Returns true if document has the ability to display elements fullscreen and fullscreen is supported, or false otherwise.\r\n\t\treadonly head: HTMLHeadElement; // Returns the head element.\r\n\t\treadonly hidden: boolean;\r\n\t\treadonly images: HTMLCollectionOf<HTMLImageElement>; // Retrieves a collection, in source order, of img objects in the document.\r\n\t\treadonly implementation: DOMImplementation; // Gets the implementation object of the current document.\r\n\t\treadonly inputEncoding: string; // Returns the character encoding used to create the webpage that is loaded into the document object.\r\n\t\treadonly lastModified: string; // Gets the date that the page was last modified, if the page supplies one.\r\n\t\treadonly links: HTMLCollectionOf<HTMLAnchorElement | HTMLAreaElement>; // Retrieves a collection of all a objects that specify the href property and all area objects in the document.\r\n\t\treadonly origin: string; // Returns document's origin.\r\n\t\treadonly ownerDocument: null;\r\n\t\treadonly plugins: HTMLCollectionOf<HTMLEmbedElement>; // Return an HTMLCollection of the embed elements in the Document.\r\n\t\treadonly readyState: DocumentReadyState; // Retrieves a value that indicates the current state of the object.\r\n\t\treadonly referrer: string; // Gets the URL of the location that referred the user to the current page.\r\n\t\treadonly scripts: HTMLCollectionOf<HTMLScriptElement>; // Retrieves a collection of all script objects in the document.\r\n\t\treadonly scrollingElement: Element | null;\r\n\t\treadonly timeline: DocumentTimeline;\r\n\t\treadonly visibilityState: VisibilityState;\r\n\t\t*/\r\n\tconstructor() {\r\n\t\tsuper(null, '#document');\r\n\t\tthis.nodeType = RxNodeType.DOCUMENT_NODE;\r\n\t\tthis.childNodes = [];\r\n\t}\r\n\tcreateAttribute() { }\r\n\t// Creates a new Attr object and returns it.\r\n\tcreateAttributeNS() { }\r\n\t// Creates a new attribute node in a given namespace and returns it.\r\n\tcreateCDATASection() { }\r\n\t// Creates a new CDATA node and returns it.\r\n\tcreateComment(nodeValue: string) {\r\n\t\treturn new RxComment(null, nodeValue);\r\n\t}\r\n\t// Creates a new comment node and returns it.\r\n\tcreateDocumentFragment() {\r\n\t\treturn new RxDocumentFragment();\r\n\t}\r\n\t// Creates a new document fragment.\r\n\tcreateElement(nodeName: string): RxElement {\r\n\t\treturn new RxElement(null, nodeName);\r\n\t}\r\n\t// Creates a new element with the given tag name.\r\n\tcreateElementNS(nodeName: string): RxElement {\r\n\t\treturn new RxElement(null, nodeName);\r\n\t}\r\n\t// Creates a new element with the given tag name and namespace URI.\r\n\tcreateEvent() { }\r\n\t// Creates an event object.\r\n\tcreateNodeIterator() { }\r\n\t// Creates a NodeIterator object.\r\n\tcreateProcessingInstruction(nodeValue: string) {\r\n\t\treturn new RxProcessingInstruction(null, nodeValue);\r\n\t}\r\n\t// Creates a new ProcessingInstruction object.\r\n\tcreateRange() { }\r\n\t// Creates a Range object.\r\n\tcreateTextNode(nodeValue: string) {\r\n\t\treturn new RxText(null, nodeValue);\r\n\t}\r\n\t// Creates a text node.\r\n\tcreateTouchList() { }\r\n\t// Creates a TouchList object.\r\n\tcreateTreeWalker() { }\r\n\t// Creates a TreeWalker object.\r\n\tserialize(): string {\r\n\t\treturn `${this.childNodes.map(x => x.serialize()).join('')}`;\r\n\t}\r\n}\r\n/** A window containing a DOM document; the document property points to the DOM document loaded in that window. */\r\nexport interface IWindow { // extends Window\r\n\treadonly applicationCache?: ApplicationCache;\r\n\treadonly clientInformation?: Navigator;\r\n\treadonly closed?: boolean;\r\n\treadonly devicePixelRatio?: number;\r\n\treadonly doNotTrack?: string;\r\n\treadonly document?: Document;\r\n\treadonly frameElement?: Element;\r\n\treadonly frames?: Window;\r\n\treadonly history?: History;\r\n\treadonly innerHeight?: number;\r\n\treadonly innerWidth?: number;\r\n\treadonly length?: number;\r\n\treadonly locationbar?: BarProp;\r\n\treadonly menubar?: BarProp;\r\n\treadonly msContentScript?: ExtensionScriptApis;\r\n\treadonly navigator?: Navigator;\r\n\treadonly outerHeight?: number;\r\n\treadonly outerWidth?: number;\r\n\treadonly pageXOffset?: number;\r\n\treadonly pageYOffset?: number;\r\n\treadonly parent?: Window;\r\n\treadonly personalbar?: BarProp;\r\n\treadonly screen?: Screen;\r\n\treadonly screenLeft?: number;\r\n\treadonly screenTop?: number;\r\n\treadonly screenX?: number;\r\n\treadonly screenY?: number;\r\n\treadonly scrollX?: number;\r\n\treadonly scrollY?: number;\r\n\treadonly scrollbars?: BarProp;\r\n\treadonly self?: Window & typeof globalThis;\r\n\treadonly speechSynthesis?: SpeechSynthesis;\r\n\treadonly statusbar?: BarProp;\r\n\treadonly styleMedia?: StyleMedia;\r\n\treadonly toolbar?: BarProp;\r\n\treadonly top?: Window;\r\n\treadonly window?: Window & typeof globalThis;\r\n\tcustomElements?: CustomElementRegistry;\r\n\tdefaultStatus?: string;\r\n\tlocation?: Location;\r\n\tname?: string;\r\n\toffscreenBuffering?: string | boolean;\r\n\topener?: any;\r\n\tstatus?: string;\r\n\t[index: number]: Window;\r\n\t/*\r\n\talert(message?: any): void;\r\n\tblur(): void;\r\n\tclose(): void;\r\n\tconfirm(message?: string): boolean;\r\n\tdepartFocus(navigationReason: NavigationReason, origin: FocusNavigationOrigin): void;\r\n\tfocus(): void;\r\n\tgetComputedStyle(elt: Element, pseudoElt?: string | null): CSSStyleDeclaration;\r\n\tgetMatchedCSSRules(elt: Element, pseudoElt?: string | null): CSSRuleList;\r\n\tgetSelection(): Selection | null;\r\n\tmatchMedia(query: string): MediaQueryList;\r\n\tmoveBy(x: number, y: number): void;\r\n\tmoveTo(x: number, y: number): void;\r\n\tmsWriteProfilerMark(profilerMarkName: string): void;\r\n\topen(url?: string, target?: string, features?: string, replace?: boolean): Window | null;\r\n\tpostMessage(message: any, targetOrigin: string, transfer?: Transferable[]): void;\r\n\tprint(): void;\r\n\tprompt(message?: string, _default?: string): string | null;\r\n\tresizeBy(x: number, y: number): void;\r\n\tresizeTo(x: number, y: number): void;\r\n\tscroll(options?: ScrollToOptions): void;\r\n\tscroll(x: number, y: number): void;\r\n\tscrollBy(options?: ScrollToOptions): void;\r\n\tscrollBy(x: number, y: number): void;\r\n\tscrollTo(options?: ScrollToOptions): void;\r\n\tscrollTo(x: number, y: number): void;\r\n\tstop(): void;\r\n\twebkitCancelAnimationFrame(handle: number): void;\r\n\twebkitConvertPointFromNodeToPage(node: Node, pt: WebKitPoint): WebKitPoint;\r\n\twebkitConvertPointFromPageToNode(node: Node, pt: WebKitPoint): WebKitPoint;\r\n\twebkitRequestAnimationFrame(callback: FrameRequestCallback): number;\r\n\taddEventListener<K extends keyof WindowEventMap>(type: K, listener: (this: Window, event: WindowEventMap[K]) => any, options?: boolean | AddEventListenerOptions): void;\r\n\taddEventListener(type: string, listener: EventListenerOrEventListenerObject, options?: boolean | AddEventListenerOptions): void;\r\n\tremoveEventListener<K extends keyof WindowEventMap>(type: K, listener: (this: Window, event: WindowEventMap[K]) => any, options?: boolean | EventListenerOptions): void;\r\n\tremoveEventListener(type: string, listener: EventListenerOrEventListenerObject, options?: boolean | EventListenerOptions): void;\r\n\toncompassneedscalibration: ((this: Window, event: Event) => any) | null;\r\n\tondevicelight: ((this: Window, event: DeviceLightEvent) => any) | null;\r\n\tondevicemotion: ((this: Window, event: DeviceMotionEvent) => any) | null;\r\n\tondeviceorientation: ((this: Window, event: DeviceOrientationEvent) => any) | null;\r\n\tondeviceorientationabsolute: ((this: Window, event: DeviceOrientationEvent) => any) | null;\r\n\tonmousewheel: ((this: Window, event: Event) => any) | null;\r\n\tonmsgesturechange: ((this: Window, event: Event) => any) | null;\r\n\tonmsgesturedoubletap: ((this: Window, event: Event) => any) | null;\r\n\tonmsgestureend: ((this: Window, event: Event) => any) | null;\r\n\tonmsgesturehold: ((this: Window, event: Event) => any) | null;\r\n\tonmsgesturestart: ((this: Window, event: Event) => any) | null;\r\n\tonmsgesturetap: ((this: Window, event: Event) => any) | null;\r\n\tonmsinertiastart: ((this: Window, event: Event) => any) | null;\r\n\tonmspointercancel: ((this: Window, event: Event) => any) | null;\r\n\tonmspointerdown: ((this: Window, event: Event) => any) | null;\r\n\tonmspointerenter: ((this: Window, event: Event) => any) | null;\r\n\tonmspointerleave: ((this: Window, event: Event) => any) | null;\r\n\tonmspointermove: ((this: Window, event: Event) => any) | null;\r\n\tonmspointerout: ((this: Window, event: Event) => any) | null;\r\n\tonmspointerover: ((this: Window, event: Event) => any) | null;\r\n\tonmspointerup: ((this: Window, event: Event) => any) | null;\r\n\tonreadystatechange: ((this: Window, event: ProgressEvent<Window>) => any) | null;\r\n\tonvrdisplayactivate: ((this: Window, event: Event) => any) | null;\r\n\tonvrdisplayblur: ((this: Window, event: Event) => any) | null;\r\n\tonvrdisplayconnect: ((this: Window, event: Event) => any) | null;\r\n\tonvrdisplaydeactivate: ((this: Window, event: Event) => any) | null;\r\n\tonvrdisplaydisconnect: ((this: Window, event: Event) => any) | null;\r\n\tonvrdisplayfocus: ((this: Window, event: Event) => any) | null;\r\n\tonvrdisplaypointerrestricted: ((this: Window, event: Event) => any) | null;\r\n\tonvrdisplaypointerunrestricted: ((this: Window, event: Event) => any) | null;\r\n\tonvrdisplaypresentchange: ((this: Window, event: Event) => any) | null;\r\n\t*/\r\n\t// DEPRECATED !!!\r\n\t// @deprecated\r\n\t// readonly event: Event | undefined;\r\n\t// @deprecated\r\n\t// readonly external: External;\r\n\t// @deprecated\r\n\t// readonly orientation: string | number;\r\n\t// @deprecated\r\n\t// captureEvents(): void;\r\n\t// @deprecated\r\n\t// releaseEvents(): void;\r\n\t// @deprecated\r\n\t// onorientationchange: ((this: Window, event: Event) => any) | null;\r\n}\r\nexport class RxWindow {\r\n\treadonly applicationCache!: ApplicationCache;\r\n\treadonly clientInformation!: Navigator;\r\n\treadonly closed!: boolean;\r\n\treadonly devicePixelRatio!: number;\r\n\treadonly doNotTrack!: string;\r\n\treadonly document!: Document;\r\n\treadonly frameElement!: Element;\r\n\treadonly frames!: Window;\r\n\treadonly history!: History;\r\n\treadonly innerHeight!: number;\r\n\treadonly innerWidth!: number;\r\n\treadonly length!: number;\r\n\treadonly locationbar!: BarProp;\r\n\treadonly menubar!: BarProp;\r\n\treadonly msContentScript!: ExtensionScriptApis;\r\n\treadonly navigator!: Navigator;\r\n\treadonly outerHeight!: number;\r\n\treadonly outerWidth!: number;\r\n\treadonly pageXOffset!: number;\r\n\treadonly pageYOffset!: number;\r\n\treadonly parent!: Window;\r\n\treadonly personalbar!: BarProp;\r\n\treadonly screen!: Screen;\r\n\treadonly screenLeft!: number;\r\n\treadonly screenTop!: number;\r\n\treadonly screenX!: number;\r\n\treadonly screenY!: number;\r\n\treadonly scrollX!: number;\r\n\treadonly scrollY!: number;\r\n\treadonly scrollbars!: BarProp;\r\n\treadonly self!: Window & typeof globalThis;\r\n\treadonly speechSynthesis!: SpeechSynthesis;\r\n\treadonly statusbar!: BarProp;\r\n\treadonly styleMedia!: StyleMedia;\r\n\treadonly toolbar!: BarProp;\r\n\treadonly top!: Window;\r\n\treadonly window!: Window & typeof globalThis;\r\n\tcustomElements!: CustomElementRegistry;\r\n\tdefaultStatus!: string;\r\n\tlocation!: Location;\r\n\tname!: string;\r\n\toffscreenBuffering!: string | boolean;\r\n\topener!: any;\r\n\tstatus!: string;\r\n\t[index: number]: Window;\r\n\tconstructor(options?: IWindow) {\r\n\t\tif (options) {\r\n\t\t\tObject.assign(this, options);\r\n\t\t}\r\n\t}\r\n\t/* tslint:disable:no-unused-variable */\r\n\talert(message?: any): void { }\r\n\tblur(): void { }\r\n\tclose(): void { }\r\n\tconfirm(message?: string): boolean { return false; }\r\n\tdepartFocus(navigationReason: NavigationReason, origin: FocusNavigationOrigin): void { }\r\n\tfocus(): void { }\r\n\tgetComputedStyle(elt: Element, pseudoElt?: string | null): any { } // CSSStyleDeclaration {}\r\n\tgetMatchedCSSRules(elt: Element, pseudoElt?: string | null): any { } // CSSRuleList {}\r\n\tgetSelection(): Selection | null { return null; }\r\n\tmatchMedia(query: string): any { } // MediaQueryList { }\r\n\tmoveBy(x: number, y: number): void { }\r\n\tmoveTo(x: number, y: number): void { }\r\n\tmsWriteProfilerMark(profilerMarkName: string): void { }\r\n\topen(url?: string, target?: string, features?: string, replace?: boolean): Window | null { return null; }\r\n\tpostMessage(message: any, targetOrigin: string, transfer?: Transferable[]): void { }\r\n\tprint(): void { }\r\n\tprompt(message?: string, _default?: string): string | null { return null; }\r\n\tresizeBy(x: number, y: number): void { }\r\n\tresizeTo(x: number, y: number): void { }\r\n\tscroll(...args: any[]): void { }\r\n\tscrollBy(...args: any[]): void { }\r\n\tscrollTo(...args: any[]): void { }\r\n\tstop(): void { }\r\n\twebkitCancelAnimationFrame(handle: number): void { }\r\n\twebkitConvertPointFromNodeToPage(node: Node, pt: WebKitPoint): any { } // WebKitPoint { }\r\n\twebkitConvertPointFromPageToNode(node: Node, pt: WebKitPoint): any { } // WebKitPoint { }\r\n\twebkitRequestAnimationFrame(callback: FrameRequestCallback): number { return 0; }\r\n\taddEventListener<K extends keyof WindowEventMap>(type: K, listener: (this: Window, event: WindowEventMap[K]) => any, options?: boolean | AddEventListenerOptions): void;\r\n\taddEventListener(type: string, listener: EventListenerOrEventListenerObject, options?: boolean | AddEventListenerOptions): void { }\r\n\tremoveEventListener<K extends keyof WindowEventMap>(type: K, listener: (this: Window, event: WindowEventMap[K]) => any, options?: boolean | EventListenerOptions): void;\r\n\tremoveEventListener(type: string, listener: EventListenerOrEventListenerObject, options?: boolean | EventListenerOptions): void { }\r\n\toncompassneedscalibration(event: Event): any | null { return null; }\r\n\tondevicelight(event: DeviceLightEvent): any | null { return null; }\r\n\tondevicemotion(event: DeviceMotionEvent): any | null { }\r\n\tondeviceorientation(event: DeviceOrientationEvent): any | null { }\r\n\tondeviceorientationabsolute(event: DeviceOrientationEvent): any | null { }\r\n\tonmousewheel(event: Event): any | null { }\r\n\tonmsgesturechange(event: Event): any | null { }\r\n\tonmsgesturedoubletap(event: Event): any | null { }\r\n\tonmsgestureend(event: Event): any | null { }\r\n\tonmsgesturehold(event: Event): any | null { }\r\n\tonmsgesturestart(event: Event): any | null { }\r\n\tonmsgesturetap(event: Event): any | null { }\r\n\tonmsinertiastart(event: Event): any | null { }\r\n\tonmspointercancel(event: Event): any | null { }\r\n\tonmspointerdown(event: Event): any | null { }\r\n\tonmspointerenter(event: Event): any | null { }\r\n\tonmspointerleave(event: Event): any | null { }\r\n\tonmspointermove(event: Event): any | null { }\r\n\tonmspointerout(event: Event): any | null { }\r\n\tonmspointerover(event: Event): any | null { }\r\n\tonmspointerup(event: Event): any | null { }\r\n\tonreadystatechange(event: ProgressEvent<Window>): any | null { }\r\n\tonvrdisplayactivate(event: Event): any | null { }\r\n\tonvrdisplayblur(event: Event): any | null { }\r\n\tonvrdisplayconnect(event: Event): any | null { }\r\n\tonvrdisplaydeactivate(event: Event): any | null { }\r\n\tonvrdisplaydisconnect(event: Event): any | null { }\r\n\tonvrdisplayfocus(event: Event): any | null { }\r\n\tonvrdisplaypointerrestricted(event: Event): any | null { }\r\n\tonvrdisplaypointerunrestricted(event: Event): any | null { }\r\n\tonvrdisplaypresentchange(event: Event): any | null { }\r\n\t/* tslint:enable:no-unused-variable */\r\n}\r\n/*\r\nglobal: [Circular],\r\nclearInterval: [Function: clearInterval],\r\nclearTimeout: [Function: clearTimeout],\r\nsetInterval: [Function: setInterval],\r\nsetTimeout: [Function: setTimeout] { [Symbol(util.promisify.custom)]: [Function] },\r\nqueueMicrotask: [Function: queueMicrotask],\r\nclearImmediate: [Function: clearImmediate],\r\nsetImmediate: [Function: setImmediate] {\r\n[Symbol(util.promisify.custom)]: [Function]\r\n},\r\n__extends: [Function: __extends],\r\n__assign: [Function: assign],\r\n__rest: [Function: __rest],\r\n__decorate: [Function: __decorate],\r\n__param: [Function: __param],\r\n__metadata: [Function: __metadata],\r\n__awaiter: [Function: __awaiter],\r\n__generator: [Function: __generator],\r\n__exportStar: [Function: __exportStar],\r\n__createBinding: [Function],\r\n__values: [Function: __values],\r\n__read: [Function: __read],\r\n__spread: [Function: __spread],\r\n__spreadArrays: [Function: __spreadArrays],\r\n__await: [Function: __await],\r\n__asyncGenerator: [Function: __asyncGenerator],\r\n__asyncDelegator: [Function: __asyncDelegator],\r\n__asyncValues: [Function: __asyncValues],\r\n__makeTemplateObject: [Function: __makeTemplateObject],\r\n__importStar: [Function: __importStar],\r\n__importDefault: [Function: __importDefault],\r\n__classPrivateFieldGet: [Function: __classPrivateFieldGet],\r\n__classPrivateFieldSet: [Function: __classPrivateFieldSet],\r\nfetch: [Function: bound fetch] { polyfill: true },\r\nResponse: undefined,\r\nHeaders: undefined,\r\nRequest: undefined\r\n*/\r\nexport function isRxElement(x: RxNode): x is RxElement {\r\n\treturn x.nodeType === RxNodeType.ELEMENT_NODE;\r\n}\r\nexport function isRxText(x: RxNode): x is RxText {\r\n\treturn x.nodeType === RxNodeType.TEXT_NODE;\r\n}\r\nexport function isRxComment(x: RxNode): x is RxComment {\r\n\treturn x.nodeType === RxNodeType.COMMENT_NODE;\r\n}\r\nexport function isRxDocument(x: RxNode): x is RxDocument {\r\n\treturn x.nodeType === RxNodeType.DOCUMENT_NODE;\r\n}\r\nexport function isRxDocumentFragment(x: RxNode): x is RxDocumentFragment {\r\n\treturn x.nodeType === RxNodeType.DOCUMENT_FRAGMENT_NODE;\r\n}\r\nexport function isRxDocumentType(x: RxNode): x is RxDocumentType {\r\n\treturn x.nodeType === RxNodeType.DOCUMENT_TYPE_NODE;\r\n}\r\nexport function isRxProcessingInstruction(x: RxNode): x is RxProcessingInstruction {\r\n\treturn x.nodeType === RxNodeType.PROCESSING_INSTRUCTION_NODE;\r\n}\r\nexport function parse(html: string) {\r\n\tconst doc = new RxDocument();\r\n\tlet parentNode: RxElement = doc,\r\n\t\tnode;\r\n\tconst parser = new Parser(\r\n\t\t{\r\n\t\t\tonopentag: (nodeName, attributes) => {\r\n\t\t\t\t// console.log(nodeName);\r\n\t\t\t\tnode = new RxElement(parentNode, nodeName, attributes);\r\n\t\t\t\tparentNode.childNodes.push(node);\r\n\t\t\t\tparentNode = node;\r\n\t\t\t\t// if (NO_CHILDS.indexOf(nodeName) === -1) {\r\n\t\t\t\t// console.log(nodeName);\r\n\t\t\t\t//\tparentNode = node;\r\n\t\t\t\t// }\r\n\t\t\t},\r\n\t\t\tonclosetag: (nodeName) => {\r\n\t\t\t\tif (parentNode.parentNode) {\r\n\t\t\t\t\tparentNode = parentNode.parentNode;\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tontext: (nodeValue) => {\r\n\t\t\t\t// console.log('ontext', nodeValue);\r\n\t\t\t\t// if (nodeValue.length) {\r\n\t\t\t\tconst textNode = new RxText(parentNode, nodeValue);\r\n\t\t\t\tparentNode.childNodes.push(textNode);\r\n\t\t\t\t// }\r\n\t\t\t},\r\n\t\t\tonprocessinginstruction: (nodeName, nodeValue) => {\r\n\t\t\t\t// console.log('onprocessinginstruction', nodeName, nodeValue);\r\n\t\t\t\tif (nodeName === '!doctype') {\r\n\t\t\t\t\tnode = new RxDocumentType(parentNode, nodeValue);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tnode = new RxProcessingInstruction(parentNode, nodeValue);\r\n\t\t\t\t}\r\n\t\t\t\tparentNode.childNodes.push(node);\r\n\t\t\t},\r\n\t\t\toncomment: nodeValue => {\r\n\t\t\t\t// console.log('oncomment', nodeValue);\r\n\t\t\t\tnode = new RxComment(parentNode, nodeValue);\r\n\t\t\t\tparentNode.childNodes.push(node);\r\n\t\t\t\t// parentNode = node;\r\n\t\t\t},\r\n\t\t\toncommentend: () => {\r\n\t\t\t\t// console.log('oncommentend');\r\n\t\t\t\t// parentNode = parentNode.parentNode;\r\n\t\t\t},\r\n\t\t\t/*\r\n\t\t\toncdatastart: () => {\r\n\t\t\t\t// console.log('oncdatastart');\r\n\t\t\t},\r\n\t\t\toncdataend: () => {\r\n\t\t\t\t// console.log('oncdataend');\r\n\t\t\t},\r\n\t\t\tonerror: error => {\r\n\t\t\t\t// console.log('error', error);\r\n\t\t\t},\r\n\t\t\tonopentagname: (name) => {\r\n\t\t\t\t// console.log('onopentagname', name);\r\n\t\t\t},\r\n\t\t\tonattribute: (name, value) => {\r\n\t\t\t\t// console.log('onattribute', name, value);\r\n\t\t\t},\r\n\t\t\tonreset: () => {\r\n\t\t\t\t// console.log('reset');\r\n\t\t\t},\r\n\t\t\tonend: () => {\r\n\t\t\t\t// console.log('end');\r\n\t\t\t},\r\n\t\t\t*/\r\n\t\t},\r\n\t\t{\r\n\t\t\tdecodeEntities: false,\r\n\t\t\tlowerCaseTags: true,\r\n\t\t}\r\n\t);\r\n\tparser.write(html);\r\n\tparser.end();\r\n\treturn doc;\r\n}\r\nexport function getQueries(selector: string): RxQuery[] {\r\n\tconst queries: RxQuery[] = [];\r\n\tselector\r\n\t\t.trim()\r\n\t\t.split(' ')\r\n\t\t.forEach((x: string) => {\r\n\t\t\tx.trim()\r\n\t\t\t\t.split('>')\r\n\t\t\t\t.forEach((x, i) => {\r\n\t\t\t\t\t// const regex = /\\.([^\\.[]+)|\\[([^\\.\\[]+)\\]|([^\\.\\[\\]]+)/g;\r\n\t\t\t\t\t// const regex = /\\#([^\\.[#]+)|\\.([^\\.[#]+)|\\[([^\\.\\[#]+)\\]|([^\\.\\[#\\]]+)/g;\r\n\t\t\t\t\tconst regex = /\\:not\\(\\#([^\\.[#:]+)\\)|\\:not\\(\\.([^\\.[#:]+)\\)|\\:not\\(\\[([^\\.\\[#:]+)\\]\\)|\\:not\\(([^\\.\\[#:\\]]+)\\)|\\#([^\\.[#:]+)|\\.([^\\.[#:]+)|\\[([^\\.\\[#:]+)\\]|([^\\.\\[#:\\]]+)/g;\r\n\t\t\t\t\t/* eslint no-useless-escape: \"off\" */\r\n\t\t\t\t\tconst selectors = [];\r\n\t\t\t\t\tconst matches = x.matchAll(regex);\r\n\t\t\t\t\tfor (const match of matches) {\r\n\t\t\t\t\t\tif (match[1]) {\r\n\t\t\t\t\t\t\tselectors.push({ selector: match[1], type: SelectorType.Id, negate: true });\r\n\t\t\t\t\t\t} else if (match[2]) {\r\n\t\t\t\t\t\t\tselectors.push({ selector: match[2], type: SelectorType.Class, negate: true });\r\n\t\t\t\t\t\t} else if (match[3]) {\r\n\t\t\t\t\t\t\tselectors.push({ selector: match[3], type: SelectorType.Attribute, negate: true });\r\n\t\t\t\t\t\t} else if (match[4]) {\r\n\t\t\t\t\t\t\tselectors.push({ selector: match[4], type: SelectorType.TagName, negate: true });\r\n\t\t\t\t\t\t} else if (match[5]) {\r\n\t\t\t\t\t\t\tselectors.push({ selector: match[5], type: SelectorType.Id, negate: false });\r\n\t\t\t\t\t\t} else if (match[6]) {\r\n\t\t\t\t\t\t\tselectors.push({ selector: match[6], type: SelectorType.Class, negate: false });\r\n\t\t\t\t\t\t} else if (match[7]) {\r\n\t\t\t\t\t\t\tselectors.push({ selector: match[7], type: SelectorType.Attribute, negate: false });\r\n\t\t\t\t\t\t} else if (match[8]) {\r\n\t\t\t\t\t\t\tselectors.push({ selector: match[8], type: SelectorType.TagName, negate: false });\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t// console.log('match', match);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tconst selector =\r\n\t\t\t\t\t\ti > 0\r\n\t\t\t\t\t\t\t? { selector: x, selectors, inner: true }\r\n\t\t\t\t\t\t\t: { selector: x, selectors, inner: false };\r\n\t\t\t\t\tqueries.push.call(queries, selector);\r\n\t\t\t\t});\r\n\t\t});\r\n\treturn queries;\r\n}\r\nexport function matchSelector(child: RxElement, selector: RxSelector): boolean {\r\n\tswitch (selector.type) {\r\n\t\tcase SelectorType.Id:\r\n\t\t\treturn (selector.selector !== '' && child.attributes.id === selector.selector) !== selector.negate;\r\n\t\tcase SelectorType.Class:\r\n\t\t\treturn (child.classList.indexOf(selector.selector) !== -1) !== selector.negate;\r\n\t\tcase SelectorType.Attribute:\r\n\t\t\treturn (Object.keys(child.attributes).indexOf(selector.selector) !== -1) !== selector.negate;\r\n\t\tcase SelectorType.TagName:\r\n\t\t\treturn (child.nodeName === selector.selector) !== selector.negate;\r\n\t\tdefault:\r\n\t\t\treturn false;\r\n\t}\r\n}\r\nexport function matchSelectors(child: RxElement, selectors: RxSelector[]): boolean {\r\n\treturn selectors.reduce(function (p: boolean, selector: RxSelector) {\r\n\t\treturn p && matchSelector(child, selector);\r\n\t}, true);\r\n}\r\nexport function querySelectorAll(queries: RxQuery[], childNodes: RxNode[], query: RxQuery | null = null, nodes: RxElement[] = []): RxElement[] | null {\r\n\tif (query || queries.length) {\r\n\t\tquery = query || queries.shift() as RxQuery;\r\n\t\tfor (let child of childNodes) {\r\n\t\t\tif (child instanceof RxElement) {\r\n\t\t\t\tif (matchSelectors(child, query.selectors)) {\r\n\t\t\t\t\t// console.log(query);\r\n\t\t\t\t\tif (queries.length) {\r\n\t\t\t\t\t\tconst results: RxElement[] | null = querySelectorAll(queries, child.childNodes);\r\n\t\t\t\t\t\tif (results) {\r\n\t\t\t\t\t\t\tArray.prototype.push.apply(nodes, results);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tnodes.push(child);\r\n\t\t\t\t\t}\r\n\t\t\t\t} else if (!query.inner) {\r\n\t\t\t\t\tconst results: RxElement[] | null = querySelectorAll(queries, child.childNodes, query);\r\n\t\t\t\t\tif (results) {\r\n\t\t\t\t\t\tArray.prototype.push.apply(nodes, results);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn nodes.length ? nodes : null;\r\n}\r\nexport function querySelector(queries: RxQuery[], childNodes: RxNode[], query: RxQuery | null = null): RxElement | null {\r\n\tlet node = null;\r\n\tif (query || queries.length) {\r\n\t\tquery = query || queries.shift() as RxQuery;\r\n\t\tfor (let child of childNodes) {\r\n\t\t\tif (child instanceof RxElement) {\r\n\t\t\t\tif (matchSelectors(child, query.selectors)) {\r\n\t\t\t\t\t// console.log(query);\r\n\t\t\t\t\tif (queries.length) {\r\n\t\t\t\t\t\treturn querySelector(queries, child.childNodes);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\treturn child;\r\n\t\t\t\t\t}\r\n\t\t\t\t} else if (!query.inner) {\r\n\t\t\t\t\tnode = querySelector(queries, child.childNodes, query);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn node;\r\n}\r\nexport function cloneNode(source: RxNode, deep: boolean = false, parentNode: RxElement | null = null): RxNode {\r\n\tlet node: RxNode;\r\n\tif (isRxElement(source)) {\r\n\t\tconst nodeElement: RxElement = new RxElement(\r\n\t\t\tparentNode,\r\n\t\t\tsource.nodeName,\r\n\t\t\tObject.assign({}, source.attributes),\r\n\t\t);\r\n\t\tif (deep) {\r\n\t\t\tnodeElement.childNodes = source.childNodes.map(x => cloneNode.apply(x, [x, deep, nodeElement]));\r\n\t\t}\r\n\t\tnode = nodeElement;\r\n\t} else if (isRxDocumentFragment(source)) {\r\n\t\tconst nodeDocumentFragment: RxDocumentFragment = new RxDocumentFragment();\r\n\t\tif (deep) {\r\n\t\t\tnodeDocumentFragment.childNodes = source.childNodes.map(x => cloneNode.apply(x, [x, deep, nodeDocumentFragment]));\r\n\t\t}\r\n\t\tnode = nodeDocumentFragment;\r\n\t} else if (isRxText(source)) {\r\n\t\tnode = new RxText(parentNode, source.nodeValue);\r\n\t} else if (isRxComment(source)) {\r\n\t\tnode = new RxComment(parentNode, source.nodeValue);\r\n\t} else if (isRxDocument(source)) {\r\n\t\tconst documentElement: RxDocument = new RxDocument();\r\n\t\tif (deep) {\r\n\t\t\tdocumentElement.childNodes = source.childNodes.map(x => cloneNode.apply(x, [x, deep, documentElement]));\r\n\t\t}\r\n\t\tnode = documentElement;\r\n\t} else {\r\n\t\tthrow new Error('Invalid node type');\r\n\t}\r\n\treturn node;\r\n}\r\n","import { getLocationComponents, ILocationInit } from \"rxcomp\";\r\n\r\nexport interface IDOMStringList extends DOMStringList {\r\n\t// Returns the number of strings in strings.\r\n\treadonly length: number;\r\n\t// Returns true if strings contains string, and false otherwise.\r\n\tcontains(string: string): boolean;\r\n\t// Returns the string with index index from strings.\r\n\titem(index: number): string | null;\r\n\t[index: number]: string;\r\n}\r\nexport class RxDOMStringList extends Array<string> implements IDOMStringList {\r\n\t/*\r\n\tprivate list_: string[] = [];\r\n\tget length(): number {\r\n\t\treturn this.list_.length;\r\n\t}\r\n\t*/\r\n\tcontains(string: string): boolean {\r\n\t\t// return this.list_.indexOf(string) !== -1;\r\n\t\treturn this.indexOf(string) !== -1;\r\n\t}\r\n\titem(index: number): string | null {\r\n\t\t// if (index > 0 && index < this.list_.length) {\r\n\t\tif (index > 0 && index < this.length) {\r\n\t\t\t// return this.list_[index];\r\n\t\t\treturn this[index];\r\n\t\t} else {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t};\r\n\t// [index: number]: string;\r\n}\r\nexport interface ILocation extends Location {\r\n\t/*\r\n\thash: string; // Returns the Location object's URL's fragment (includes leading \"#\" if non-empty). Can be set, to navigate to the same URL with a changed fragment (ignores leading \"#\").\r\n\thost: string; // Returns the Location object's URL's host and port (if different from the default port for the scheme). Can be set, to navigate to the same URL with a changed host and port.\r\n\thostname: string; // Returns the Location object's URL's host. Can be set, to navigate to the same URL with a changed host.\r\n\tpathname: string; // Returns the Location object's URL's path. Can be set, to navigate to the same URL with a changed path.\r\n\tport: string; // Returns the Location object's URL's port. Can be set, to navigate to the same URL with a changed port.\r\n\tprotocol: string; // Returns the Location object's URL's scheme. Can be set, to navigate to the same URL with a changed scheme.\r\n\tsearch: string; // Returns the Location object's URL's query (includes leading \"?\" if non-empty). Can be set, to navigate to the same URL with a changed query (ignores leading \"?\").\r\n\thref: string; // Returns the Location object's URL. Can be set, to navigate to the given URL.\r\n\treadonly origin: string; // Returns the Location object's URL's origin.\r\n\treadonly ancestorOrigins: DOMStringList; // Returns a DOMStringList object listing the origins of the ancestor browsing contexts, from the parent browsing context to the top-level browsing context.\r\n\tassign(url: string): void; // Navigates to the given URL.\r\n\treload(): void; // reload(forcedReload: boolean): void; // @deprecated\r\n\treplace(url: string): void; // Removes the current page from the session history and navigates to the given URL.\r\n\ttoString(): string;\r\n\t*/\r\n}\r\nexport class RxLocation implements ILocation {\r\n\t/*\r\n\thash: string = '';\r\n\thost: string = '';\r\n\thostname: string = '';\r\n\tpathname: string = '';\r\n\tport: string = '';\r\n\tprotocol: string = '';\r\n\tsearch: string = '';\r\n\t*/\r\n\tprivate hash_: string = '';\r\n\tget hash(): string { return this.hash_; }\r\n\tset hash(hash: string) { this.hash_ = hash; this.href = this.href; }\r\n\tprivate host_: string = '';\r\n\tget host(): string { return this.host_; }\r\n\tset host(host: string) { this.host_ = host; this.href = this.href; }\r\n\tprivate hostname_: string = '';\r\n\tget hostname(): string { return this.hostname_; }\r\n\tset hostname(hostname: string) { this.hostname_ = hostname; this.href = this.href; }\r\n\tprivate pathname_: string = '';\r\n\tget pathname(): string { return this.pathname_; }\r\n\tset pathname(pathname: string) { this.pathname_ = pathname; this.href = this.href; }\r\n\tprivate port_: string = '';\r\n\tget port(): string { return this.port_; }\r\n\tset port(port: string) { this.port_ = port; this.href = this.href; }\r\n\tprivate protocol_: string = '';\r\n\tget protocol(): string { return this.protocol_; }\r\n\tset protocol(protocol: string) { this.protocol_ = protocol; this.href = this.href; }\r\n\tprivate search_: string = '';\r\n\tget search(): string { return this.search_; }\r\n\tset search(search: string) { this.search_ = search; this.href = this.href; }\r\n\tprivate href_: string = '';\r\n\tget href(): string {\r\n\t\tconst href: string = `${this.protocol}//${this.host}${this.port.length ? `:${this.port}` : ``}${this.pathname}${this.search}${this.hash}`;\r\n\t\tthis.href_ = href;\r\n\t\treturn href;\r\n\t}\r\n\tset href(href: string) {\r\n\t\tif (this.href_ !== href) {\r\n\t\t\tthis.href_ = href;\r\n\t\t\tconst location: ILocationInit = getLocationComponents(href);\r\n\t\t\tthis.protocol_ = location.protocol;\r\n\t\t\tthis.host_ = location.host;\r\n\t\t\tthis.hostname_ = location.hostname;\r\n\t\t\tthis.port_ = location.port;\r\n\t\t\tthis.pathname_ = location.pathname;\r\n\t\t\tthis.search_ = location.search;\r\n\t\t\tthis.hash_ = location.hash;\r\n\t\t}\r\n\t}\r\n\tget origin(): string {\r\n\t\treturn `${this.protocol}//${this.host}${this.port.length ? `:${this.port}` : ``}`;\r\n\t}\r\n\tprivate ancestorOrigins_: IDOMStringList = new RxDOMStringList();\r\n\tget ancestorOrigins(): DOMStringList {\r\n\t\treturn this.ancestorOrigins_;\r\n\t}\r\n\tassign(url: string): void {\r\n\t\tthis.href = url;\r\n\t}\r\n\treload(): void { }\r\n\treplace(url: string): void {\r\n\t\tthis.href = url;\r\n\t}\r\n\ttoString(): string {\r\n\t\treturn this.href;\r\n\t}\r\n\tprivate static location_: ILocation;\r\n\tstatic get location(): ILocation {\r\n\t\tif (this.location_) {\r\n\t\t\treturn this.location_;\r\n\t\t} else {\r\n\t\t\treturn this.location_ = new RxLocation();\r\n\t\t}\r\n\t}\r\n}\r\n","import { RxLocation } from \"../location/location\";\r\n\r\nexport interface IHistoryItem {\r\n\tdata: any;\r\n\ttitle: string;\r\n\turl?: string | null;\r\n}\r\nexport interface IHistory extends History {\r\n\t/*\r\n\treadonly length: number;\r\n    scrollRestoration: ScrollRestoration;\r\n    readonly state: any;\r\n    back(): void;\r\n    forward(): void;\r\n    go(delta?: number): void;\r\n    pushState(data: any, title: string, url?: string | null): void;\r\n\treplaceState(data: any, title: string, url?: string | null): void;\r\n\t*/\r\n}\r\nexport class RxHistory implements IHistory {\r\n\tprivate currentIndex_: number = 0;\r\n\tprivate history_: IHistoryItem[] = [];\r\n\tget length(): number {\r\n\t\treturn this.history_.length;\r\n\t}\r\n\tscrollRestoration: ScrollRestoration = 'auto';\r\n\tstate: any;\r\n\tback(): void {\r\n\t\tif (this.currentIndex_ > 0) {\r\n\t\t\tthis.currentIndex_--;\r\n\t\t\tconst item: IHistoryItem = this.history_[this.currentIndex_];\r\n\t\t\tif (item.url) RxLocation.location.href = item.url;\r\n\t\t}\r\n\t};\r\n\tforward(): void {\r\n\t\tif (this.currentIndex_ < this.history_.length - 1) {\r\n\t\t\tthis.currentIndex_++;\r\n\t\t\tconst item: IHistoryItem = this.history_[this.currentIndex_];\r\n\t\t\tif (item.url) RxLocation.location.href = item.url;\r\n\t\t}\r\n\t};\r\n\tgo(delta?: number): void {\r\n\t\tif (typeof delta === 'number') {\r\n\t\t\tconst index: number = this.currentIndex_ + delta;\r\n\t\t\tif (index > 0 && index < this.history_.length) {\r\n\t\t\t\tconst item: IHistoryItem = this.history_[index];\r\n\t\t\t\tif (item.url) RxLocation.location.href = item.url;\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\tpushState(data: any, title: string, url?: string | null): void {\r\n\t\tthis.history_.push({ data, title, url });\r\n\t\tthis.currentIndex_ = this.history_.length - 1;\r\n\t};\r\n\treplaceState(data: any, title: string, url?: string | null): void {\r\n\t\tif (this.history_.length) {\r\n\t\t\tthis.history_.splice(this.history_.length - 1, 1, { data, title, url });\r\n\t\t} else {\r\n\t\t\tthis.history_.push({ data, title, url });\r\n\t\t}\r\n\t\tthis.currentIndex_ = this.history_.length - 1;\r\n\t};\r\n\tprivate static history_: History;\r\n\tstatic get history(): IHistory {\r\n\t\tif (this.history_) {\r\n\t\t\treturn this.history_;\r\n\t\t} else {\r\n\t\t\treturn this.history_ = new RxHistory();\r\n\t\t}\r\n\t}\r\n}\r\n","import { isPlatformServer, Module, ModuleError, Platform } from 'rxcomp';\r\nimport { Observable, Observer, of, throwError } from 'rxjs';\r\nimport { switchMap } from 'rxjs/operators';\r\nimport CacheService, { CacheControlType, CacheMode } from '../cache/cache.service';\r\nimport FileService from '../file/file.service';\r\nimport { IHistory, RxHistory } from '../history/history';\r\nimport { ILocation, RxLocation } from '../location/location';\r\nimport { parse, RxDocument, RxElement, RxText, RxWindow } from '../nodes/nodes';\r\n\r\nexport interface IServerVars {\r\n\tname?: string;\r\n\thost?: string;\r\n\tport?: number;\r\n\tcharset?: string;\r\n\ttemplate?: string;\r\n\tcacheMode?: CacheMode;\r\n\tcache?: string;\r\n\troot?: string;\r\n\tresource?: string;\r\n\tapi?: string;\r\n\tstatic?: boolean;\r\n\tdevelopment?: boolean;\r\n\tproduction?: boolean;\r\n\t[key: string]: any;\r\n}\r\nexport interface IServerRequest {\r\n\turl: string;\r\n\ttemplate?: string;\r\n\tvars?: IServerVars;\r\n}\r\nexport interface IServerResponse extends IServerRequest {\r\n\tserialize: () => string;\r\n\tbody?: string;\r\n\tstatusCode?: number;\r\n\tstatusMessage?: string;\r\n\tmaxAge?: number;\r\n\tcacheControl?: CacheControlType;\r\n}\r\nexport interface IServerErrorResponse extends IServerRequest {\r\n\terror: Error;\r\n\tstatusCode?: number;\r\n\tstatusMessage?: string;\r\n}\r\nexport class ServerRequest implements IServerRequest {\r\n\turl!: string;\r\n\ttemplate!: string;\r\n\tvars!: IServerVars;\r\n\tconstructor(options?: IServerRequest) {\r\n\t\tif (options) {\r\n\t\t\tObject.assign(this, options);\r\n\t\t}\r\n\t\tthis.vars = Object.assign({\r\n\t\t\thost: 'http://localhost:5000',\r\n\t\t\tport: 5000,\r\n\t\t\tcharset: 'utf8',\r\n\t\t\ttemplate: `./index.html`,\r\n\t\t\tcacheMode: CacheMode.Memory,\r\n\t\t\tcache: './cache/',\r\n\t\t\troot: './dist/browser/',\r\n\t\t}, this.vars || {});\r\n\t}\r\n}\r\nexport class ServerResponse implements IServerResponse {\r\n\turl!: string;\r\n\ttemplate!: string;\r\n\tvars!: IServerVars;\r\n\tserialize!: () => string;\r\n\tbody!: string;\r\n\tstatusCode?: number;\r\n\tstatusMessage?: string;\r\n\tmaxAge: number = 3600;\r\n\tcacheControl: CacheControlType = CacheControlType.Public;\r\n\tconstructor(options?: IServerResponse) {\r\n\t\tif (options) {\r\n\t\t\tObject.assign(this, options);\r\n\t\t}\r\n\t}\r\n}\r\nexport class ServerErrorResponse implements IServerErrorResponse {\r\n\turl!: string;\r\n\tvars!: IServerVars;\r\n\terror!: Error;\r\n\tstatusCode?: number;\r\n\tstatusMessage?: string;\r\n\tconstructor(options?: IServerErrorResponse) {\r\n\t\tif (options) {\r\n\t\t\tObject.assign(this, options);\r\n\t\t}\r\n\t}\r\n}\r\nexport default class Server extends Platform {\r\n\r\n\t/**\r\n\t * @param moduleFactory\r\n\t * @description This method returns a Server compiled module\r\n\t */\r\n\tstatic bootstrap(moduleFactory?: typeof Module, request?: ServerRequest) {\r\n\t\tif (!isPlatformServer) {\r\n\t\t\tthrow new ModuleError('missing platform server, node process not found');\r\n\t\t}\r\n\t\tif (!moduleFactory) {\r\n\t\t\tthrow new ModuleError('missing moduleFactory');\r\n\t\t}\r\n\t\tif (!moduleFactory.meta) {\r\n\t\t\tthrow new ModuleError('missing moduleFactory meta');\r\n\t\t}\r\n\t\tif (!moduleFactory.meta.bootstrap) {\r\n\t\t\tthrow new ModuleError('missing bootstrap');\r\n\t\t}\r\n\t\tif (!moduleFactory.meta.bootstrap.meta) {\r\n\t\t\tthrow new ModuleError('missing bootstrap meta');\r\n\t\t}\r\n\t\tif (!moduleFactory.meta.bootstrap.meta.selector) {\r\n\t\t\tthrow new ModuleError('missing bootstrap meta selector');\r\n\t\t}\r\n\t\tif (!request?.template) {\r\n\t\t\tthrow new ModuleError('missing template');\r\n\t\t}\r\n\t\t/*\r\n\t\tif (typeof ((ReadableStream.prototype as any)[Symbol.asyncIterator]) === 'undefined') {\r\n\t\t\t(ReadableStream.prototype as any)[Symbol.asyncIterator] = async function* () {\r\n\t\t\t\tconst reader = this.getReader()\r\n\t\t\t\twhile (1) {\r\n\t\t\t\t\tconst r = await reader.read();\r\n\t\t\t\t\tif (r.done) {\r\n\t\t\t\t\t\treturn r.value;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tyield r.value;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\t*/\r\n\t\tconst document = this.resolveGlobals(request);\r\n\t\tconst meta = this.resolveMeta(moduleFactory);\r\n\t\tif (meta.node instanceof RxElement) {\r\n\t\t\tconst node: RxElement = meta.node as RxElement;\r\n\t\t\tconst nodeInnerHTML = meta.nodeInnerHTML;\r\n\t\t\tconst rxcomp_hydrate_ = {\r\n\t\t\t\tselector: moduleFactory.meta.bootstrap.meta.selector,\r\n\t\t\t\tinnerHTML: nodeInnerHTML,\r\n\t\t\t};\r\n\t\t\tconst scriptNode = new RxElement(null, 'script');\r\n\t\t\tconst scriptText = new RxText(null, `var rxcomp_hydrate_ = ${JSON.stringify(rxcomp_hydrate_)};`);\r\n\t\t\tscriptNode.append(scriptText);\r\n\t\t\tnode.parentNode?.insertBefore(scriptNode, node);\r\n\t\t}\r\n\t\tconst module = new moduleFactory();\r\n\t\tmodule.meta = meta;\r\n\t\tmeta.imports.forEach((moduleFactory: typeof Module) => {\r\n\t\t\tmoduleFactory.prototype.constructor.call(module);\r\n\t\t});\r\n\t\tconst instances = module.compile(meta.node, { document } as Window);\r\n\t\tmodule.instances = instances;\r\n\t\tconst root = instances[0];\r\n\t\troot.pushChanges();\r\n\t\treturn module;\r\n\t}\r\n\r\n\tstatic serialize(): string {\r\n\t\t// console.log('Server.serialize');\r\n\t\tif (this.document instanceof RxDocument) {\r\n\t\t\tconst serialized = this.document.serialize();\r\n\t\t\t// console.log('serialized', serialized);\r\n\t\t\treturn serialized;\r\n\t\t} else {\r\n\t\t\tthrow new ModuleError('document is not an instance of RxDocument');\r\n\t\t}\r\n\t}\r\n\r\n\tprotected static document: Document | RxDocument;\r\n\r\n\tprotected static resolveGlobals(request: ServerRequest): Document | RxDocument {\r\n\t\tconst url: string = request.url;\r\n\t\tconst location: ILocation = RxLocation.location;\r\n\t\tlocation.assign(url);\r\n\t\tglobal.location = location;\r\n\t\tconst history: IHistory = RxHistory.history;\r\n\t\thistory.replaceState(null, '', location.origin);\r\n\t\tglobal.history = history;\r\n\t\tconst documentOrHtml: Document | string = request.template!;\r\n\t\tconst document: Document | RxDocument = typeof documentOrHtml === 'string' ? parse(documentOrHtml) : documentOrHtml;\r\n\t\tthis.document = document as unknown as Document; // !!!\r\n\t\tglobal.document = this.document;\r\n\t\thistory.replaceState(null, document.title || '', location.origin);\r\n\t\tglobal.window = global.self = new RxWindow({\r\n\t\t\tdocument: (document as unknown as Document),\r\n\t\t\thistory,\r\n\t\t\tlocation,\r\n\t\t\tdevicePixelRatio: 1,\r\n\t\t}) as Window & typeof globalThis;\r\n\t\t// console.log('window', window);\r\n\t\treturn this.document;\r\n\t}\r\n\r\n\tstatic render$ = render$;\r\n\tstatic template$ = template$;\r\n\tstatic bootstrap$ = bootstrap$;\r\n}\r\nexport function render$(iRequest: IServerRequest, renderRequest$: (request: ServerRequest) => Observable<ServerResponse>): Observable<ServerResponse> {\r\n\tlet request: ServerRequest;\r\n\tconst request$: Observable<ServerRequest> = Observable.create(function (observer: Observer<ServerRequest>) {\r\n\t\trequest = new ServerRequest(iRequest);\r\n\t\tobserver.next(request);\r\n\t\tobserver.complete();\r\n\t});\r\n\treturn request$.pipe(\r\n\t\tswitchMap((request: ServerRequest) => fromCache$(request)),\r\n\t\tswitchMap((response: ServerResponse | null) => {\r\n\t\t\tconsole.log('NodeJs.Server.render$.fromCache', 'route', request.url, !!response);\r\n\t\t\tif (response) {\r\n\t\t\t\treturn of(response);\r\n\t\t\t} else {\r\n\t\t\t\treturn fromRenderRequest$(request, renderRequest$);\r\n\t\t\t}\r\n\t\t})\r\n\t);\r\n}\r\nexport function fromCache$(request: ServerRequest): Observable<ServerResponse | null> {\r\n\tif (request.vars.cacheMode) {\r\n\t\tCacheService.mode = request.vars.cacheMode;\r\n\t}\r\n\tif (request.vars.cache) {\r\n\t\tCacheService.folder = request.vars.cache;\r\n\t}\r\n\treturn CacheService.get$<ServerResponse | null>('render', request.url);\r\n}\r\nexport function fromRenderRequest$(request: ServerRequest, renderRequest$: (request: ServerRequest) => Observable<ServerResponse>): Observable<ServerResponse> {\r\n\treturn template$(request).pipe(\r\n\t\tswitchMap((template: string) => {\r\n\t\t\trequest.template = template;\r\n\t\t\treturn renderRequest$(request);\r\n\t\t}),\r\n\t\tswitchMap((response: ServerResponse) => {\r\n\t\t\treturn CacheService.set$('render', request.url, response, response.maxAge, response.cacheControl).pipe(\r\n\t\t\t\tswitchMap(() => of(response)),\r\n\t\t\t) as Observable<ServerResponse>;\r\n\t\t}),\r\n\t)\r\n}\r\nexport function template$(request: ServerRequest): Observable<string> {\r\n\tconst templateSrc$ = Observable.create(function (observer: Observer<string>) {\r\n\t\tconst src: string | undefined = request.vars.template;\r\n\t\tif (src) {\r\n\t\t\tobserver.next(src);\r\n\t\t\tobserver.complete();\r\n\t\t} else {\r\n\t\t\tobserver.error(new Error('ServerError: you must provide a template path'));\r\n\t\t}\r\n\t});\r\n\treturn templateSrc$.pipe(\r\n\t\tswitchMap((src: string) => FileService.readFile$(src)),\r\n\t\tswitchMap((template: string | null) => template ? of(template) : throwError(new Error(`ServerError: missing template at path ${request.vars.template}`)))\r\n\t);\r\n}\r\nexport function bootstrap$(moduleFactory: typeof Module, request: ServerRequest): Observable<ServerResponse> {\r\n\t// console.log('Server.bootstrap$', request);\r\n\treturn Observable.create(function (observer: Observer<ServerResponse>) {\r\n\t\tif (!request.template) {\r\n\t\t\treturn observer.error(new Error('ServerError: missing template'));\r\n\t\t}\r\n\t\ttry {\r\n\t\t\t// const module = Server.bootstrap(moduleFactory, request.template);\r\n\t\t\tServer.bootstrap(moduleFactory, request);\r\n\t\t\tconst serialize = () => Server.serialize();\r\n\t\t\tobserver.next(new ServerResponse(Object.assign({ serialize }, request) as IServerResponse));\r\n\t\t\tobserver.complete();\r\n\t\t} catch (error) {\r\n\t\t\tobserver.error(new ServerErrorResponse(Object.assign({ error }, request) as IServerErrorResponse));\r\n\t\t}\r\n\t});\r\n}\r\n","import { Component, getContext, IFactoryMeta } from 'rxcomp';\r\n\r\nexport default class AppComponent extends Component {\r\n\tonInit() {\r\n\t\tconst { node } = getContext(this);\r\n\t\tnode.classList.add('init');\r\n\t}\r\n\tstatic meta: IFactoryMeta = {\r\n\t\tselector: '[app-component]',\r\n\t};\r\n}\r\n","\r\nimport { HttpEvent, HttpHandler, HttpRequest, HttpResponse, IHttpInterceptor } from 'rxcomp-http';\r\nimport { EMPTY, Observable } from 'rxjs';\r\nimport { tap } from 'rxjs/operators';\r\n\r\nconst cancelRequest: boolean = false;\r\nexport class CustomRequestInterceptor implements IHttpInterceptor {\r\n\tintercept(request: HttpRequest<any>, next: HttpHandler): Observable<HttpEvent<any>> {\r\n\t\tif (cancelRequest) {\r\n\t\t\treturn EMPTY;\r\n\t\t}\r\n\t\treturn next.handle(request);\r\n\t}\r\n}\r\nexport class CustomResponseInterceptor implements IHttpInterceptor {\r\n\tintercept(request: HttpRequest<any>, next: HttpHandler): Observable<HttpEvent<any>> {\r\n\t\treturn next.handle(request).pipe(\r\n\t\t\ttap(event => {\r\n\t\t\t\tif (event instanceof HttpResponse) {\r\n\t\t\t\t\tconsole.log('CustomResponseInterceptor.status', event.status);\r\n\t\t\t\t\tconsole.log('CustomResponseInterceptor.filter', request.params.get('filter'));\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t);\r\n\t}\r\n}\r\nexport class CustomRequestCloneInterceptor implements IHttpInterceptor {\r\n\tintercept(request: HttpRequest<any>, next: HttpHandler): Observable<HttpEvent<any>> {\r\n\t\tconst clonedRequest = request.clone({\r\n\t\t\turl: request.url,\r\n\t\t});\r\n\t\treturn next.handle(clonedRequest);\r\n\t}\r\n}\r\n","import { Component, IFactoryMeta } from 'rxcomp';\r\nimport { RouterOutletStructure } from 'rxcomp-router';\r\n\r\nexport default class NotFoundComponent extends Component {\r\n\thost!: RouterOutletStructure;\r\n\tonInit() {\r\n\t\t// console.log('NotFoundComponent.onInit');\r\n\t}\r\n\tstatic meta: IFactoryMeta = {\r\n\t\tselector: '[not-found-component]',\r\n\t\ttemplate: /* html */`\r\n        <div class=\"page-not-found\">\r\n            <div class=\"title\">Not Found</div>\r\n        </div>\r\n        `,\r\n\t};\r\n}\r\n","import 'gsap';\nimport { IElement, IFactoryMeta } from 'rxcomp';\nimport { RouterKeyValue, transition$, View } from 'rxcomp-router';\nimport { combineLatest } from 'rxjs';\nimport { takeUntil } from 'rxjs/operators';\n\nexport default class TodolistItemComponent extends View {\n\tonInit() {\n\t\t// console.log('TodolistItemComponent.onInit', this.route);\n\t\tcombineLatest([this.route.data$, this.route.params$]).pipe(\n\t\t\ttakeUntil(this.unsubscribe$)\n\t\t).subscribe((datas: RouterKeyValue[]) => {\n\t\t\tthis.title = datas[0].title;\n\t\t\tthis.itemId = datas[1].itemId;\n\t\t\t// this.pushChanges(); // !!! not needed;\n\t\t\t// console.log('TodolistItemComponent', datas);\n\t\t});\n\t}\n\tonEnter(node: IElement) {\n\t\treturn transition$(complete => {\n\t\t\tgsap.set(node, { opacity: 0 });\n\t\t\tgsap.to(node, {\n\t\t\t\topacity: 1,\n\t\t\t\tduration: 0.6,\n\t\t\t\tease: Power3.easeOut,\n\t\t\t\tonComplete: () => {\n\t\t\t\t\tcomplete(true);\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t}\n\tonExit(node: IElement) {\n\t\treturn transition$(complete => {\n\t\t\tgsap.set(node, { opacity: 1 });\n\t\t\tgsap.to(node, {\n\t\t\t\topacity: 0,\n\t\t\t\tduration: 0.6,\n\t\t\t\tease: Power3.easeOut,\n\t\t\t\tonComplete: () => {\n\t\t\t\t\tcomplete(true);\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t}\n\tstatic meta: IFactoryMeta = {\n\t\tselector: '[detail-component]',\n\t\ttemplate: /* html */`\n        <div class=\"page-detail\">\n            <div class=\"title\">Todolist Item {{itemId}}</div>\n        </div>\n        `,\n\t};\n}\n","import { IServerVars } from \"../../../src/rxcomp-server\";\r\n\r\nexport const Vars: IServerVars = {\r\n\tname: 'rxcomp-server',\r\n\thost: '',\r\n\tresource: '/',\r\n\tapi: '/api',\r\n\tstatic: false,\r\n\tdevelopment: false,\r\n\tproduction: true,\r\n};\r\n/*\r\nexport const STATIC = window.location.port === '40333' || window.location.host === 'actarian.github.io';\r\nexport const DEVELOPMENT = ['localhost', '127.0.0.1', '0.0.0.0'].indexOf(window.location.host.split(':')[0]) !== -1;\r\nexport const PRODUCTION = !DEVELOPMENT;\r\nexport const ENV = {\r\n\tNAME: 'ws-events',\r\n\tSTATIC,\r\n\tDEVELOPMENT,\r\n\tPRODUCTION,\r\n\tRESOURCE: '/Modules/Events/Client/docs/',\r\n\tSTATIC_RESOURCE: './',\r\n\tAPI: '/api',\r\n\tSTATIC_API: (DEVELOPMENT && !STATIC) ? '/Modules/Events/Client/docs/api' : './api',\r\n};\r\nexport function getApiUrl(url, useStatic) {\r\n\tconst base = (useStatic || STATIC) ? ENV.STATIC_API : ENV.API;\r\n\tconst json = (useStatic || STATIC) ? '.json' : '';\r\n\treturn `${base}${url}${json}`;\r\n}\r\nexport function getResourceRoot() {\r\n\treturn STATIC ? ENV.STATIC_RESOURCE : ENV.RESOURCE;\r\n}\r\nexport function getSlug(url) {\r\n\tif (!url) {\r\n\t\treturn url;\r\n\t}\r\n\tif (url.indexOf(`/${ENV.NAME}`) !== 0) {\r\n\t\treturn url;\r\n\t}\r\n\tif (STATIC) {\r\n\t\t// console.log(url);\r\n\t\treturn url;\r\n\t}\r\n\turl = url.replace(`/${ENV.NAME}`, '');\r\n\turl = url.replace('.html', '');\r\n\treturn `/it/it${url}`;\r\n}\r\n*/\r\n","import { Component, errors$, IFactoryMeta } from 'rxcomp';\nimport { HttpService } from 'rxcomp-http';\nimport { RouterKeyValue, RouterOutletStructure } from 'rxcomp-router';\nimport { first, takeUntil } from 'rxjs/operators';\nimport { IResponseData, ITodoItem } from '../todo/todo';\nimport { Vars } from '../vars';\n\nexport default class TodolistComponent extends Component {\n\thost!: RouterOutletStructure;\n\titems: ITodoItem[] = [];\n\terror: any = null;\n\tonInit() {\n\t\tconst mode: number = 3;\n\t\tconst payload = { query: `{ getTodos { id, title, completed } }` };\n\t\tconst methodUrl: string = `${Vars.host}${Vars.api}`;\n\t\t// console.log('TodolistComponent.onInit', this);\n\t\tif (mode === 1) {\n\t\t\tHttpService.post$<IResponseData>(methodUrl, payload, {\n\t\t\t\tparams: { query: `{ getTodos { id, title, completed } }` },\n\t\t\t\treportProgress: false\n\t\t\t}).pipe(\n\t\t\t\tfirst(),\n\t\t\t).subscribe((response: IResponseData) => {\n\t\t\t\tthis.items = response.data.getTodos;\n\t\t\t\tthis.pushChanges();\n\t\t\t\t// console.log('TodolistComponent.getTodos', this.items);\n\t\t\t}, console.warn);\n\t\t} else if (mode === 2) {\n\t\t\t// console.log('TodolistComponent.methodUrl', methodUrl);\n\t\t\tHttpService.post$<IResponseData>(methodUrl, payload).pipe(\n\t\t\t\tfirst(),\n\t\t\t).subscribe((response: IResponseData) => {\n\t\t\t\tthis.items = response.data.getTodos;\n\t\t\t\tthis.pushChanges();\n\t\t\t\t// console.log('TodolistComponent.getTodos', this.items);\n\t\t\t}, console.warn);\n\t\t} else {\n\t\t\tHttpService.get$<IResponseData>(`${Vars.host}/assets/data/todos.json`).pipe(\n\t\t\t\tfirst(),\n\t\t\t).subscribe((response: IResponseData) => {\n\t\t\t\tthis.items = response.data.getTodos;\n\t\t\t\tthis.pushChanges();\n\t\t\t\t// console.log('TodolistComponent.getTodos', this.items);\n\t\t\t}, console.warn);\n\t\t}\n\t\tconst route = this.host.route;\n\t\tif (route) {\n\t\t\troute.data$.pipe(\n\t\t\t\ttakeUntil(this.unsubscribe$)\n\t\t\t).subscribe((data: RouterKeyValue) => {\n\t\t\t\tthis.title = data.title;\n\t\t\t\t// this.pushChanges(); // !! not needed;\n\t\t\t\t// console.log('TodolistComponent', data);\n\t\t\t});\n\t\t}\n\t\t// generic errors\n\t\terrors$.pipe(\n\t\t\ttakeUntil(this.unsubscribe$),\n\t\t).subscribe(error => {\n\t\t\tthis.error = error;\n\t\t\tthis.pushChanges();\n\t\t});\n\t}\n\tonClick(item: { title: string, completed: boolean }) {\n\t\titem.completed = !item.completed;\n\t\tthis.pushChanges();\n\t}\n\tstatic meta: IFactoryMeta = {\n\t\tselector: '[todolist-component]',\n\t\thosts: { host: RouterOutletStructure },\n\t\ttemplate: /* html */`\n        <div class=\"page-todolist\">\n\t\t\t<div class=\"title\">{{title}}</div>\n\t\t\t<!-- {{items | json}} -->\n\t\t\t<ul class=\"list\">\n\t\t\t\t<li class=\"list__item\" *for=\"let item of items\" [class]=\"{ completed: item.completed }\" [style]=\"{ 'border-color': item.completed ? 'red' : 'black' }\">\n\t\t\t\t\t<div class=\"title\" [routerLink]=\"['/todolist', item.id]\" [innerHTML]=\"item.title\"></div>\n\t\t\t\t\t<div class=\"completed\" (click)=\"onClick(item)\" [innerHTML]=\"item.completed\"></div>\n\t\t\t\t\t<!-- !!! debug -->\n\t\t\t\t\t<!-- <div class=\"completed\" (click)=\"onClick(item)\">{{item.completed}}</div> -->\n\t\t\t\t</li>\n\t\t\t</ul>\n\t\t\t<div *if=\"error\">\n\t\t\t\t<span>error => {{error | json}}</span>\n\t\t\t</div>\n        </div>\n        `,\n\t};\n}\n","import { CoreModule, IModuleMeta, Module } from 'rxcomp';\r\nimport { HttpModule } from 'rxcomp-http';\r\nimport { RouterModule } from 'rxcomp-router';\r\nimport AppComponent from './app.component';\r\nimport { CustomRequestInterceptor, CustomResponseInterceptor } from './custom-interceptor/custom.interceptor';\r\nimport NotFoundComponent from './pages/not-found.component';\r\nimport TodolistItemComponent from './pages/todolist-item.component';\r\nimport TodolistComponent from './pages/todolist.component';\r\n\r\nexport default class AppModule extends Module {\r\n\tstatic meta: IModuleMeta = {\r\n\t\timports: [\r\n\t\t\tCoreModule,\r\n\t\t\tHttpModule.useInterceptors([CustomRequestInterceptor, CustomResponseInterceptor]),\r\n\t\t\tRouterModule.forRoot([\r\n\t\t\t\t{ path: '', redirectTo: '/todolist', pathMatch: 'full' },\r\n\t\t\t\t{ path: 'todolist', component: TodolistComponent, data: { title: 'Todolist' } },\r\n\t\t\t\t{ path: 'todolist/:itemId', component: TodolistItemComponent, data: { title: 'Todolist Item' } },\r\n\t\t\t\t{ path: '**', component: NotFoundComponent },\r\n\t\t\t]), // .useStrategy(LocationStrategyHash),\r\n\t\t],\r\n\t\tdeclarations: [\r\n\t\t\tTodolistComponent,\r\n\t\t\tTodolistItemComponent,\r\n\t\t\tNotFoundComponent\r\n\t\t],\r\n\t\tbootstrap: AppComponent,\r\n\t};\r\n}\r\n","// import fetch from 'cross-fetch';\nimport 'cross-fetch/polyfill';\nimport { HttpService } from 'rxcomp-http';\nimport { Observable } from 'rxjs';\nimport { filter, first, map, switchMap } from 'rxjs/operators';\nimport { Server, ServerRequest, ServerResponse } from '../../../src/rxcomp-server';\nimport AppModule from './app.module';\nimport { Vars } from './vars';\n\nexport function renderRequest$(request: ServerRequest): Observable<ServerResponse> {\n\tVars.host = request.vars.host;\n\t// console.log('renderRequest$', request, Vars);\n\treturn Server.bootstrap$(AppModule, request).pipe(\n\t\tswitchMap((response: ServerResponse) => {\n\t\t\treturn HttpService.pendingRequests$.pipe(\n\t\t\t\tfilter(count => count === 0),\n\t\t\t\tmap(() => {\n\t\t\t\t\tresponse.body = response.serialize();\n\t\t\t\t\treturn response;\n\t\t\t\t}),\n\t\t\t\tfirst(),\n\t\t\t);\n\t\t}),\n\t);\n}\n"]}