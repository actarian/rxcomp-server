{"version":3,"sources":["www/browser/src/main.server.ts","../../../node_modules/node-fetch/lib/index.mjs","../../../node_modules/cross-fetch/dist/node-ponyfill.js","../../../node_modules/cross-fetch/dist/node-polyfill.js","../../../rxcomp-http/node_modules/tslib/tslib.es6.js","../../../rxcomp-http/dist/cjs/http/http-event.js","../../../rxcomp-http/dist/cjs/http/http-headers.js","../../../rxcomp-http/dist/cjs/http/http-error-response.js","../../../rxcomp-http/dist/cjs/http/http-response.js","../../../rxcomp-http/dist/cjs/http/http-fetch.handler.js","../../../rxcomp-http/dist/cjs/http/http-xhr.handler.js","../../../rxcomp-http/dist/cjs/http/http-interceptor.js","../../../rxcomp-http/dist/cjs/http.module.js","../../../rxcomp-http/dist/cjs/http/http-handler.js","../../../rxcomp-http/dist/cjs/http/http-params.js","../../../rxcomp-http/dist/cjs/http/http-request.js","../../../rxcomp-http/dist/cjs/http/http.service.js","../../../rxcomp-http/dist/cjs/rxcomp-http.js","../../../src/cache/cache.service.ts","../../../src/nodes/nodes.ts","../../../src/location/location.ts","../../../src/history/history.ts","../../../src/platform/server.ts","../../../browser/src/vars.ts","../../../browser/src/app.component.ts","../../../browser/src/custom-interceptor/custom.interceptor.ts","../../../browser/src/app.module.ts","../../../browser/src/main.server.ts"],"names":["g","f","exports","module","require","define","amd","globalThis","self","main","Stream","http","Url","https","zlib","rxjs","operators","rxcomp","htmlparser2","this","Object","prototype","hasOwnProperty","call","operators__default","rxcomp__default","rxjs__default","commonjsGlobal","window","global","createCommonjsModule","fn","basedir","path","base","Error","commonjsRequire","Readable","BUFFER","Symbol","TYPE","Blob","[object Object]","blobParts","arguments","options","buffers","size","a","length","Number","i","element","buffer","Buffer","ArrayBuffer","isView","from","byteOffset","byteLength","String","push","concat","type","undefined","toLowerCase","test","Promise","resolve","toString","buf","ab","slice","readable","_read","start","end","relativeStart","relativeEnd","Math","max","min","span","slicedBuffer","blob","FetchError","message","systemError","code","errno","captureStackTrace","constructor","convert","defineProperties","enumerable","defineProperty","toStringTag","value","writable","configurable","create","name","e","INTERNALS","PassThrough","Body","body","_this","_ref","_ref$size","_ref$timeout","timeout","isURLSearchParams","isBlob","isBuffer","disturbed","error","on","err","url","consumeBody","_this4","reject","TypeError","alloc","stream","accum","accumBytes","abort","resTimeout","setTimeout","chunk","clearTimeout","obj","append","delete","get","getAll","has","set","sort","arrayBuffer","clone","instance","p1","p2","bodyUsed","getBoundary","pipe","extractContentType","getTotalBytes","getLengthSync","_lengthRetrievers","hasKnownLength","then","ct","headers","assign","_this2","JSON","parse","_this3","res","str","charset","exec","pop","convertBody","json","text","mixIn","proto","getOwnPropertyNames","desc","getOwnPropertyDescriptor","invalidTokenRegex","invalidHeaderCharRegex","validateName","validateValue","find","map","key","MAP","Headers","init","rawHeaders","raw","headerNames","keys","headerName","method","iterator","pairs","pair","Array","join","callback","thisArg","getHeaders","_pairs$i","createHeadersIterator","kind","k","entries","forEach","values","INTERNAL","target","HeadersIteratorPrototype","index","setPrototypeOf","getPrototypeOf","_INTERNAL","done","exportNodeCompatibleHeaders","__proto__","hostHeaderKey","INTERNALS$1","STATUS_CODES","Response","opts","status","contentType","statusText","counter","ok","redirected","INTERNALS$2","parse_url","format_url","format","streamDestructionSupported","isRequest","input","Request","parsedURL","href","toUpperCase","inputBody","signal","isAbortSignal","redirect","follow","compress","agent","AbortError","PassThrough$1","resolve_url","fetch","request","protocol","hostname","contentLengthValue","totalBytes","getNodeRequestOptions","send","response","destroy","emit","aborted","abortAndFinalize","finalize","req","reqTimeout","removeEventListener","addEventListener","once","socket","isArray","val","createHeadersLenient","isRedirect","statusCode","location","locationURL","requestOpts","response_options","statusMessage","codings","zlibOptions","flush","Z_SYNC_FLUSH","finishFlush","createGunzip","createBrotliDecompress","createInflate","createInflateRaw","dest","write","writeToStream","n","nodeFetch","freeze","default","fetch$1","Request$1","nodePonyfill","realFetch","fetchNode","bind","polyfill","extendStatics","d","b","p","__assign","t","s","apply","__createBinding","o","m","k2","__values","next","__read","r","ar","__await","v","__setModuleDefault","tslib_es6","__extends","__","_assign","__rest","indexOf","getOwnPropertySymbols","propertyIsEnumerable","__decorate","decorators","c","Reflect","decorate","__param","paramIndex","decorator","__metadata","metadataKey","metadataValue","metadata","__awaiter","_arguments","P","generator","fulfilled","step","rejected","result","__generator","y","_","label","sent","trys","ops","verb","throw","return","op","__exportStar","__spread","__spreadArrays","il","j","jl","__asyncGenerator","asyncIterator","q","resume","fulfill","settle","shift","__asyncDelegator","__asyncValues","__makeTemplateObject","cooked","__importStar","mod","__esModule","__importDefault","__classPrivateFieldGet","receiver","privateMap","__classPrivateFieldSet","httpEvent","HttpEventType","httpHeaders","HttpHeaders","_a","headers_","Map","split","line","trim","clone_","serialize","httpErrorResponse","HttpErrorResponse","_super","http_event_1","ResponseError","http_headers_1","tslib_1","httpResponse","HttpHeaderResponse","ResponseHeader","HttpResponse","HttpResponseBase","defaultStatus","defaultStatusText","httpFetch_handler","HttpFetchHandler","response_","handle","requestInfo","urlWithParams","requestInit","toInitRequest","stateKey","rxcomp_1","TransferService","makeKey","transferKey","console","log","isPlatformBrowser","hydrate","cached","remove","rxjs_1","of","getProgress","getResponse","operators_1","tap","isPlatformServer","catchError","errorResponse","http_error_response_1","nextError$","clonedBody","reportProgress","reader_1","getReader","contentLength_1","progress","percent","current","total","read","onProgress","receivedLength","closed","http_response_1","responseType","catch","getResponseType","getReadableStream","reader","ReadableStream","controller","close","enqueue","httpXhr_handler","XSSI_PREFIX","HttpXhrHandler","Observable","observer","xhr","XMLHttpRequest","complete","open","withCredentials","detectedType","detectContentTypeHeader","setRequestHeader","body_1","serializeBody","headerResponse_1","partialFromXhr_1","getAllResponseHeaders","responseURL","getResponseHeader","getResponseUrl_","onLoad_1","responseText","originalBody","replace","onError_1","sentHeaders_1","onDownProgress_1","event","progressEvent","DownloadProgress","loaded","lengthComputable","partialText","onUpProgress_1","UploadProgress","upload","Sent","readyState","DONE","httpInterceptor","HttpInterceptorHandler","interceptor","intercept","NoopInterceptor","http_fetch_handler_1","http_xhr_handler_1","HttpInterceptingHandler","chain","interceptors","HttpInterceptors","reduceRight","fetchHandler","handler","http_module","factories","pipes","HttpModule","useInterceptors","interceptorFactories","x","http_interceptor_1","meta","declarations","Module","httpHandler","HttpHandler","httpParams","HttpUrlEncodingCodec","encodeKey","encodeParam_","encodeValue","decodeKey","decodeURIComponent","decodeValue","HttpParams","encoder","params_","params","queryString","keyValue","parseRawParams_","filter","encodeURIComponent","httpRequest","HttpRequest","third","fourth","observe","isStaticFile","methodHasBody_","http_params_1","sep","pathname","e_1","host","port","search","hash","regExp","matches","matchAll","matches_1","matches_1_1","match","e_1_1","getPath_","flatMap_","substr","isArrayBuffer_","isBlob_","isFormData_","stringify","mode","credentials","cache","toFetchRequest__","FormData","http_service","HttpService","incrementPendingRequest","pendingRequests$","getValue","decrementPendingRequest","request$","first","http_request_1","events$","concatMap","throwError","getError","delete$","get$","head$","jsonp$","callbackParam","options$","patch$","optionsWithBody_","post$","put$","BehaviorSubject","rxcompHttp","http_module_1","http_handler_1","interceptingHandler","jsonpCallbackContext","xhrHandler","http_service_1","_defineProperties","props","descriptor","_createClass","Constructor","protoProps","staticProps","_inheritsLoose","subClass","superClass","_getPrototypeOf","_setPrototypeOf","_isNativeReflectConstruct","construct","sham","Proxy","Date","_construct","Parent","args","Class","Function","_wrapNativeSuper","_cache","Wrapper","_assertThisInitialized","ReferenceError","_arrayLikeToArray","arr","len","arr2","_createForOfIteratorHelperLoose","allowArrayLike","it","minLen","_unsupportedIterableToArray","CacheMode","CacheControlType","fs","CacheItem","date","maxAge","cacheControl","Public","NoStore","getTime","now","CacheService","File","hasFile","Memory","cache_","cacheItem","_cacheItem","readFile","expired","unlinkFile","data","writeFile","serialized","getPath","substring","group","folder","existsSync","readFileSync","writeFileSync","unlinkSync","readFile$","service","writeFile$","item","clear","RxNodeType","SelectorType","RxDOMStringList","_Array","_proto","contains","string","RxLocation","href_","ancestorOrigins_","_proto2","reload","_step","_iterator","location_","RxHistory","currentIndex_","history_","scrollRestoration","back","forward","go","delta","pushState","title","replaceState","splice","RxNode","parentNode","nodeValue","nodeType","cloneNode","deep","RxStyle","node","getPropertyPriority","getPropertyValue","setProperty","important","serialize_","removeProperty","attributes","style","_this$node$attributes","RxClassList","_proto3","add","_len","names","_this5","_len2","toggle","force","oldClass","newClass","class","_this$node$attributes2","RxElement","_RxNode","nodeName","_this6","ELEMENT_NODE","classList","childNodes","_proto4","_this7","_len3","nodesOrDOMStrings","nodeOrDomString","RxText","prepend","_this8","_len4","unshift","replaceChildren","_this9","_len5","nodes","querySelectorAll","selector","queries","getQueries","querySelector","hasAttribute","attribute","getAttribute","setAttribute","removeAttribute","replaceChild","newChild","oldChild","removeChild","child","insertBefore","newNode","referenceNode","addListener","eventName","removeListener","serializeAttributes","_this10","children","count","isRxElement","TEXT_NODE","html","isRxText","innerText","_this11","_RxNode2","_this12","RxComment","_RxNode4","_this14","COMMENT_NODE","RxProcessingInstruction","_RxNode5","_this15","PROCESSING_INSTRUCTION_NODE","RxDocumentType","_RxNode6","_this16","DOCUMENT_TYPE_NODE","RxDocumentFragment","_RxElement","_this17","DOCUMENT_FRAGMENT_NODE","RxDocument","_RxElement2","_this18","DOCUMENT_NODE","_proto10","createAttribute","createAttributeNS","createCDATASection","createComment","createDocumentFragment","createElement","createElementNS","createEvent","createNodeIterator","createProcessingInstruction","createRange","createTextNode","createTouchList","createTreeWalker","isRxDocumentType","firstElementChild","doc","parser","Parser","onopentag","onclosetag","ontext","textNode","onprocessinginstruction","oncomment","oncommentend","oncdatastart","oncdataend","onerror","decodeEntities","lowerCaseTags","_step2","selectors","_iterator2","Id","negate","Attribute","TagName","inner","matchSelectors","reduce","id","matchSelector","query","_step4","_iterator4","source","nodeElement","nodeDocumentFragment","isRxComment","isRxDocument","documentElement","ServerRequest","vars","template","cacheMode","root","ServerResponse","ServerErrorResponse","Server","_Platform","bootstrap","moduleFactory","ModuleError","document","resolveGlobals","resolveMeta","_node$parentNode","nodeInnerHTML","rxcomp_hydrate_","innerHTML","scriptNode","scriptText","imports","instances","compile","pushChanges","history","origin","documentOrHtml","Platform","template$","src","iRequest","renderRequest$","switchMap","subscribe","success","Vars","resource","api","static","development","production","AppComponent","_Component","items","onInit","methodUrl","getTodos","errors$","takeUntil","unsubscribe$","onClick","completed","Component","CustomInterceptor","clonedRequest","AppModule","_Module","CoreModule","bootstrap$"],"mappings":"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","file":"www\\dist\\development\\server\\main.min.js","sourcesContent":[null,"import Stream from 'stream';\nimport http from 'http';\nimport Url from 'url';\nimport https from 'https';\nimport zlib from 'zlib';\n\n// Based on https://github.com/tmpvar/jsdom/blob/aa85b2abf07766ff7bf5c1f6daafb3726f2f2db5/lib/jsdom/living/blob.js\n\n// fix for \"Readable\" isn't a named export issue\nconst Readable = Stream.Readable;\n\nconst BUFFER = Symbol('buffer');\nconst TYPE = Symbol('type');\n\nclass Blob {\n\tconstructor() {\n\t\tthis[TYPE] = '';\n\n\t\tconst blobParts = arguments[0];\n\t\tconst options = arguments[1];\n\n\t\tconst buffers = [];\n\t\tlet size = 0;\n\n\t\tif (blobParts) {\n\t\t\tconst a = blobParts;\n\t\t\tconst length = Number(a.length);\n\t\t\tfor (let i = 0; i < length; i++) {\n\t\t\t\tconst element = a[i];\n\t\t\t\tlet buffer;\n\t\t\t\tif (element instanceof Buffer) {\n\t\t\t\t\tbuffer = element;\n\t\t\t\t} else if (ArrayBuffer.isView(element)) {\n\t\t\t\t\tbuffer = Buffer.from(element.buffer, element.byteOffset, element.byteLength);\n\t\t\t\t} else if (element instanceof ArrayBuffer) {\n\t\t\t\t\tbuffer = Buffer.from(element);\n\t\t\t\t} else if (element instanceof Blob) {\n\t\t\t\t\tbuffer = element[BUFFER];\n\t\t\t\t} else {\n\t\t\t\t\tbuffer = Buffer.from(typeof element === 'string' ? element : String(element));\n\t\t\t\t}\n\t\t\t\tsize += buffer.length;\n\t\t\t\tbuffers.push(buffer);\n\t\t\t}\n\t\t}\n\n\t\tthis[BUFFER] = Buffer.concat(buffers);\n\n\t\tlet type = options && options.type !== undefined && String(options.type).toLowerCase();\n\t\tif (type && !/[^\\u0020-\\u007E]/.test(type)) {\n\t\t\tthis[TYPE] = type;\n\t\t}\n\t}\n\tget size() {\n\t\treturn this[BUFFER].length;\n\t}\n\tget type() {\n\t\treturn this[TYPE];\n\t}\n\ttext() {\n\t\treturn Promise.resolve(this[BUFFER].toString());\n\t}\n\tarrayBuffer() {\n\t\tconst buf = this[BUFFER];\n\t\tconst ab = buf.buffer.slice(buf.byteOffset, buf.byteOffset + buf.byteLength);\n\t\treturn Promise.resolve(ab);\n\t}\n\tstream() {\n\t\tconst readable = new Readable();\n\t\treadable._read = function () {};\n\t\treadable.push(this[BUFFER]);\n\t\treadable.push(null);\n\t\treturn readable;\n\t}\n\ttoString() {\n\t\treturn '[object Blob]';\n\t}\n\tslice() {\n\t\tconst size = this.size;\n\n\t\tconst start = arguments[0];\n\t\tconst end = arguments[1];\n\t\tlet relativeStart, relativeEnd;\n\t\tif (start === undefined) {\n\t\t\trelativeStart = 0;\n\t\t} else if (start < 0) {\n\t\t\trelativeStart = Math.max(size + start, 0);\n\t\t} else {\n\t\t\trelativeStart = Math.min(start, size);\n\t\t}\n\t\tif (end === undefined) {\n\t\t\trelativeEnd = size;\n\t\t} else if (end < 0) {\n\t\t\trelativeEnd = Math.max(size + end, 0);\n\t\t} else {\n\t\t\trelativeEnd = Math.min(end, size);\n\t\t}\n\t\tconst span = Math.max(relativeEnd - relativeStart, 0);\n\n\t\tconst buffer = this[BUFFER];\n\t\tconst slicedBuffer = buffer.slice(relativeStart, relativeStart + span);\n\t\tconst blob = new Blob([], { type: arguments[2] });\n\t\tblob[BUFFER] = slicedBuffer;\n\t\treturn blob;\n\t}\n}\n\nObject.defineProperties(Blob.prototype, {\n\tsize: { enumerable: true },\n\ttype: { enumerable: true },\n\tslice: { enumerable: true }\n});\n\nObject.defineProperty(Blob.prototype, Symbol.toStringTag, {\n\tvalue: 'Blob',\n\twritable: false,\n\tenumerable: false,\n\tconfigurable: true\n});\n\n/**\n * fetch-error.js\n *\n * FetchError interface for operational errors\n */\n\n/**\n * Create FetchError instance\n *\n * @param   String      message      Error message for human\n * @param   String      type         Error type for machine\n * @param   String      systemError  For Node.js system error\n * @return  FetchError\n */\nfunction FetchError(message, type, systemError) {\n  Error.call(this, message);\n\n  this.message = message;\n  this.type = type;\n\n  // when err.type is `system`, err.code contains system error code\n  if (systemError) {\n    this.code = this.errno = systemError.code;\n  }\n\n  // hide custom error implementation details from end-users\n  Error.captureStackTrace(this, this.constructor);\n}\n\nFetchError.prototype = Object.create(Error.prototype);\nFetchError.prototype.constructor = FetchError;\nFetchError.prototype.name = 'FetchError';\n\nlet convert;\ntry {\n\tconvert = require('encoding').convert;\n} catch (e) {}\n\nconst INTERNALS = Symbol('Body internals');\n\n// fix an issue where \"PassThrough\" isn't a named export for node <10\nconst PassThrough = Stream.PassThrough;\n\n/**\n * Body mixin\n *\n * Ref: https://fetch.spec.whatwg.org/#body\n *\n * @param   Stream  body  Readable stream\n * @param   Object  opts  Response options\n * @return  Void\n */\nfunction Body(body) {\n\tvar _this = this;\n\n\tvar _ref = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {},\n\t    _ref$size = _ref.size;\n\n\tlet size = _ref$size === undefined ? 0 : _ref$size;\n\tvar _ref$timeout = _ref.timeout;\n\tlet timeout = _ref$timeout === undefined ? 0 : _ref$timeout;\n\n\tif (body == null) {\n\t\t// body is undefined or null\n\t\tbody = null;\n\t} else if (isURLSearchParams(body)) {\n\t\t// body is a URLSearchParams\n\t\tbody = Buffer.from(body.toString());\n\t} else if (isBlob(body)) ; else if (Buffer.isBuffer(body)) ; else if (Object.prototype.toString.call(body) === '[object ArrayBuffer]') {\n\t\t// body is ArrayBuffer\n\t\tbody = Buffer.from(body);\n\t} else if (ArrayBuffer.isView(body)) {\n\t\t// body is ArrayBufferView\n\t\tbody = Buffer.from(body.buffer, body.byteOffset, body.byteLength);\n\t} else if (body instanceof Stream) ; else {\n\t\t// none of the above\n\t\t// coerce to string then buffer\n\t\tbody = Buffer.from(String(body));\n\t}\n\tthis[INTERNALS] = {\n\t\tbody,\n\t\tdisturbed: false,\n\t\terror: null\n\t};\n\tthis.size = size;\n\tthis.timeout = timeout;\n\n\tif (body instanceof Stream) {\n\t\tbody.on('error', function (err) {\n\t\t\tconst error = err.name === 'AbortError' ? err : new FetchError(`Invalid response body while trying to fetch ${_this.url}: ${err.message}`, 'system', err);\n\t\t\t_this[INTERNALS].error = error;\n\t\t});\n\t}\n}\n\nBody.prototype = {\n\tget body() {\n\t\treturn this[INTERNALS].body;\n\t},\n\n\tget bodyUsed() {\n\t\treturn this[INTERNALS].disturbed;\n\t},\n\n\t/**\n  * Decode response as ArrayBuffer\n  *\n  * @return  Promise\n  */\n\tarrayBuffer() {\n\t\treturn consumeBody.call(this).then(function (buf) {\n\t\t\treturn buf.buffer.slice(buf.byteOffset, buf.byteOffset + buf.byteLength);\n\t\t});\n\t},\n\n\t/**\n  * Return raw response as Blob\n  *\n  * @return Promise\n  */\n\tblob() {\n\t\tlet ct = this.headers && this.headers.get('content-type') || '';\n\t\treturn consumeBody.call(this).then(function (buf) {\n\t\t\treturn Object.assign(\n\t\t\t// Prevent copying\n\t\t\tnew Blob([], {\n\t\t\t\ttype: ct.toLowerCase()\n\t\t\t}), {\n\t\t\t\t[BUFFER]: buf\n\t\t\t});\n\t\t});\n\t},\n\n\t/**\n  * Decode response as json\n  *\n  * @return  Promise\n  */\n\tjson() {\n\t\tvar _this2 = this;\n\n\t\treturn consumeBody.call(this).then(function (buffer) {\n\t\t\ttry {\n\t\t\t\treturn JSON.parse(buffer.toString());\n\t\t\t} catch (err) {\n\t\t\t\treturn Body.Promise.reject(new FetchError(`invalid json response body at ${_this2.url} reason: ${err.message}`, 'invalid-json'));\n\t\t\t}\n\t\t});\n\t},\n\n\t/**\n  * Decode response as text\n  *\n  * @return  Promise\n  */\n\ttext() {\n\t\treturn consumeBody.call(this).then(function (buffer) {\n\t\t\treturn buffer.toString();\n\t\t});\n\t},\n\n\t/**\n  * Decode response as buffer (non-spec api)\n  *\n  * @return  Promise\n  */\n\tbuffer() {\n\t\treturn consumeBody.call(this);\n\t},\n\n\t/**\n  * Decode response as text, while automatically detecting the encoding and\n  * trying to decode to UTF-8 (non-spec api)\n  *\n  * @return  Promise\n  */\n\ttextConverted() {\n\t\tvar _this3 = this;\n\n\t\treturn consumeBody.call(this).then(function (buffer) {\n\t\t\treturn convertBody(buffer, _this3.headers);\n\t\t});\n\t}\n};\n\n// In browsers, all properties are enumerable.\nObject.defineProperties(Body.prototype, {\n\tbody: { enumerable: true },\n\tbodyUsed: { enumerable: true },\n\tarrayBuffer: { enumerable: true },\n\tblob: { enumerable: true },\n\tjson: { enumerable: true },\n\ttext: { enumerable: true }\n});\n\nBody.mixIn = function (proto) {\n\tfor (const name of Object.getOwnPropertyNames(Body.prototype)) {\n\t\t// istanbul ignore else: future proof\n\t\tif (!(name in proto)) {\n\t\t\tconst desc = Object.getOwnPropertyDescriptor(Body.prototype, name);\n\t\t\tObject.defineProperty(proto, name, desc);\n\t\t}\n\t}\n};\n\n/**\n * Consume and convert an entire Body to a Buffer.\n *\n * Ref: https://fetch.spec.whatwg.org/#concept-body-consume-body\n *\n * @return  Promise\n */\nfunction consumeBody() {\n\tvar _this4 = this;\n\n\tif (this[INTERNALS].disturbed) {\n\t\treturn Body.Promise.reject(new TypeError(`body used already for: ${this.url}`));\n\t}\n\n\tthis[INTERNALS].disturbed = true;\n\n\tif (this[INTERNALS].error) {\n\t\treturn Body.Promise.reject(this[INTERNALS].error);\n\t}\n\n\tlet body = this.body;\n\n\t// body is null\n\tif (body === null) {\n\t\treturn Body.Promise.resolve(Buffer.alloc(0));\n\t}\n\n\t// body is blob\n\tif (isBlob(body)) {\n\t\tbody = body.stream();\n\t}\n\n\t// body is buffer\n\tif (Buffer.isBuffer(body)) {\n\t\treturn Body.Promise.resolve(body);\n\t}\n\n\t// istanbul ignore if: should never happen\n\tif (!(body instanceof Stream)) {\n\t\treturn Body.Promise.resolve(Buffer.alloc(0));\n\t}\n\n\t// body is stream\n\t// get ready to actually consume the body\n\tlet accum = [];\n\tlet accumBytes = 0;\n\tlet abort = false;\n\n\treturn new Body.Promise(function (resolve, reject) {\n\t\tlet resTimeout;\n\n\t\t// allow timeout on slow response body\n\t\tif (_this4.timeout) {\n\t\t\tresTimeout = setTimeout(function () {\n\t\t\t\tabort = true;\n\t\t\t\treject(new FetchError(`Response timeout while trying to fetch ${_this4.url} (over ${_this4.timeout}ms)`, 'body-timeout'));\n\t\t\t}, _this4.timeout);\n\t\t}\n\n\t\t// handle stream errors\n\t\tbody.on('error', function (err) {\n\t\t\tif (err.name === 'AbortError') {\n\t\t\t\t// if the request was aborted, reject with this Error\n\t\t\t\tabort = true;\n\t\t\t\treject(err);\n\t\t\t} else {\n\t\t\t\t// other errors, such as incorrect content-encoding\n\t\t\t\treject(new FetchError(`Invalid response body while trying to fetch ${_this4.url}: ${err.message}`, 'system', err));\n\t\t\t}\n\t\t});\n\n\t\tbody.on('data', function (chunk) {\n\t\t\tif (abort || chunk === null) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (_this4.size && accumBytes + chunk.length > _this4.size) {\n\t\t\t\tabort = true;\n\t\t\t\treject(new FetchError(`content size at ${_this4.url} over limit: ${_this4.size}`, 'max-size'));\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\taccumBytes += chunk.length;\n\t\t\taccum.push(chunk);\n\t\t});\n\n\t\tbody.on('end', function () {\n\t\t\tif (abort) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tclearTimeout(resTimeout);\n\n\t\t\ttry {\n\t\t\t\tresolve(Buffer.concat(accum, accumBytes));\n\t\t\t} catch (err) {\n\t\t\t\t// handle streams that have accumulated too much data (issue #414)\n\t\t\t\treject(new FetchError(`Could not create Buffer from response body for ${_this4.url}: ${err.message}`, 'system', err));\n\t\t\t}\n\t\t});\n\t});\n}\n\n/**\n * Detect buffer encoding and convert to target encoding\n * ref: http://www.w3.org/TR/2011/WD-html5-20110113/parsing.html#determining-the-character-encoding\n *\n * @param   Buffer  buffer    Incoming buffer\n * @param   String  encoding  Target encoding\n * @return  String\n */\nfunction convertBody(buffer, headers) {\n\tif (typeof convert !== 'function') {\n\t\tthrow new Error('The package `encoding` must be installed to use the textConverted() function');\n\t}\n\n\tconst ct = headers.get('content-type');\n\tlet charset = 'utf-8';\n\tlet res, str;\n\n\t// header\n\tif (ct) {\n\t\tres = /charset=([^;]*)/i.exec(ct);\n\t}\n\n\t// no charset in content type, peek at response body for at most 1024 bytes\n\tstr = buffer.slice(0, 1024).toString();\n\n\t// html5\n\tif (!res && str) {\n\t\tres = /<meta.+?charset=(['\"])(.+?)\\1/i.exec(str);\n\t}\n\n\t// html4\n\tif (!res && str) {\n\t\tres = /<meta[\\s]+?http-equiv=(['\"])content-type\\1[\\s]+?content=(['\"])(.+?)\\2/i.exec(str);\n\n\t\tif (res) {\n\t\t\tres = /charset=(.*)/i.exec(res.pop());\n\t\t}\n\t}\n\n\t// xml\n\tif (!res && str) {\n\t\tres = /<\\?xml.+?encoding=(['\"])(.+?)\\1/i.exec(str);\n\t}\n\n\t// found charset\n\tif (res) {\n\t\tcharset = res.pop();\n\n\t\t// prevent decode issues when sites use incorrect encoding\n\t\t// ref: https://hsivonen.fi/encoding-menu/\n\t\tif (charset === 'gb2312' || charset === 'gbk') {\n\t\t\tcharset = 'gb18030';\n\t\t}\n\t}\n\n\t// turn raw buffers into a single utf-8 buffer\n\treturn convert(buffer, 'UTF-8', charset).toString();\n}\n\n/**\n * Detect a URLSearchParams object\n * ref: https://github.com/bitinn/node-fetch/issues/296#issuecomment-307598143\n *\n * @param   Object  obj     Object to detect by type or brand\n * @return  String\n */\nfunction isURLSearchParams(obj) {\n\t// Duck-typing as a necessary condition.\n\tif (typeof obj !== 'object' || typeof obj.append !== 'function' || typeof obj.delete !== 'function' || typeof obj.get !== 'function' || typeof obj.getAll !== 'function' || typeof obj.has !== 'function' || typeof obj.set !== 'function') {\n\t\treturn false;\n\t}\n\n\t// Brand-checking and more duck-typing as optional condition.\n\treturn obj.constructor.name === 'URLSearchParams' || Object.prototype.toString.call(obj) === '[object URLSearchParams]' || typeof obj.sort === 'function';\n}\n\n/**\n * Check if `obj` is a W3C `Blob` object (which `File` inherits from)\n * @param  {*} obj\n * @return {boolean}\n */\nfunction isBlob(obj) {\n\treturn typeof obj === 'object' && typeof obj.arrayBuffer === 'function' && typeof obj.type === 'string' && typeof obj.stream === 'function' && typeof obj.constructor === 'function' && typeof obj.constructor.name === 'string' && /^(Blob|File)$/.test(obj.constructor.name) && /^(Blob|File)$/.test(obj[Symbol.toStringTag]);\n}\n\n/**\n * Clone body given Res/Req instance\n *\n * @param   Mixed  instance  Response or Request instance\n * @return  Mixed\n */\nfunction clone(instance) {\n\tlet p1, p2;\n\tlet body = instance.body;\n\n\t// don't allow cloning a used body\n\tif (instance.bodyUsed) {\n\t\tthrow new Error('cannot clone body after it is used');\n\t}\n\n\t// check that body is a stream and not form-data object\n\t// note: we can't clone the form-data object without having it as a dependency\n\tif (body instanceof Stream && typeof body.getBoundary !== 'function') {\n\t\t// tee instance body\n\t\tp1 = new PassThrough();\n\t\tp2 = new PassThrough();\n\t\tbody.pipe(p1);\n\t\tbody.pipe(p2);\n\t\t// set instance body to teed body and return the other teed body\n\t\tinstance[INTERNALS].body = p1;\n\t\tbody = p2;\n\t}\n\n\treturn body;\n}\n\n/**\n * Performs the operation \"extract a `Content-Type` value from |object|\" as\n * specified in the specification:\n * https://fetch.spec.whatwg.org/#concept-bodyinit-extract\n *\n * This function assumes that instance.body is present.\n *\n * @param   Mixed  instance  Any options.body input\n */\nfunction extractContentType(body) {\n\tif (body === null) {\n\t\t// body is null\n\t\treturn null;\n\t} else if (typeof body === 'string') {\n\t\t// body is string\n\t\treturn 'text/plain;charset=UTF-8';\n\t} else if (isURLSearchParams(body)) {\n\t\t// body is a URLSearchParams\n\t\treturn 'application/x-www-form-urlencoded;charset=UTF-8';\n\t} else if (isBlob(body)) {\n\t\t// body is blob\n\t\treturn body.type || null;\n\t} else if (Buffer.isBuffer(body)) {\n\t\t// body is buffer\n\t\treturn null;\n\t} else if (Object.prototype.toString.call(body) === '[object ArrayBuffer]') {\n\t\t// body is ArrayBuffer\n\t\treturn null;\n\t} else if (ArrayBuffer.isView(body)) {\n\t\t// body is ArrayBufferView\n\t\treturn null;\n\t} else if (typeof body.getBoundary === 'function') {\n\t\t// detect form data input from form-data module\n\t\treturn `multipart/form-data;boundary=${body.getBoundary()}`;\n\t} else if (body instanceof Stream) {\n\t\t// body is stream\n\t\t// can't really do much about this\n\t\treturn null;\n\t} else {\n\t\t// Body constructor defaults other things to string\n\t\treturn 'text/plain;charset=UTF-8';\n\t}\n}\n\n/**\n * The Fetch Standard treats this as if \"total bytes\" is a property on the body.\n * For us, we have to explicitly get it with a function.\n *\n * ref: https://fetch.spec.whatwg.org/#concept-body-total-bytes\n *\n * @param   Body    instance   Instance of Body\n * @return  Number?            Number of bytes, or null if not possible\n */\nfunction getTotalBytes(instance) {\n\tconst body = instance.body;\n\n\n\tif (body === null) {\n\t\t// body is null\n\t\treturn 0;\n\t} else if (isBlob(body)) {\n\t\treturn body.size;\n\t} else if (Buffer.isBuffer(body)) {\n\t\t// body is buffer\n\t\treturn body.length;\n\t} else if (body && typeof body.getLengthSync === 'function') {\n\t\t// detect form data input from form-data module\n\t\tif (body._lengthRetrievers && body._lengthRetrievers.length == 0 || // 1.x\n\t\tbody.hasKnownLength && body.hasKnownLength()) {\n\t\t\t// 2.x\n\t\t\treturn body.getLengthSync();\n\t\t}\n\t\treturn null;\n\t} else {\n\t\t// body is stream\n\t\treturn null;\n\t}\n}\n\n/**\n * Write a Body to a Node.js WritableStream (e.g. http.Request) object.\n *\n * @param   Body    instance   Instance of Body\n * @return  Void\n */\nfunction writeToStream(dest, instance) {\n\tconst body = instance.body;\n\n\n\tif (body === null) {\n\t\t// body is null\n\t\tdest.end();\n\t} else if (isBlob(body)) {\n\t\tbody.stream().pipe(dest);\n\t} else if (Buffer.isBuffer(body)) {\n\t\t// body is buffer\n\t\tdest.write(body);\n\t\tdest.end();\n\t} else {\n\t\t// body is stream\n\t\tbody.pipe(dest);\n\t}\n}\n\n// expose Promise\nBody.Promise = global.Promise;\n\n/**\n * headers.js\n *\n * Headers class offers convenient helpers\n */\n\nconst invalidTokenRegex = /[^\\^_`a-zA-Z\\-0-9!#$%&'*+.|~]/;\nconst invalidHeaderCharRegex = /[^\\t\\x20-\\x7e\\x80-\\xff]/;\n\nfunction validateName(name) {\n\tname = `${name}`;\n\tif (invalidTokenRegex.test(name) || name === '') {\n\t\tthrow new TypeError(`${name} is not a legal HTTP header name`);\n\t}\n}\n\nfunction validateValue(value) {\n\tvalue = `${value}`;\n\tif (invalidHeaderCharRegex.test(value)) {\n\t\tthrow new TypeError(`${value} is not a legal HTTP header value`);\n\t}\n}\n\n/**\n * Find the key in the map object given a header name.\n *\n * Returns undefined if not found.\n *\n * @param   String  name  Header name\n * @return  String|Undefined\n */\nfunction find(map, name) {\n\tname = name.toLowerCase();\n\tfor (const key in map) {\n\t\tif (key.toLowerCase() === name) {\n\t\t\treturn key;\n\t\t}\n\t}\n\treturn undefined;\n}\n\nconst MAP = Symbol('map');\nclass Headers {\n\t/**\n  * Headers class\n  *\n  * @param   Object  headers  Response headers\n  * @return  Void\n  */\n\tconstructor() {\n\t\tlet init = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : undefined;\n\n\t\tthis[MAP] = Object.create(null);\n\n\t\tif (init instanceof Headers) {\n\t\t\tconst rawHeaders = init.raw();\n\t\t\tconst headerNames = Object.keys(rawHeaders);\n\n\t\t\tfor (const headerName of headerNames) {\n\t\t\t\tfor (const value of rawHeaders[headerName]) {\n\t\t\t\t\tthis.append(headerName, value);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn;\n\t\t}\n\n\t\t// We don't worry about converting prop to ByteString here as append()\n\t\t// will handle it.\n\t\tif (init == null) ; else if (typeof init === 'object') {\n\t\t\tconst method = init[Symbol.iterator];\n\t\t\tif (method != null) {\n\t\t\t\tif (typeof method !== 'function') {\n\t\t\t\t\tthrow new TypeError('Header pairs must be iterable');\n\t\t\t\t}\n\n\t\t\t\t// sequence<sequence<ByteString>>\n\t\t\t\t// Note: per spec we have to first exhaust the lists then process them\n\t\t\t\tconst pairs = [];\n\t\t\t\tfor (const pair of init) {\n\t\t\t\t\tif (typeof pair !== 'object' || typeof pair[Symbol.iterator] !== 'function') {\n\t\t\t\t\t\tthrow new TypeError('Each header pair must be iterable');\n\t\t\t\t\t}\n\t\t\t\t\tpairs.push(Array.from(pair));\n\t\t\t\t}\n\n\t\t\t\tfor (const pair of pairs) {\n\t\t\t\t\tif (pair.length !== 2) {\n\t\t\t\t\t\tthrow new TypeError('Each header pair must be a name/value tuple');\n\t\t\t\t\t}\n\t\t\t\t\tthis.append(pair[0], pair[1]);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t// record<ByteString, ByteString>\n\t\t\t\tfor (const key of Object.keys(init)) {\n\t\t\t\t\tconst value = init[key];\n\t\t\t\t\tthis.append(key, value);\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tthrow new TypeError('Provided initializer must be an object');\n\t\t}\n\t}\n\n\t/**\n  * Return combined header value given name\n  *\n  * @param   String  name  Header name\n  * @return  Mixed\n  */\n\tget(name) {\n\t\tname = `${name}`;\n\t\tvalidateName(name);\n\t\tconst key = find(this[MAP], name);\n\t\tif (key === undefined) {\n\t\t\treturn null;\n\t\t}\n\n\t\treturn this[MAP][key].join(', ');\n\t}\n\n\t/**\n  * Iterate over all headers\n  *\n  * @param   Function  callback  Executed for each item with parameters (value, name, thisArg)\n  * @param   Boolean   thisArg   `this` context for callback function\n  * @return  Void\n  */\n\tforEach(callback) {\n\t\tlet thisArg = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : undefined;\n\n\t\tlet pairs = getHeaders(this);\n\t\tlet i = 0;\n\t\twhile (i < pairs.length) {\n\t\t\tvar _pairs$i = pairs[i];\n\t\t\tconst name = _pairs$i[0],\n\t\t\t      value = _pairs$i[1];\n\n\t\t\tcallback.call(thisArg, value, name, this);\n\t\t\tpairs = getHeaders(this);\n\t\t\ti++;\n\t\t}\n\t}\n\n\t/**\n  * Overwrite header values given name\n  *\n  * @param   String  name   Header name\n  * @param   String  value  Header value\n  * @return  Void\n  */\n\tset(name, value) {\n\t\tname = `${name}`;\n\t\tvalue = `${value}`;\n\t\tvalidateName(name);\n\t\tvalidateValue(value);\n\t\tconst key = find(this[MAP], name);\n\t\tthis[MAP][key !== undefined ? key : name] = [value];\n\t}\n\n\t/**\n  * Append a value onto existing header\n  *\n  * @param   String  name   Header name\n  * @param   String  value  Header value\n  * @return  Void\n  */\n\tappend(name, value) {\n\t\tname = `${name}`;\n\t\tvalue = `${value}`;\n\t\tvalidateName(name);\n\t\tvalidateValue(value);\n\t\tconst key = find(this[MAP], name);\n\t\tif (key !== undefined) {\n\t\t\tthis[MAP][key].push(value);\n\t\t} else {\n\t\t\tthis[MAP][name] = [value];\n\t\t}\n\t}\n\n\t/**\n  * Check for header name existence\n  *\n  * @param   String   name  Header name\n  * @return  Boolean\n  */\n\thas(name) {\n\t\tname = `${name}`;\n\t\tvalidateName(name);\n\t\treturn find(this[MAP], name) !== undefined;\n\t}\n\n\t/**\n  * Delete all header values given name\n  *\n  * @param   String  name  Header name\n  * @return  Void\n  */\n\tdelete(name) {\n\t\tname = `${name}`;\n\t\tvalidateName(name);\n\t\tconst key = find(this[MAP], name);\n\t\tif (key !== undefined) {\n\t\t\tdelete this[MAP][key];\n\t\t}\n\t}\n\n\t/**\n  * Return raw headers (non-spec api)\n  *\n  * @return  Object\n  */\n\traw() {\n\t\treturn this[MAP];\n\t}\n\n\t/**\n  * Get an iterator on keys.\n  *\n  * @return  Iterator\n  */\n\tkeys() {\n\t\treturn createHeadersIterator(this, 'key');\n\t}\n\n\t/**\n  * Get an iterator on values.\n  *\n  * @return  Iterator\n  */\n\tvalues() {\n\t\treturn createHeadersIterator(this, 'value');\n\t}\n\n\t/**\n  * Get an iterator on entries.\n  *\n  * This is the default iterator of the Headers object.\n  *\n  * @return  Iterator\n  */\n\t[Symbol.iterator]() {\n\t\treturn createHeadersIterator(this, 'key+value');\n\t}\n}\nHeaders.prototype.entries = Headers.prototype[Symbol.iterator];\n\nObject.defineProperty(Headers.prototype, Symbol.toStringTag, {\n\tvalue: 'Headers',\n\twritable: false,\n\tenumerable: false,\n\tconfigurable: true\n});\n\nObject.defineProperties(Headers.prototype, {\n\tget: { enumerable: true },\n\tforEach: { enumerable: true },\n\tset: { enumerable: true },\n\tappend: { enumerable: true },\n\thas: { enumerable: true },\n\tdelete: { enumerable: true },\n\tkeys: { enumerable: true },\n\tvalues: { enumerable: true },\n\tentries: { enumerable: true }\n});\n\nfunction getHeaders(headers) {\n\tlet kind = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 'key+value';\n\n\tconst keys = Object.keys(headers[MAP]).sort();\n\treturn keys.map(kind === 'key' ? function (k) {\n\t\treturn k.toLowerCase();\n\t} : kind === 'value' ? function (k) {\n\t\treturn headers[MAP][k].join(', ');\n\t} : function (k) {\n\t\treturn [k.toLowerCase(), headers[MAP][k].join(', ')];\n\t});\n}\n\nconst INTERNAL = Symbol('internal');\n\nfunction createHeadersIterator(target, kind) {\n\tconst iterator = Object.create(HeadersIteratorPrototype);\n\titerator[INTERNAL] = {\n\t\ttarget,\n\t\tkind,\n\t\tindex: 0\n\t};\n\treturn iterator;\n}\n\nconst HeadersIteratorPrototype = Object.setPrototypeOf({\n\tnext() {\n\t\t// istanbul ignore if\n\t\tif (!this || Object.getPrototypeOf(this) !== HeadersIteratorPrototype) {\n\t\t\tthrow new TypeError('Value of `this` is not a HeadersIterator');\n\t\t}\n\n\t\tvar _INTERNAL = this[INTERNAL];\n\t\tconst target = _INTERNAL.target,\n\t\t      kind = _INTERNAL.kind,\n\t\t      index = _INTERNAL.index;\n\n\t\tconst values = getHeaders(target, kind);\n\t\tconst len = values.length;\n\t\tif (index >= len) {\n\t\t\treturn {\n\t\t\t\tvalue: undefined,\n\t\t\t\tdone: true\n\t\t\t};\n\t\t}\n\n\t\tthis[INTERNAL].index = index + 1;\n\n\t\treturn {\n\t\t\tvalue: values[index],\n\t\t\tdone: false\n\t\t};\n\t}\n}, Object.getPrototypeOf(Object.getPrototypeOf([][Symbol.iterator]())));\n\nObject.defineProperty(HeadersIteratorPrototype, Symbol.toStringTag, {\n\tvalue: 'HeadersIterator',\n\twritable: false,\n\tenumerable: false,\n\tconfigurable: true\n});\n\n/**\n * Export the Headers object in a form that Node.js can consume.\n *\n * @param   Headers  headers\n * @return  Object\n */\nfunction exportNodeCompatibleHeaders(headers) {\n\tconst obj = Object.assign({ __proto__: null }, headers[MAP]);\n\n\t// http.request() only supports string as Host header. This hack makes\n\t// specifying custom Host header possible.\n\tconst hostHeaderKey = find(headers[MAP], 'Host');\n\tif (hostHeaderKey !== undefined) {\n\t\tobj[hostHeaderKey] = obj[hostHeaderKey][0];\n\t}\n\n\treturn obj;\n}\n\n/**\n * Create a Headers object from an object of headers, ignoring those that do\n * not conform to HTTP grammar productions.\n *\n * @param   Object  obj  Object of headers\n * @return  Headers\n */\nfunction createHeadersLenient(obj) {\n\tconst headers = new Headers();\n\tfor (const name of Object.keys(obj)) {\n\t\tif (invalidTokenRegex.test(name)) {\n\t\t\tcontinue;\n\t\t}\n\t\tif (Array.isArray(obj[name])) {\n\t\t\tfor (const val of obj[name]) {\n\t\t\t\tif (invalidHeaderCharRegex.test(val)) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tif (headers[MAP][name] === undefined) {\n\t\t\t\t\theaders[MAP][name] = [val];\n\t\t\t\t} else {\n\t\t\t\t\theaders[MAP][name].push(val);\n\t\t\t\t}\n\t\t\t}\n\t\t} else if (!invalidHeaderCharRegex.test(obj[name])) {\n\t\t\theaders[MAP][name] = [obj[name]];\n\t\t}\n\t}\n\treturn headers;\n}\n\nconst INTERNALS$1 = Symbol('Response internals');\n\n// fix an issue where \"STATUS_CODES\" aren't a named export for node <10\nconst STATUS_CODES = http.STATUS_CODES;\n\n/**\n * Response class\n *\n * @param   Stream  body  Readable stream\n * @param   Object  opts  Response options\n * @return  Void\n */\nclass Response {\n\tconstructor() {\n\t\tlet body = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : null;\n\t\tlet opts = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n\t\tBody.call(this, body, opts);\n\n\t\tconst status = opts.status || 200;\n\t\tconst headers = new Headers(opts.headers);\n\n\t\tif (body != null && !headers.has('Content-Type')) {\n\t\t\tconst contentType = extractContentType(body);\n\t\t\tif (contentType) {\n\t\t\t\theaders.append('Content-Type', contentType);\n\t\t\t}\n\t\t}\n\n\t\tthis[INTERNALS$1] = {\n\t\t\turl: opts.url,\n\t\t\tstatus,\n\t\t\tstatusText: opts.statusText || STATUS_CODES[status],\n\t\t\theaders,\n\t\t\tcounter: opts.counter\n\t\t};\n\t}\n\n\tget url() {\n\t\treturn this[INTERNALS$1].url || '';\n\t}\n\n\tget status() {\n\t\treturn this[INTERNALS$1].status;\n\t}\n\n\t/**\n  * Convenience property representing if the request ended normally\n  */\n\tget ok() {\n\t\treturn this[INTERNALS$1].status >= 200 && this[INTERNALS$1].status < 300;\n\t}\n\n\tget redirected() {\n\t\treturn this[INTERNALS$1].counter > 0;\n\t}\n\n\tget statusText() {\n\t\treturn this[INTERNALS$1].statusText;\n\t}\n\n\tget headers() {\n\t\treturn this[INTERNALS$1].headers;\n\t}\n\n\t/**\n  * Clone this response\n  *\n  * @return  Response\n  */\n\tclone() {\n\t\treturn new Response(clone(this), {\n\t\t\turl: this.url,\n\t\t\tstatus: this.status,\n\t\t\tstatusText: this.statusText,\n\t\t\theaders: this.headers,\n\t\t\tok: this.ok,\n\t\t\tredirected: this.redirected\n\t\t});\n\t}\n}\n\nBody.mixIn(Response.prototype);\n\nObject.defineProperties(Response.prototype, {\n\turl: { enumerable: true },\n\tstatus: { enumerable: true },\n\tok: { enumerable: true },\n\tredirected: { enumerable: true },\n\tstatusText: { enumerable: true },\n\theaders: { enumerable: true },\n\tclone: { enumerable: true }\n});\n\nObject.defineProperty(Response.prototype, Symbol.toStringTag, {\n\tvalue: 'Response',\n\twritable: false,\n\tenumerable: false,\n\tconfigurable: true\n});\n\nconst INTERNALS$2 = Symbol('Request internals');\n\n// fix an issue where \"format\", \"parse\" aren't a named export for node <10\nconst parse_url = Url.parse;\nconst format_url = Url.format;\n\nconst streamDestructionSupported = 'destroy' in Stream.Readable.prototype;\n\n/**\n * Check if a value is an instance of Request.\n *\n * @param   Mixed   input\n * @return  Boolean\n */\nfunction isRequest(input) {\n\treturn typeof input === 'object' && typeof input[INTERNALS$2] === 'object';\n}\n\nfunction isAbortSignal(signal) {\n\tconst proto = signal && typeof signal === 'object' && Object.getPrototypeOf(signal);\n\treturn !!(proto && proto.constructor.name === 'AbortSignal');\n}\n\n/**\n * Request class\n *\n * @param   Mixed   input  Url or Request instance\n * @param   Object  init   Custom options\n * @return  Void\n */\nclass Request {\n\tconstructor(input) {\n\t\tlet init = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n\t\tlet parsedURL;\n\n\t\t// normalize input\n\t\tif (!isRequest(input)) {\n\t\t\tif (input && input.href) {\n\t\t\t\t// in order to support Node.js' Url objects; though WHATWG's URL objects\n\t\t\t\t// will fall into this branch also (since their `toString()` will return\n\t\t\t\t// `href` property anyway)\n\t\t\t\tparsedURL = parse_url(input.href);\n\t\t\t} else {\n\t\t\t\t// coerce input to a string before attempting to parse\n\t\t\t\tparsedURL = parse_url(`${input}`);\n\t\t\t}\n\t\t\tinput = {};\n\t\t} else {\n\t\t\tparsedURL = parse_url(input.url);\n\t\t}\n\n\t\tlet method = init.method || input.method || 'GET';\n\t\tmethod = method.toUpperCase();\n\n\t\tif ((init.body != null || isRequest(input) && input.body !== null) && (method === 'GET' || method === 'HEAD')) {\n\t\t\tthrow new TypeError('Request with GET/HEAD method cannot have body');\n\t\t}\n\n\t\tlet inputBody = init.body != null ? init.body : isRequest(input) && input.body !== null ? clone(input) : null;\n\n\t\tBody.call(this, inputBody, {\n\t\t\ttimeout: init.timeout || input.timeout || 0,\n\t\t\tsize: init.size || input.size || 0\n\t\t});\n\n\t\tconst headers = new Headers(init.headers || input.headers || {});\n\n\t\tif (inputBody != null && !headers.has('Content-Type')) {\n\t\t\tconst contentType = extractContentType(inputBody);\n\t\t\tif (contentType) {\n\t\t\t\theaders.append('Content-Type', contentType);\n\t\t\t}\n\t\t}\n\n\t\tlet signal = isRequest(input) ? input.signal : null;\n\t\tif ('signal' in init) signal = init.signal;\n\n\t\tif (signal != null && !isAbortSignal(signal)) {\n\t\t\tthrow new TypeError('Expected signal to be an instanceof AbortSignal');\n\t\t}\n\n\t\tthis[INTERNALS$2] = {\n\t\t\tmethod,\n\t\t\tredirect: init.redirect || input.redirect || 'follow',\n\t\t\theaders,\n\t\t\tparsedURL,\n\t\t\tsignal\n\t\t};\n\n\t\t// node-fetch-only options\n\t\tthis.follow = init.follow !== undefined ? init.follow : input.follow !== undefined ? input.follow : 20;\n\t\tthis.compress = init.compress !== undefined ? init.compress : input.compress !== undefined ? input.compress : true;\n\t\tthis.counter = init.counter || input.counter || 0;\n\t\tthis.agent = init.agent || input.agent;\n\t}\n\n\tget method() {\n\t\treturn this[INTERNALS$2].method;\n\t}\n\n\tget url() {\n\t\treturn format_url(this[INTERNALS$2].parsedURL);\n\t}\n\n\tget headers() {\n\t\treturn this[INTERNALS$2].headers;\n\t}\n\n\tget redirect() {\n\t\treturn this[INTERNALS$2].redirect;\n\t}\n\n\tget signal() {\n\t\treturn this[INTERNALS$2].signal;\n\t}\n\n\t/**\n  * Clone this request\n  *\n  * @return  Request\n  */\n\tclone() {\n\t\treturn new Request(this);\n\t}\n}\n\nBody.mixIn(Request.prototype);\n\nObject.defineProperty(Request.prototype, Symbol.toStringTag, {\n\tvalue: 'Request',\n\twritable: false,\n\tenumerable: false,\n\tconfigurable: true\n});\n\nObject.defineProperties(Request.prototype, {\n\tmethod: { enumerable: true },\n\turl: { enumerable: true },\n\theaders: { enumerable: true },\n\tredirect: { enumerable: true },\n\tclone: { enumerable: true },\n\tsignal: { enumerable: true }\n});\n\n/**\n * Convert a Request to Node.js http request options.\n *\n * @param   Request  A Request instance\n * @return  Object   The options object to be passed to http.request\n */\nfunction getNodeRequestOptions(request) {\n\tconst parsedURL = request[INTERNALS$2].parsedURL;\n\tconst headers = new Headers(request[INTERNALS$2].headers);\n\n\t// fetch step 1.3\n\tif (!headers.has('Accept')) {\n\t\theaders.set('Accept', '*/*');\n\t}\n\n\t// Basic fetch\n\tif (!parsedURL.protocol || !parsedURL.hostname) {\n\t\tthrow new TypeError('Only absolute URLs are supported');\n\t}\n\n\tif (!/^https?:$/.test(parsedURL.protocol)) {\n\t\tthrow new TypeError('Only HTTP(S) protocols are supported');\n\t}\n\n\tif (request.signal && request.body instanceof Stream.Readable && !streamDestructionSupported) {\n\t\tthrow new Error('Cancellation of streamed requests with AbortSignal is not supported in node < 8');\n\t}\n\n\t// HTTP-network-or-cache fetch steps 2.4-2.7\n\tlet contentLengthValue = null;\n\tif (request.body == null && /^(POST|PUT)$/i.test(request.method)) {\n\t\tcontentLengthValue = '0';\n\t}\n\tif (request.body != null) {\n\t\tconst totalBytes = getTotalBytes(request);\n\t\tif (typeof totalBytes === 'number') {\n\t\t\tcontentLengthValue = String(totalBytes);\n\t\t}\n\t}\n\tif (contentLengthValue) {\n\t\theaders.set('Content-Length', contentLengthValue);\n\t}\n\n\t// HTTP-network-or-cache fetch step 2.11\n\tif (!headers.has('User-Agent')) {\n\t\theaders.set('User-Agent', 'node-fetch/1.0 (+https://github.com/bitinn/node-fetch)');\n\t}\n\n\t// HTTP-network-or-cache fetch step 2.15\n\tif (request.compress && !headers.has('Accept-Encoding')) {\n\t\theaders.set('Accept-Encoding', 'gzip,deflate');\n\t}\n\n\tlet agent = request.agent;\n\tif (typeof agent === 'function') {\n\t\tagent = agent(parsedURL);\n\t}\n\n\tif (!headers.has('Connection') && !agent) {\n\t\theaders.set('Connection', 'close');\n\t}\n\n\t// HTTP-network fetch step 4.2\n\t// chunked encoding is handled by Node.js\n\n\treturn Object.assign({}, parsedURL, {\n\t\tmethod: request.method,\n\t\theaders: exportNodeCompatibleHeaders(headers),\n\t\tagent\n\t});\n}\n\n/**\n * abort-error.js\n *\n * AbortError interface for cancelled requests\n */\n\n/**\n * Create AbortError instance\n *\n * @param   String      message      Error message for human\n * @return  AbortError\n */\nfunction AbortError(message) {\n  Error.call(this, message);\n\n  this.type = 'aborted';\n  this.message = message;\n\n  // hide custom error implementation details from end-users\n  Error.captureStackTrace(this, this.constructor);\n}\n\nAbortError.prototype = Object.create(Error.prototype);\nAbortError.prototype.constructor = AbortError;\nAbortError.prototype.name = 'AbortError';\n\n// fix an issue where \"PassThrough\", \"resolve\" aren't a named export for node <10\nconst PassThrough$1 = Stream.PassThrough;\nconst resolve_url = Url.resolve;\n\n/**\n * Fetch function\n *\n * @param   Mixed    url   Absolute url or Request instance\n * @param   Object   opts  Fetch options\n * @return  Promise\n */\nfunction fetch(url, opts) {\n\n\t// allow custom promise\n\tif (!fetch.Promise) {\n\t\tthrow new Error('native promise missing, set fetch.Promise to your favorite alternative');\n\t}\n\n\tBody.Promise = fetch.Promise;\n\n\t// wrap http.request into fetch\n\treturn new fetch.Promise(function (resolve, reject) {\n\t\t// build request object\n\t\tconst request = new Request(url, opts);\n\t\tconst options = getNodeRequestOptions(request);\n\n\t\tconst send = (options.protocol === 'https:' ? https : http).request;\n\t\tconst signal = request.signal;\n\n\t\tlet response = null;\n\n\t\tconst abort = function abort() {\n\t\t\tlet error = new AbortError('The user aborted a request.');\n\t\t\treject(error);\n\t\t\tif (request.body && request.body instanceof Stream.Readable) {\n\t\t\t\trequest.body.destroy(error);\n\t\t\t}\n\t\t\tif (!response || !response.body) return;\n\t\t\tresponse.body.emit('error', error);\n\t\t};\n\n\t\tif (signal && signal.aborted) {\n\t\t\tabort();\n\t\t\treturn;\n\t\t}\n\n\t\tconst abortAndFinalize = function abortAndFinalize() {\n\t\t\tabort();\n\t\t\tfinalize();\n\t\t};\n\n\t\t// send request\n\t\tconst req = send(options);\n\t\tlet reqTimeout;\n\n\t\tif (signal) {\n\t\t\tsignal.addEventListener('abort', abortAndFinalize);\n\t\t}\n\n\t\tfunction finalize() {\n\t\t\treq.abort();\n\t\t\tif (signal) signal.removeEventListener('abort', abortAndFinalize);\n\t\t\tclearTimeout(reqTimeout);\n\t\t}\n\n\t\tif (request.timeout) {\n\t\t\treq.once('socket', function (socket) {\n\t\t\t\treqTimeout = setTimeout(function () {\n\t\t\t\t\treject(new FetchError(`network timeout at: ${request.url}`, 'request-timeout'));\n\t\t\t\t\tfinalize();\n\t\t\t\t}, request.timeout);\n\t\t\t});\n\t\t}\n\n\t\treq.on('error', function (err) {\n\t\t\treject(new FetchError(`request to ${request.url} failed, reason: ${err.message}`, 'system', err));\n\t\t\tfinalize();\n\t\t});\n\n\t\treq.on('response', function (res) {\n\t\t\tclearTimeout(reqTimeout);\n\n\t\t\tconst headers = createHeadersLenient(res.headers);\n\n\t\t\t// HTTP fetch step 5\n\t\t\tif (fetch.isRedirect(res.statusCode)) {\n\t\t\t\t// HTTP fetch step 5.2\n\t\t\t\tconst location = headers.get('Location');\n\n\t\t\t\t// HTTP fetch step 5.3\n\t\t\t\tconst locationURL = location === null ? null : resolve_url(request.url, location);\n\n\t\t\t\t// HTTP fetch step 5.5\n\t\t\t\tswitch (request.redirect) {\n\t\t\t\t\tcase 'error':\n\t\t\t\t\t\treject(new FetchError(`redirect mode is set to error: ${request.url}`, 'no-redirect'));\n\t\t\t\t\t\tfinalize();\n\t\t\t\t\t\treturn;\n\t\t\t\t\tcase 'manual':\n\t\t\t\t\t\t// node-fetch-specific step: make manual redirect a bit easier to use by setting the Location header value to the resolved URL.\n\t\t\t\t\t\tif (locationURL !== null) {\n\t\t\t\t\t\t\t// handle corrupted header\n\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\theaders.set('Location', locationURL);\n\t\t\t\t\t\t\t} catch (err) {\n\t\t\t\t\t\t\t\t// istanbul ignore next: nodejs server prevent invalid response headers, we can't test this through normal request\n\t\t\t\t\t\t\t\treject(err);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'follow':\n\t\t\t\t\t\t// HTTP-redirect fetch step 2\n\t\t\t\t\t\tif (locationURL === null) {\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// HTTP-redirect fetch step 5\n\t\t\t\t\t\tif (request.counter >= request.follow) {\n\t\t\t\t\t\t\treject(new FetchError(`maximum redirect reached at: ${request.url}`, 'max-redirect'));\n\t\t\t\t\t\t\tfinalize();\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// HTTP-redirect fetch step 6 (counter increment)\n\t\t\t\t\t\t// Create a new Request object.\n\t\t\t\t\t\tconst requestOpts = {\n\t\t\t\t\t\t\theaders: new Headers(request.headers),\n\t\t\t\t\t\t\tfollow: request.follow,\n\t\t\t\t\t\t\tcounter: request.counter + 1,\n\t\t\t\t\t\t\tagent: request.agent,\n\t\t\t\t\t\t\tcompress: request.compress,\n\t\t\t\t\t\t\tmethod: request.method,\n\t\t\t\t\t\t\tbody: request.body,\n\t\t\t\t\t\t\tsignal: request.signal,\n\t\t\t\t\t\t\ttimeout: request.timeout\n\t\t\t\t\t\t};\n\n\t\t\t\t\t\t// HTTP-redirect fetch step 9\n\t\t\t\t\t\tif (res.statusCode !== 303 && request.body && getTotalBytes(request) === null) {\n\t\t\t\t\t\t\treject(new FetchError('Cannot follow redirect with body being a readable stream', 'unsupported-redirect'));\n\t\t\t\t\t\t\tfinalize();\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// HTTP-redirect fetch step 11\n\t\t\t\t\t\tif (res.statusCode === 303 || (res.statusCode === 301 || res.statusCode === 302) && request.method === 'POST') {\n\t\t\t\t\t\t\trequestOpts.method = 'GET';\n\t\t\t\t\t\t\trequestOpts.body = undefined;\n\t\t\t\t\t\t\trequestOpts.headers.delete('content-length');\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// HTTP-redirect fetch step 15\n\t\t\t\t\t\tresolve(fetch(new Request(locationURL, requestOpts)));\n\t\t\t\t\t\tfinalize();\n\t\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// prepare response\n\t\t\tres.once('end', function () {\n\t\t\t\tif (signal) signal.removeEventListener('abort', abortAndFinalize);\n\t\t\t});\n\t\t\tlet body = res.pipe(new PassThrough$1());\n\n\t\t\tconst response_options = {\n\t\t\t\turl: request.url,\n\t\t\t\tstatus: res.statusCode,\n\t\t\t\tstatusText: res.statusMessage,\n\t\t\t\theaders: headers,\n\t\t\t\tsize: request.size,\n\t\t\t\ttimeout: request.timeout,\n\t\t\t\tcounter: request.counter\n\t\t\t};\n\n\t\t\t// HTTP-network fetch step 12.1.1.3\n\t\t\tconst codings = headers.get('Content-Encoding');\n\n\t\t\t// HTTP-network fetch step 12.1.1.4: handle content codings\n\n\t\t\t// in following scenarios we ignore compression support\n\t\t\t// 1. compression support is disabled\n\t\t\t// 2. HEAD request\n\t\t\t// 3. no Content-Encoding header\n\t\t\t// 4. no content response (204)\n\t\t\t// 5. content not modified response (304)\n\t\t\tif (!request.compress || request.method === 'HEAD' || codings === null || res.statusCode === 204 || res.statusCode === 304) {\n\t\t\t\tresponse = new Response(body, response_options);\n\t\t\t\tresolve(response);\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// For Node v6+\n\t\t\t// Be less strict when decoding compressed responses, since sometimes\n\t\t\t// servers send slightly invalid responses that are still accepted\n\t\t\t// by common browsers.\n\t\t\t// Always using Z_SYNC_FLUSH is what cURL does.\n\t\t\tconst zlibOptions = {\n\t\t\t\tflush: zlib.Z_SYNC_FLUSH,\n\t\t\t\tfinishFlush: zlib.Z_SYNC_FLUSH\n\t\t\t};\n\n\t\t\t// for gzip\n\t\t\tif (codings == 'gzip' || codings == 'x-gzip') {\n\t\t\t\tbody = body.pipe(zlib.createGunzip(zlibOptions));\n\t\t\t\tresponse = new Response(body, response_options);\n\t\t\t\tresolve(response);\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// for deflate\n\t\t\tif (codings == 'deflate' || codings == 'x-deflate') {\n\t\t\t\t// handle the infamous raw deflate response from old servers\n\t\t\t\t// a hack for old IIS and Apache servers\n\t\t\t\tconst raw = res.pipe(new PassThrough$1());\n\t\t\t\traw.once('data', function (chunk) {\n\t\t\t\t\t// see http://stackoverflow.com/questions/37519828\n\t\t\t\t\tif ((chunk[0] & 0x0F) === 0x08) {\n\t\t\t\t\t\tbody = body.pipe(zlib.createInflate());\n\t\t\t\t\t} else {\n\t\t\t\t\t\tbody = body.pipe(zlib.createInflateRaw());\n\t\t\t\t\t}\n\t\t\t\t\tresponse = new Response(body, response_options);\n\t\t\t\t\tresolve(response);\n\t\t\t\t});\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// for br\n\t\t\tif (codings == 'br' && typeof zlib.createBrotliDecompress === 'function') {\n\t\t\t\tbody = body.pipe(zlib.createBrotliDecompress());\n\t\t\t\tresponse = new Response(body, response_options);\n\t\t\t\tresolve(response);\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// otherwise, use response as-is\n\t\t\tresponse = new Response(body, response_options);\n\t\t\tresolve(response);\n\t\t});\n\n\t\twriteToStream(req, request);\n\t});\n}\n/**\n * Redirect code matching\n *\n * @param   Number   code  Status code\n * @return  Boolean\n */\nfetch.isRedirect = function (code) {\n\treturn code === 301 || code === 302 || code === 303 || code === 307 || code === 308;\n};\n\n// expose Promise\nfetch.Promise = global.Promise;\n\nexport default fetch;\nexport { Headers, Request, Response, FetchError };\n","var nodeFetch = require('node-fetch')\nvar realFetch = nodeFetch.default || nodeFetch\n\nvar fetch = function (url, options) {\n  // Support schemaless URIs on the server for parity with the browser.\n  // Ex: //github.com/ -> https://github.com/\n  if (/^\\/\\//.test(url)) {\n    url = 'https:' + url\n  }\n  return realFetch.call(this, url, options)\n}\n\nmodule.exports = exports = fetch\nexports.fetch = fetch\nexports.Headers = nodeFetch.Headers\nexports.Request = nodeFetch.Request\nexports.Response = nodeFetch.Response\n\n// Needed for TypeScript consumers without esModuleInterop.\nexports.default = fetch\n","var fetchNode = require('./node-ponyfill')\nvar fetch = fetchNode.fetch.bind({})\n\nfetch.polyfill = true\n\nif (!global.fetch) {\n  global.fetch = fetch\n  global.Response = fetchNode.Response\n  global.Headers = fetchNode.Headers\n  global.Request = fetchNode.Request\n}\n","/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport var __createBinding = Object.create ? (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\r\n}) : (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n});\r\n\r\nexport function __exportStar(m, exports) {\r\n    for (var p in m) if (p !== \"default\" && !exports.hasOwnProperty(p)) __createBinding(exports, m, p);\r\n}\r\n\r\nexport function __values(o) {\r\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\r\n    if (m) return m.call(o);\r\n    if (o && typeof o.length === \"number\") return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nvar __setModuleDefault = Object.create ? (function(o, v) {\r\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\r\n}) : function(o, v) {\r\n    o[\"default\"] = v;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\r\n    __setModuleDefault(result, mod);\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n\r\nexport function __classPrivateFieldGet(receiver, privateMap) {\r\n    if (!privateMap.has(receiver)) {\r\n        throw new TypeError(\"attempted to get private field on non-instance\");\r\n    }\r\n    return privateMap.get(receiver);\r\n}\r\n\r\nexport function __classPrivateFieldSet(receiver, privateMap, value) {\r\n    if (!privateMap.has(receiver)) {\r\n        throw new TypeError(\"attempted to set private field on non-instance\");\r\n    }\r\n    privateMap.set(receiver, value);\r\n    return value;\r\n}\r\n","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.HttpEventType = void 0;\r\nvar HttpEventType;\r\n(function (HttpEventType) {\r\n    HttpEventType[HttpEventType[\"Sent\"] = 0] = \"Sent\";\r\n    HttpEventType[HttpEventType[\"UploadProgress\"] = 1] = \"UploadProgress\";\r\n    HttpEventType[HttpEventType[\"ResponseHeader\"] = 2] = \"ResponseHeader\";\r\n    HttpEventType[HttpEventType[\"DownloadProgress\"] = 3] = \"DownloadProgress\";\r\n    HttpEventType[HttpEventType[\"Response\"] = 4] = \"Response\";\r\n    HttpEventType[HttpEventType[\"User\"] = 5] = \"User\";\r\n    HttpEventType[HttpEventType[\"ResponseError\"] = 6] = \"ResponseError\";\r\n})(HttpEventType = exports.HttpEventType || (exports.HttpEventType = {}));\r\n","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.HttpHeaders = void 0;\r\nvar HttpHeaders = /** @class */ (function () {\r\n    function HttpHeaders(options) {\r\n        var _this = this;\r\n        var _a;\r\n        this.headers_ = new Map();\r\n        var headers = this.headers_;\r\n        if (options instanceof HttpHeaders) {\r\n            options.headers_.forEach(function (value, key) {\r\n                headers.set(key, value);\r\n            });\r\n        }\r\n        else if (typeof ((_a = options) === null || _a === void 0 ? void 0 : _a.forEach) === 'function') {\r\n            options.forEach(function (value, key) {\r\n                headers.set(key, value.split(', '));\r\n            });\r\n        }\r\n        else if (typeof options === 'object') {\r\n            Object.keys(options).forEach(function (key) {\r\n                var values = options[key];\r\n                if (typeof values === 'string') {\r\n                    values = [values];\r\n                }\r\n                if (headers.has(key)) {\r\n                    values.forEach(function (value) { return _this.append(key, value); });\r\n                }\r\n                else {\r\n                    headers.set(key, values);\r\n                }\r\n            });\r\n        }\r\n        else if (typeof options === 'string') {\r\n            options.split('\\n').forEach(function (line) {\r\n                var index = line.indexOf(':');\r\n                if (index > 0) {\r\n                    var key = line.slice(0, index);\r\n                    ;\r\n                    var value = line.slice(index + 1).trim();\r\n                    if (headers.has(key)) {\r\n                        _this.append(key, value);\r\n                    }\r\n                    else {\r\n                        headers.set(key, [value]);\r\n                    }\r\n                }\r\n            });\r\n        }\r\n        if (!headers.has('Accept')) {\r\n            headers.set('Accept', ['application/json', 'text/plain', '*/*']);\r\n        }\r\n        if (!headers.has('Content-Type')) {\r\n            headers.set('Content-Type', ['application/json']);\r\n        }\r\n    }\r\n    HttpHeaders.prototype.has = function (key) {\r\n        return this.headers_.has(key);\r\n    };\r\n    HttpHeaders.prototype.get = function (key) {\r\n        var values = this.headers_.get(key);\r\n        return values ? values.join(', ') : null;\r\n    };\r\n    HttpHeaders.prototype.set = function (key, value) {\r\n        var clone = this.clone_();\r\n        clone.headers_.set(key, value.split(', '));\r\n        return clone;\r\n    };\r\n    HttpHeaders.prototype.append = function (key, value) {\r\n        var clone = this.clone_();\r\n        var values = clone.headers_.has(key) ? clone.headers_.get(key) || [] : [];\r\n        values.push(value);\r\n        clone.headers_.set(key, values);\r\n        return clone;\r\n    };\r\n    HttpHeaders.prototype.delete = function (key) {\r\n        var clone = this.clone_();\r\n        clone.headers_.delete(key);\r\n        return clone;\r\n    };\r\n    HttpHeaders.prototype.forEach = function (callback, thisArg) {\r\n        var _this = this;\r\n        this.headers_.forEach(function (v, k) {\r\n            callback(v.join(', '), k, _this);\r\n        });\r\n    };\r\n    HttpHeaders.prototype.serialize = function () {\r\n        var headers = [];\r\n        this.forEach(function (value, key) {\r\n            headers.push([key, value]);\r\n        });\r\n        return headers;\r\n    };\r\n    HttpHeaders.prototype.clone_ = function () {\r\n        var clone = new HttpHeaders();\r\n        this.headers_.forEach(function (value, key) {\r\n            clone.headers_.set(key, value);\r\n        });\r\n        return clone;\r\n    };\r\n    return HttpHeaders;\r\n}());\r\nexports.HttpHeaders = HttpHeaders;\r\n","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.HttpErrorResponse = void 0;\r\nvar tslib_1 = require(\"tslib\");\r\nvar http_event_1 = require(\"./http-event\");\r\nvar http_headers_1 = require(\"./http-headers\");\r\nvar HttpErrorResponse = /** @class */ (function (_super) {\r\n    tslib_1.__extends(HttpErrorResponse, _super);\r\n    function HttpErrorResponse(options) {\r\n        var _this = _super.call(this, (options === null || options === void 0 ? void 0 : options.message) || 'Unknown Error') || this;\r\n        _this.status = 0;\r\n        _this.statusText = 'Unknown Error';\r\n        _this.ok = false;\r\n        _this.type = http_event_1.HttpEventType.ResponseError;\r\n        _this.message = 'Unknown Error';\r\n        _this.name = 'HttpErrorResponse';\r\n        if (options) {\r\n            _this.headers = new http_headers_1.HttpHeaders(options.headers);\r\n            _this.status = options.status || _this.status;\r\n            _this.statusText = options.statusText || _this.statusText;\r\n            _this.url = options.url || _this.url;\r\n            _this.error = options.error || _this.error;\r\n            _this.name = options.name || _this.name;\r\n            _this.request = options.request || null;\r\n        }\r\n        return _this;\r\n    }\r\n    HttpErrorResponse.prototype.clone = function (options) {\r\n        options = Object.assign({\r\n            headers: this.headers,\r\n            status: this.status,\r\n            statusText: this.statusText,\r\n            url: this.url,\r\n            error: this.error,\r\n            message: this.message,\r\n            name: this.name,\r\n            request: this.request,\r\n        }, options || {});\r\n        var clone = new HttpErrorResponse(options);\r\n        return clone;\r\n    };\r\n    return HttpErrorResponse;\r\n}(Error));\r\nexports.HttpErrorResponse = HttpErrorResponse;\r\n","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.HttpResponseBase = exports.HttpResponse = exports.HttpHeaderResponse = void 0;\r\nvar http_event_1 = require(\"./http-event\");\r\nvar http_headers_1 = require(\"./http-headers\");\r\nvar HttpHeaderResponse = /** @class */ (function () {\r\n    function HttpHeaderResponse(options) {\r\n        this.status = 200;\r\n        this.statusText = 'OK';\r\n        this.type = http_event_1.HttpEventType.ResponseHeader;\r\n        if (options) {\r\n            this.headers = new http_headers_1.HttpHeaders(options.headers);\r\n            this.status = options.status || this.status;\r\n            this.statusText = options.statusText || this.statusText;\r\n            this.url = options.url || this.url;\r\n        }\r\n        this.ok = this.status >= 200 && this.status < 300;\r\n    }\r\n    HttpHeaderResponse.prototype.clone = function (options) {\r\n        options = Object.assign({\r\n            headers: this.headers,\r\n            status: this.status,\r\n            statusText: this.statusText,\r\n            url: this.url,\r\n            ok: this.ok,\r\n            type: this.type,\r\n        }, options || {});\r\n        var clone = new HttpHeaderResponse(options);\r\n        return clone;\r\n    };\r\n    return HttpHeaderResponse;\r\n}());\r\nexports.HttpHeaderResponse = HttpHeaderResponse;\r\nvar HttpResponse = /** @class */ (function () {\r\n    function HttpResponse(options) {\r\n        this.status = 200;\r\n        this.statusText = 'OK';\r\n        this.type = http_event_1.HttpEventType.Response;\r\n        this.body = null;\r\n        if (options) {\r\n            this.headers = new http_headers_1.HttpHeaders(options.headers);\r\n            this.status = options.status || this.status;\r\n            this.statusText = options.statusText || this.statusText;\r\n            this.url = options.url || this.url;\r\n            this.body = options.body || this.body;\r\n        }\r\n        this.ok = this.status >= 200 && this.status < 300;\r\n    }\r\n    HttpResponse.prototype.clone = function (options) {\r\n        options = Object.assign({\r\n            headers: this.headers,\r\n            status: this.status,\r\n            statusText: this.statusText,\r\n            url: this.url,\r\n            ok: this.ok,\r\n            type: this.type,\r\n            body: this.body,\r\n        }, options || {});\r\n        var clone = new HttpResponse(options);\r\n        return clone;\r\n    };\r\n    return HttpResponse;\r\n}());\r\nexports.HttpResponse = HttpResponse;\r\nvar HttpResponseBase = /** @class */ (function () {\r\n    function HttpResponseBase(options, defaultStatus, defaultStatusText) {\r\n        if (defaultStatus === void 0) { defaultStatus = 200; }\r\n        if (defaultStatusText === void 0) { defaultStatusText = 'OK'; }\r\n        this.status = 200;\r\n        this.statusText = 'OK';\r\n        this.headers = options.headers || new http_headers_1.HttpHeaders();\r\n        this.status = options.status !== undefined ? options.status : defaultStatus;\r\n        this.statusText = options.statusText || defaultStatusText;\r\n        this.url = options.url || undefined;\r\n        this.ok = this.status >= 200 && this.status < 300;\r\n    }\r\n    return HttpResponseBase;\r\n}());\r\nexports.HttpResponseBase = HttpResponseBase;\r\n/*\r\n// !!!\r\nexport default class HttpResponse {\r\n    data?: any;\r\n    url: string = '';\r\n    status: number = 0;\r\n    statusText: string = '';\r\n    ok: boolean = false;\r\n    redirected: boolean = false;\r\n    get static() {\r\n        return this.url!.indexOf('.json') === this.url!.length - 5;\r\n    }\r\n    constructor(response: Response) {\r\n        this.data = null;\r\n        if (response) {\r\n            this.url = response.url;\r\n            this.status = response.status;\r\n            this.statusText = response.statusText;\r\n            this.ok = response.ok;\r\n            this.redirected = response.redirected;\r\n        }\r\n    }\r\n}\r\n*/\r\n","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.HttpFetchHandler = void 0;\r\nvar rxcomp_1 = require(\"rxcomp\");\r\nvar rxjs_1 = require(\"rxjs\");\r\nvar operators_1 = require(\"rxjs/operators\");\r\nvar http_error_response_1 = require(\"./http-error-response\");\r\nvar http_response_1 = require(\"./http-response\");\r\nvar HttpFetchHandler = /** @class */ (function () {\r\n    function HttpFetchHandler() {\r\n        this.response_ = null;\r\n    }\r\n    HttpFetchHandler.prototype.handle = function (request) {\r\n        var _this = this;\r\n        if (!request.method) {\r\n            throw new Error(\"missing method\");\r\n        }\r\n        var requestInfo = request.urlWithParams;\r\n        var requestInit = request.toInitRequest();\r\n        // console.log('fetchRequest', fetchRequest);\r\n        // fetchRequest.headers.forEach((value, key) => console.log('HttpFetchHandler.handle', key, value));\r\n        // request = request.clone({ headers: fetchRequest.headers });\r\n        // console.log('HttpFetchHandler.handle', 'requestInfo', requestInfo, 'requestInit', requestInit);\r\n        // hydrate\r\n        var stateKey = rxcomp_1.TransferService.makeKey(request.transferKey);\r\n        console.log('HttpFetchHandler.get', 'stateKey', stateKey, 'isPlatformBrowser', rxcomp_1.isPlatformBrowser, 'hydrate', request.hydrate);\r\n        if (rxcomp_1.isPlatformBrowser && request.hydrate && rxcomp_1.TransferService.has(stateKey)) {\r\n            var cached = rxcomp_1.TransferService.get(stateKey); // !!! <T>\t\t\t\r\n            console.log('HttpFetchHandler', cached);\r\n            rxcomp_1.TransferService.remove(stateKey);\r\n            return rxjs_1.of(cached);\r\n            // hydrate\r\n        }\r\n        else {\r\n            return rxjs_1.from(fetch(requestInfo, requestInit)\r\n                // fetch(fetchRequest)\r\n                .then(function (response) { return _this.getProgress(response, request); })\r\n                .then(function (response) { return _this.getResponse(response, request); })).pipe(\r\n            // hydrate\r\n            operators_1.tap(function (response) {\r\n                console.log('HttpFetchHandler.set', 'isPlatformServer', rxcomp_1.isPlatformServer, 'hydrate', request.hydrate, response);\r\n                if (rxcomp_1.isPlatformServer && request.hydrate) {\r\n                    rxcomp_1.TransferService.set(stateKey, response);\r\n                }\r\n            }), \r\n            // hydrate\r\n            operators_1.catchError(function (error) {\r\n                var errorResponse = { error: error };\r\n                if (_this.response_) {\r\n                    errorResponse.headers = _this.response_.headers;\r\n                    errorResponse.status = _this.response_.status;\r\n                    errorResponse.statusText = _this.response_.statusText;\r\n                    errorResponse.url = _this.response_.url;\r\n                    errorResponse.request = request;\r\n                }\r\n                var httpErrorResponse = new http_error_response_1.HttpErrorResponse(errorResponse);\r\n                // console.log('httpErrorResponse', httpErrorResponse);\r\n                rxcomp_1.nextError$.next(httpErrorResponse);\r\n                return rxjs_1.of(_this.response_);\r\n                // return throwError(httpErrorResponse);\r\n            }), operators_1.finalize(function () {\r\n                _this.response_ = null;\r\n            }));\r\n        }\r\n    };\r\n    /*\r\n    onProgress(value: Uint8Array, done: boolean, request, reader, progress) {\r\n        console.log(\"value:\", value);\r\n        if (value || done) {\r\n            console.log(\"upload complete, request.bodyUsed:\", request.bodyUsed);\r\n            progress.value = progress.max;\r\n            return reader.closed.then(() => fileUpload);\r\n        };\r\n        console.log(\"upload progress:\", value);\r\n        if (progress.value < file.size) {\r\n            progress.value += 1;\r\n        }\r\n        return reader.read().then(({ value, done }) => this.onProgress(value, done, request, reader, progress));\r\n    };\r\n\r\n    getProgress_(request) {\r\n        const uploadProgress = new ReadableStream({\r\n            start(controller) {\r\n                console.log(\"starting upload, request.bodyUsed:\", request.bodyUsed);\r\n                controller.enqueue(request.bodyUsed);\r\n            },\r\n            pull(controller) {\r\n                if (request.bodyUsed) {\r\n                    controller.close();\r\n                }\r\n                controller.enqueue(request.bodyUsed);\r\n                console.log(\"pull, request.bodyUsed:\", request.bodyUsed);\r\n            },\r\n            cancel(reason) {\r\n                console.log(reason);\r\n            }\r\n        });\r\n\r\n        const [fileUpload, reader] = [\r\n            upload(request).catch(e => {\r\n                reader.cancel();\r\n                console.log(e);\r\n                throw e\r\n            }), uploadProgress.getReader()\r\n        ];\r\n    }\r\n    */\r\n    HttpFetchHandler.prototype.getProgress = function (response, request) {\r\n        var _this = this;\r\n        // console.log('HttpFetchHandler.setProgress', request.reportProgress, response.body);\r\n        var clonedBody = response.clone().body;\r\n        if (rxcomp_1.isPlatformBrowser && request.reportProgress && clonedBody) {\r\n            var reader_1 = clonedBody.getReader();\r\n            var contentLength_1 = response.headers && response.headers.has('Content-Length') ? +(response.headers.get('Content-Length') || 0) : 0;\r\n            return new Promise(function (resolve, reject) {\r\n                /*\r\n                let receivedLength = 0; // received that many bytes at the moment\r\n                const chunks: Uint8Array[] = []; // array of received binary chunks (comprises the body)\r\n                const getChunk = () => {\r\n                    return reader.read().then(({ done, value }) => {\r\n                        if (!done) {\r\n                            if (value) {\r\n                                chunks.push(value);\r\n                                receivedLength += value.length || 0;\r\n                                console.log(`HttpFetchHandler.setProgress ${(receivedLength / contentLength * 100).toFixed(2)}% ${receivedLength} of ${contentLength}`);\r\n                            }\r\n                            getChunk();\r\n                        } else {\r\n                            reader.cancel();\r\n                            resolve(response);\r\n                            if (false) {\r\n                                // Step 4: concatenate chunks into single Uint8Array\r\n                                const chunksAll = new Uint8Array(receivedLength); // (4.1)\r\n                                let position = 0;\r\n                                for (let chunk of chunks) {\r\n                                    chunksAll.set(chunk, position); // (4.2)\r\n                                    position += chunk.length;\r\n                                }\r\n                                // Step 5: decode into a string\r\n                                const result = new TextDecoder(\"utf-8\").decode(chunksAll);\r\n                                // We're done!\r\n                                const data = JSON.parse(result);\r\n                                console.log('HttpFetchHandler.setProgress data', data);\r\n                                resolve(response);\r\n                            }\r\n                        }\r\n                    }).catch(error => {\r\n                        reader.cancel();\r\n                        reject(error);\r\n                    });\r\n                };\r\n                getChunk();\r\n                */\r\n                var progress = { progress: 0, percent: 0, current: 0, total: 0 };\r\n                var onProgress = function (value, done) {\r\n                    var receivedLength = progress.current;\r\n                    if (!done) {\r\n                        if (value) {\r\n                            receivedLength += value.length || 0;\r\n                            progress.total = contentLength_1;\r\n                            progress.current = receivedLength;\r\n                            progress.progress = receivedLength / contentLength_1;\r\n                            progress.percent = progress.progress * 100;\r\n                        }\r\n                        // console.log('progress', progress);\r\n                        return reader_1.read().then(function (_a) {\r\n                            var value = _a.value, done = _a.done;\r\n                            return onProgress(value, done);\r\n                        });\r\n                    }\r\n                    else {\r\n                        progress.total = contentLength_1;\r\n                        progress.current = contentLength_1;\r\n                        progress.progress = 1;\r\n                        progress.percent = 100;\r\n                        // console.log('progress', progress);\r\n                        return reader_1.closed.then(function () { return response.clone(); });\r\n                    }\r\n                };\r\n                reader_1.read()\r\n                    .then(function (_a) {\r\n                    var value = _a.value, done = _a.done;\r\n                    return onProgress(value, done);\r\n                })\r\n                    .then(function (response) {\r\n                    _this.response_ = new http_response_1.HttpResponse(response);\r\n                    if (typeof response[request.responseType] === 'function') {\r\n                        return response[request.responseType]().then(function (json) {\r\n                            _this.response_ = new http_response_1.HttpResponse(Object.assign(_this.response_, { body: json }));\r\n                            if (response.ok) {\r\n                                return resolve(_this.response_);\r\n                            }\r\n                            else {\r\n                                return reject(_this.response_);\r\n                            }\r\n                        });\r\n                    }\r\n                    else {\r\n                        return reject(_this.response_);\r\n                    }\r\n                })\r\n                    .catch(function (err) { return console.log(\"upload error:\", err); });\r\n            });\r\n        }\r\n        else {\r\n            return Promise.resolve(response);\r\n        }\r\n    };\r\n    HttpFetchHandler.prototype.getResponse = function (response, request) {\r\n        this.response_ = new http_response_1.HttpResponse(response);\r\n        if (rxcomp_1.isPlatformBrowser && request.reportProgress && response.body) {\r\n            return Promise.resolve(this.response_);\r\n        }\r\n        else {\r\n            return this.getResponseType(response, request);\r\n        }\r\n    };\r\n    HttpFetchHandler.prototype.getResponseType = function (response, request) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            _this.response_ = new http_response_1.HttpResponse(response);\r\n            if (typeof response[request.responseType] === 'function') {\r\n                return response[request.responseType]().then(function (json) {\r\n                    _this.response_ = new http_response_1.HttpResponse(Object.assign(_this.response_, { body: json }));\r\n                    if (response.ok) {\r\n                        return resolve(_this.response_);\r\n                    }\r\n                    else {\r\n                        return reject(_this.response_);\r\n                    }\r\n                });\r\n            }\r\n            else {\r\n                return reject(_this.response_);\r\n            }\r\n        });\r\n    };\r\n    HttpFetchHandler.prototype.getReadableStream = function (response, request) {\r\n        var reader = response.body.getReader();\r\n        var readableStream = new ReadableStream({\r\n            start: function (controller) {\r\n                // console.log(\"starting upload, request.bodyUsed:\", request.bodyUsed);\r\n                // controller.enqueue(request.bodyUsed);\r\n                // The following function handles each data chunk\r\n                var push = function () {\r\n                    // \"done\" is a Boolean and value a \"Uint8Array\"\r\n                    reader.read().then(function (_a) {\r\n                        var done = _a.done, value = _a.value;\r\n                        // Is there no more data to read?\r\n                        if (done) {\r\n                            // Tell the browser that we have finished sending data\r\n                            controller.close();\r\n                            return;\r\n                        }\r\n                        // Get the data and send it to the browser via the controller\r\n                        controller.enqueue(value);\r\n                        push();\r\n                    });\r\n                };\r\n                push();\r\n            },\r\n        });\r\n        return readableStream;\r\n    };\r\n    return HttpFetchHandler;\r\n}());\r\nexports.HttpFetchHandler = HttpFetchHandler;\r\n","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.HttpXhrHandler = void 0;\r\nvar rxcomp_1 = require(\"rxcomp\");\r\nvar rxjs_1 = require(\"rxjs\");\r\nvar http_error_response_1 = require(\"./http-error-response\");\r\nvar http_event_1 = require(\"./http-event\");\r\nvar http_headers_1 = require(\"./http-headers\");\r\nvar http_response_1 = require(\"./http-response\");\r\nvar XSSI_PREFIX = /^\\)\\]\\}',?\\n/;\r\nvar HttpXhrHandler = /** @class */ (function () {\r\n    function HttpXhrHandler() {\r\n    }\r\n    HttpXhrHandler.prototype.handle = function (request) {\r\n        if (!request.method) {\r\n            throw new Error(\"missing method\");\r\n        }\r\n        if (request.method === 'JSONP') {\r\n            throw new Error(\"Attempted to construct Jsonp request without JsonpClientModule installed.\");\r\n        }\r\n        console.log('HttpXhrHandler.request', request);\r\n        return new rxjs_1.Observable(function (observer) {\r\n            var xhr = new XMLHttpRequest();\r\n            var requestInfo = request.urlWithParams;\r\n            var requestInit = request.toInitRequest();\r\n            if (!requestInit.method) {\r\n                throw new Error(\"missing method\");\r\n            }\r\n            // hydrate\r\n            var stateKey = rxcomp_1.TransferService.makeKey(request.transferKey);\r\n            if (rxcomp_1.isPlatformBrowser && request.hydrate && rxcomp_1.TransferService.has(stateKey)) {\r\n                var cached = rxcomp_1.TransferService.get(stateKey); // !!! <T>\r\n                rxcomp_1.TransferService.remove(stateKey);\r\n                observer.next(cached);\r\n                observer.complete();\r\n                return;\r\n                // hydrate\r\n            }\r\n            else {\r\n                xhr.open(requestInit.method, requestInfo);\r\n                if (request.withCredentials) {\r\n                    xhr.withCredentials = true;\r\n                }\r\n                var headers = request.headers;\r\n                if (!headers.has('Accept')) {\r\n                    headers.set('Accept', 'application/json, text/plain, */*');\r\n                }\r\n                if (!headers.has('Content-Type')) {\r\n                    var detectedType = request.detectContentTypeHeader();\r\n                    if (detectedType !== null) {\r\n                        headers.set('Content-Type', detectedType);\r\n                    }\r\n                }\r\n                console.log('HttpXhrHandler.contentType', headers.get('Content-Type'));\r\n                headers.forEach(function (value, name) { return xhr.setRequestHeader(name, value); });\r\n                if (request.responseType) {\r\n                    xhr.responseType = (request.responseType !== 'json' ? request.responseType : 'text');\r\n                }\r\n                var body_1 = request.serializeBody();\r\n                var headerResponse_1 = null;\r\n                var partialFromXhr_1 = function () {\r\n                    if (headerResponse_1 !== null) {\r\n                        return headerResponse_1;\r\n                    }\r\n                    var status = xhr.status === 1223 ? 204 : xhr.status;\r\n                    var statusText = xhr.statusText || 'OK';\r\n                    var headers = new http_headers_1.HttpHeaders(xhr.getAllResponseHeaders());\r\n                    var url = getResponseUrl_(xhr) || request.url;\r\n                    headerResponse_1 = new http_response_1.HttpHeaderResponse({ headers: headers, status: status, statusText: statusText, url: url });\r\n                    return headerResponse_1;\r\n                };\r\n                var onLoad_1 = function () {\r\n                    var _a = partialFromXhr_1(), headers = _a.headers, status = _a.status, statusText = _a.statusText, url = _a.url;\r\n                    var body = null;\r\n                    if (status !== 204) {\r\n                        body = (typeof xhr.response === 'undefined') ? xhr.responseText : xhr.response;\r\n                    }\r\n                    if (status === 0) {\r\n                        status = !!body ? 200 : 0;\r\n                    }\r\n                    var ok = status >= 200 && status < 300;\r\n                    if (request.responseType === 'json' && typeof body === 'string') {\r\n                        var originalBody = body;\r\n                        body = body.replace(XSSI_PREFIX, '');\r\n                        try {\r\n                            body = body !== '' ? JSON.parse(body) : null;\r\n                        }\r\n                        catch (error) {\r\n                            body = originalBody;\r\n                            if (ok) {\r\n                                ok = false;\r\n                                body = { error: error, text: body };\r\n                            }\r\n                        }\r\n                    }\r\n                    if (ok) {\r\n                        var response = new http_response_1.HttpResponse({ body: body, headers: headers, status: status, statusText: statusText, url: url });\r\n                        // hydrate\r\n                        if (rxcomp_1.isPlatformServer && request.hydrate) {\r\n                            rxcomp_1.TransferService.set(stateKey, response);\r\n                        }\r\n                        // hydrate\r\n                        observer.next(response);\r\n                        observer.complete();\r\n                    }\r\n                    else {\r\n                        var options = {\r\n                            error: new Error(statusText),\r\n                            headers: headers,\r\n                            status: status,\r\n                            statusText: statusText,\r\n                            url: url,\r\n                            request: request\r\n                        };\r\n                        var httpErrorResponse = new http_error_response_1.HttpErrorResponse(options);\r\n                        // console.log('httpErrorResponse', httpErrorResponse);\r\n                        rxcomp_1.nextError$.next(httpErrorResponse);\r\n                        // return of(null);\r\n                        observer.error(httpErrorResponse);\r\n                    }\r\n                };\r\n                var onError_1 = function (error) {\r\n                    var url = partialFromXhr_1().url;\r\n                    var statusText = xhr.statusText || 'Unknown Error';\r\n                    var headers = new http_headers_1.HttpHeaders(xhr.getAllResponseHeaders());\r\n                    var options = {\r\n                        error: new Error(statusText),\r\n                        headers: headers,\r\n                        status: xhr.status || 0,\r\n                        statusText: statusText,\r\n                        url: url,\r\n                        request: request\r\n                    };\r\n                    var httpErrorResponse = new http_error_response_1.HttpErrorResponse(options);\r\n                    // console.log('httpErrorResponse', httpErrorResponse);\r\n                    rxcomp_1.nextError$.next(httpErrorResponse);\r\n                    // return of(null);\r\n                    observer.error(httpErrorResponse);\r\n                };\r\n                var sentHeaders_1 = false;\r\n                var onDownProgress_1 = function (event) {\r\n                    if (!sentHeaders_1) {\r\n                        observer.next(partialFromXhr_1());\r\n                        sentHeaders_1 = true;\r\n                    }\r\n                    var progressEvent = {\r\n                        type: http_event_1.HttpEventType.DownloadProgress,\r\n                        loaded: event.loaded,\r\n                    };\r\n                    if (event.lengthComputable) {\r\n                        progressEvent.total = event.total;\r\n                    }\r\n                    if (request.responseType === 'text' && !!xhr.responseText) {\r\n                        progressEvent.partialText = xhr.responseText;\r\n                    }\r\n                    console.log(progressEvent);\r\n                    observer.next(progressEvent);\r\n                };\r\n                var onUpProgress_1 = function (event) {\r\n                    var progress = {\r\n                        type: http_event_1.HttpEventType.UploadProgress,\r\n                        loaded: event.loaded,\r\n                    };\r\n                    if (event.lengthComputable) {\r\n                        progress.total = event.total;\r\n                    }\r\n                    observer.next(progress);\r\n                };\r\n                xhr.addEventListener('load', onLoad_1);\r\n                xhr.addEventListener('error', onError_1);\r\n                if (request.reportProgress) {\r\n                    xhr.addEventListener('progress', onDownProgress_1);\r\n                    if (body_1 !== null && xhr.upload) {\r\n                        xhr.upload.addEventListener('progress', onUpProgress_1);\r\n                    }\r\n                }\r\n                xhr.send(body_1);\r\n                observer.next({ type: http_event_1.HttpEventType.Sent });\r\n                return function () {\r\n                    xhr.removeEventListener('error', onError_1);\r\n                    xhr.removeEventListener('load', onLoad_1);\r\n                    if (request.reportProgress) {\r\n                        xhr.removeEventListener('progress', onDownProgress_1);\r\n                        if (body_1 !== null && xhr.upload) {\r\n                            xhr.upload.removeEventListener('progress', onUpProgress_1);\r\n                        }\r\n                    }\r\n                    if (xhr.readyState !== xhr.DONE) {\r\n                        xhr.abort();\r\n                    }\r\n                };\r\n            }\r\n        });\r\n    };\r\n    return HttpXhrHandler;\r\n}());\r\nexports.HttpXhrHandler = HttpXhrHandler;\r\nfunction getResponseUrl_(xhr) {\r\n    if ('responseURL' in xhr && xhr.responseURL) {\r\n        return xhr.responseURL;\r\n    }\r\n    if (/^X-Request-URL:/m.test(xhr.getAllResponseHeaders())) {\r\n        return xhr.getResponseHeader('X-Request-URL');\r\n    }\r\n    return null;\r\n}\r\n","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.jsonpCallbackContext = exports.interceptingHandler = exports.HttpInterceptingHandler = exports.xhrHandler = exports.fetchHandler = exports.NoopInterceptor = exports.HttpInterceptors = exports.HttpInterceptorHandler = void 0;\r\nvar http_fetch_handler_1 = require(\"./http-fetch.handler\");\r\nvar http_xhr_handler_1 = require(\"./http-xhr.handler\");\r\nvar HttpInterceptorHandler = /** @class */ (function () {\r\n    function HttpInterceptorHandler(next, interceptor) {\r\n        this.next = next;\r\n        this.interceptor = interceptor;\r\n    }\r\n    HttpInterceptorHandler.prototype.handle = function (req) {\r\n        return this.interceptor.intercept(req, this.next);\r\n    };\r\n    return HttpInterceptorHandler;\r\n}());\r\nexports.HttpInterceptorHandler = HttpInterceptorHandler;\r\nexports.HttpInterceptors = [];\r\nvar NoopInterceptor = /** @class */ (function () {\r\n    function NoopInterceptor() {\r\n    }\r\n    NoopInterceptor.prototype.intercept = function (req, next) {\r\n        return next.handle(req);\r\n    };\r\n    return NoopInterceptor;\r\n}());\r\nexports.NoopInterceptor = NoopInterceptor;\r\nexports.fetchHandler = new http_fetch_handler_1.HttpFetchHandler();\r\nexports.xhrHandler = new http_xhr_handler_1.HttpXhrHandler();\r\nvar HttpInterceptingHandler = /** @class */ (function () {\r\n    function HttpInterceptingHandler() {\r\n        this.chain = null;\r\n    }\r\n    HttpInterceptingHandler.prototype.handle = function (req) {\r\n        if (this.chain === null) {\r\n            var interceptors = exports.HttpInterceptors;\r\n            this.chain = interceptors.reduceRight(function (next, interceptor) { return new HttpInterceptorHandler(next, interceptor); }, exports.fetchHandler);\r\n        }\r\n        return this.chain.handle(req);\r\n    };\r\n    return HttpInterceptingHandler;\r\n}());\r\nexports.HttpInterceptingHandler = HttpInterceptingHandler;\r\nfunction interceptingHandler(handler, interceptors) {\r\n    if (interceptors === void 0) { interceptors = []; }\r\n    if (!interceptors) {\r\n        return handler;\r\n    }\r\n    return interceptors.reduceRight(function (next, interceptor) { return new HttpInterceptorHandler(next, interceptor); }, handler);\r\n}\r\nexports.interceptingHandler = interceptingHandler;\r\nfunction jsonpCallbackContext() {\r\n    if (typeof window === 'object') {\r\n        return window;\r\n    }\r\n    return {};\r\n}\r\nexports.jsonpCallbackContext = jsonpCallbackContext;\r\n","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar tslib_1 = require(\"tslib\");\r\nvar rxcomp_1 = require(\"rxcomp\");\r\nvar http_interceptor_1 = require(\"./http/http-interceptor\");\r\nvar factories = [];\r\nvar pipes = [];\r\n/**\r\n *  HttpModule Class.\r\n * @example\r\n * export default class AppModule extends Module {}\r\n *\r\n * AppModule.meta = {\r\n *  imports: [\r\n *   CoreModule,\r\n *    HttpModule\r\n *  ],\r\n *  declarations: [\r\n *   ErrorsComponent\r\n *  ],\r\n *  bootstrap: AppComponent,\r\n * };\r\n * @extends Module\r\n */\r\nvar HttpModule = /** @class */ (function (_super) {\r\n    tslib_1.__extends(HttpModule, _super);\r\n    function HttpModule() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    HttpModule.useInterceptors = function (interceptorFactories) {\r\n        if (interceptorFactories === null || interceptorFactories === void 0 ? void 0 : interceptorFactories.length) {\r\n            var interceptors = interceptorFactories === null || interceptorFactories === void 0 ? void 0 : interceptorFactories.map(function (x) { return new x(); });\r\n            http_interceptor_1.HttpInterceptors.push.apply(http_interceptor_1.HttpInterceptors, interceptors);\r\n        }\r\n        return this;\r\n    };\r\n    HttpModule.meta = {\r\n        declarations: tslib_1.__spread(factories, pipes),\r\n        exports: tslib_1.__spread(factories, pipes)\r\n    };\r\n    return HttpModule;\r\n}(rxcomp_1.Module));\r\nexports.default = HttpModule;\r\n","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.HttpHandler = void 0;\r\nvar HttpHandler = /** @class */ (function () {\r\n    function HttpHandler() {\r\n    }\r\n    return HttpHandler;\r\n}());\r\nexports.HttpHandler = HttpHandler;\r\n","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.HttpParams = exports.HttpUrlEncodingCodec = void 0;\r\nvar tslib_1 = require(\"tslib\");\r\nvar HttpUrlEncodingCodec = /** @class */ (function () {\r\n    function HttpUrlEncodingCodec() {\r\n    }\r\n    HttpUrlEncodingCodec.prototype.encodeKey = function (key) {\r\n        return encodeParam_(key);\r\n    };\r\n    HttpUrlEncodingCodec.prototype.encodeValue = function (value) {\r\n        return encodeParam_(value);\r\n    };\r\n    HttpUrlEncodingCodec.prototype.decodeKey = function (key) {\r\n        return decodeURIComponent(key);\r\n    };\r\n    HttpUrlEncodingCodec.prototype.decodeValue = function (value) {\r\n        return decodeURIComponent(value);\r\n    };\r\n    return HttpUrlEncodingCodec;\r\n}());\r\nexports.HttpUrlEncodingCodec = HttpUrlEncodingCodec;\r\nvar HttpParams = /** @class */ (function () {\r\n    function HttpParams(options, encoder) {\r\n        if (encoder === void 0) { encoder = new HttpUrlEncodingCodec(); }\r\n        this.params_ = new Map();\r\n        this.encoder = encoder;\r\n        var params = this.params_;\r\n        if (options instanceof HttpParams) {\r\n            options.params_.forEach(function (value, key) {\r\n                params.set(key, value);\r\n            });\r\n        }\r\n        else if (typeof options === 'object') {\r\n            Object.keys(options).forEach(function (key) {\r\n                var value = options[key];\r\n                params.set(key, Array.isArray(value) ? value : [value]);\r\n            });\r\n        }\r\n        else if (typeof options === 'string') {\r\n            parseRawParams_(params, options, this.encoder);\r\n        }\r\n        // ?updates=null&cloneFrom=null&encoder=%5Bobject%20Object%5D&params_=%5Bobject%20Map%5D\r\n    }\r\n    HttpParams.prototype.keys = function () {\r\n        return Array.from(this.params_.keys());\r\n    };\r\n    HttpParams.prototype.has = function (key) {\r\n        return this.params_.has(key);\r\n    };\r\n    HttpParams.prototype.get = function (key) {\r\n        var value = this.params_.get(key);\r\n        return value ? value[0] : null;\r\n    };\r\n    HttpParams.prototype.getAll = function (key) {\r\n        return this.params_.get(key) || null;\r\n    };\r\n    HttpParams.prototype.set = function (key, value) {\r\n        var clone = this.clone_();\r\n        clone.params_.set(key, [value]);\r\n        return clone;\r\n    };\r\n    HttpParams.prototype.append = function (key, value) {\r\n        var clone = this.clone_();\r\n        if (clone.has(key)) {\r\n            var values = clone.params_.get(key) || [];\r\n            values.push(value);\r\n            clone.params_.set(key, values);\r\n        }\r\n        else {\r\n            clone.params_.set(key, [value]);\r\n        }\r\n        return clone;\r\n    };\r\n    HttpParams.prototype.delete = function (key) {\r\n        var clone = this.clone_();\r\n        clone.params_.delete(key);\r\n        return clone;\r\n    };\r\n    HttpParams.prototype.toString = function () {\r\n        var _this = this;\r\n        return this.keys().map(function (key) {\r\n            var values = _this.params_.get(key);\r\n            return _this.encoder.encodeKey(key) + (values ? '=' + values.map(function (x) { return _this.encoder.encodeValue(x); }).join('&') : '');\r\n        }).filter(function (keyValue) { return keyValue !== ''; }).join('&');\r\n    };\r\n    HttpParams.prototype.clone_ = function () {\r\n        var clone = new HttpParams(undefined, this.encoder);\r\n        this.params_.forEach(function (value, key) {\r\n            clone.params_.set(key, value);\r\n        });\r\n        return clone;\r\n    };\r\n    return HttpParams;\r\n}());\r\nexports.HttpParams = HttpParams;\r\nfunction parseRawParams_(params, queryString, encoder) {\r\n    if (queryString.length > 0) {\r\n        var keyValueParams = queryString.split('&');\r\n        keyValueParams.forEach(function (keyValue) {\r\n            var index = keyValue.indexOf('=');\r\n            var _a = tslib_1.__read(index == -1 ? [encoder.decodeKey(keyValue), ''] : [encoder.decodeKey(keyValue.slice(0, index)), encoder.decodeValue(keyValue.slice(index + 1))], 2), key = _a[0], value = _a[1];\r\n            var values = params.get(key) || [];\r\n            values.push(value);\r\n            params.set(key, values);\r\n        });\r\n    }\r\n    return params;\r\n}\r\nfunction encodeParam_(v) {\r\n    return encodeURIComponent(v)\r\n        .replace(/%40/gi, '@')\r\n        .replace(/%3A/gi, ':')\r\n        .replace(/%24/gi, '$')\r\n        .replace(/%2C/gi, ',')\r\n        .replace(/%3B/gi, ';')\r\n        .replace(/%2B/gi, '+')\r\n        .replace(/%3D/gi, '=')\r\n        .replace(/%3F/gi, '?')\r\n        .replace(/%2F/gi, '/');\r\n}\r\n","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.HttpRequest = void 0;\r\nvar tslib_1 = require(\"tslib\");\r\nvar http_headers_1 = require(\"./http-headers\");\r\nvar http_params_1 = require(\"./http-params\");\r\nvar HttpRequest = /** @class */ (function () {\r\n    function HttpRequest(method, url, third, fourth) {\r\n        this.url = url;\r\n        this.reportProgress = false;\r\n        this.withCredentials = false;\r\n        this.hydrate = true;\r\n        this.observe = 'body';\r\n        this.responseType = 'json';\r\n        // !!! remove, rethink\r\n        var isStaticFile = /\\.(json|xml|txt)(\\?.*)?$/.test(url);\r\n        this.method = isStaticFile ? 'GET' : method.toUpperCase();\r\n        var options;\r\n        if (methodHasBody_(this.method) || !!fourth) {\r\n            this.body = (third !== undefined) ? third : null;\r\n            options = fourth;\r\n        }\r\n        else {\r\n            options = third;\r\n        }\r\n        if (options) {\r\n            this.reportProgress = !!options.reportProgress;\r\n            this.withCredentials = !!options.withCredentials;\r\n            this.observe = options.observe || this.observe;\r\n            if (options.responseType) {\r\n                this.responseType = options.responseType;\r\n            }\r\n            if (options.headers) {\r\n                this.headers = new http_headers_1.HttpHeaders(options.headers);\r\n            }\r\n            if (options.params) {\r\n                this.params = new http_params_1.HttpParams(options.params);\r\n            }\r\n        }\r\n        if (!this.headers) {\r\n            this.headers = new http_headers_1.HttpHeaders();\r\n        }\r\n        if (!this.params) {\r\n            this.params = new http_params_1.HttpParams();\r\n        }\r\n        var params = this.params.toString();\r\n        var index = url.indexOf('?');\r\n        var sep = index === -1 ? '?' : (index < url.length - 1 ? '&' : '');\r\n        this.urlWithParams = url + (params.length ? sep + params : params);\r\n    }\r\n    Object.defineProperty(HttpRequest.prototype, \"transferKey\", {\r\n        get: function () {\r\n            var pathname = getPath_(this.url).pathname;\r\n            var key = flatMap_(pathname, this.params);\r\n            key = key.replace(/(\\W)/gm, '_');\r\n            console.log('transferKey', key, pathname, this.params, this.url);\r\n            return key;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    HttpRequest.prototype.serializeBody = function () {\r\n        if (this.body === null) {\r\n            return null;\r\n        }\r\n        if (isArrayBuffer_(this.body) || isBlob_(this.body) || isFormData_(this.body) ||\r\n            typeof this.body === 'string') {\r\n            return this.body;\r\n        }\r\n        if (this.body instanceof http_params_1.HttpParams) {\r\n            return this.body.toString();\r\n        }\r\n        if (typeof this.body === 'object' || typeof this.body === 'boolean' || Array.isArray(this.body)) {\r\n            return JSON.stringify(this.body);\r\n        }\r\n        return this.body.toString();\r\n    };\r\n    HttpRequest.prototype.detectContentTypeHeader = function () {\r\n        if (this.body === null) {\r\n            return null;\r\n        }\r\n        if (isFormData_(this.body)) {\r\n            return null;\r\n        }\r\n        if (isBlob_(this.body)) {\r\n            return this.body.type || null;\r\n        }\r\n        if (isArrayBuffer_(this.body)) {\r\n            return null;\r\n        }\r\n        if (typeof this.body === 'string') {\r\n            return 'text/plain';\r\n        }\r\n        if (this.body instanceof http_params_1.HttpParams) {\r\n            return 'application/x-www-form-urlencoded;charset=UTF-8';\r\n        }\r\n        if (typeof this.body === 'object' || typeof this.body === 'number' ||\r\n            Array.isArray(this.body)) {\r\n            return 'application/json';\r\n        }\r\n        return null;\r\n    };\r\n    HttpRequest.prototype.toInitRequest = function () {\r\n        return {\r\n            method: this.method,\r\n            headers: this.headers.serialize(),\r\n            body: this.serializeBody(),\r\n            mode: 'same-origin',\r\n            credentials: 'same-origin',\r\n            cache: 'default',\r\n            redirect: 'error',\r\n        };\r\n    };\r\n    HttpRequest.prototype.toFetchRequest__ = function () {\r\n        return new Request(this.urlWithParams, this.toInitRequest());\r\n        /*\r\n        Request.cache Read only\r\n        Contains the cache mode of the request (e.g., default, reload, no-cache).\r\n        Request.context Read only\r\n        Contains the context of the request (e.g., audio, image, iframe, etc.)\r\n        Request.credentials Read only\r\n        Contains the credentials of the request (e.g., omit, same-origin, include). The default is same-origin.\r\n        Request.destination Read only\r\n        Returns a string from the RequestDestination enum describing the request's destination. This is a string indicating the type of content being requested.\r\n        Request.headers Read only\r\n        Contains the associated Headers object of the request.\r\n        Request.integrity Read only\r\n        Contains the subresource integrity value of the request (e.g., sha256-BpfBw7ivV8q2jLiT13fxDYAe2tJllusRSZ273h2nFSE=).\r\n        Request.method Read only\r\n        Contains the request's method (GET, POST, etc.)\r\n        Request.mode Read only\r\n        Contains the mode of the request (e.g., cors, no-cors, same-origin, navigate.)\r\n        Request.redirect Read only\r\n        Contains the mode for how redirects are handled. It may be one of follow, error, or manual.\r\n        Request.referrer Read only\r\n        Contains the referrer of the request (e.g., client).\r\n        Request.referrerPolicy Read only\r\n        Contains the referrer policy of the request (e.g., no-referrer).\r\n        Request.url Read only\r\n        Contains the URL of the request.\r\n        Request implements Body, so it also inherits the following properties:\r\n        body Read only\r\n        A simple getter used to expose a ReadableStream of the body contents.\r\n        bodyUsed Read only\r\n        Stores a Boolean that declares whether the body has been used in a response yet.\r\n        */\r\n    };\r\n    HttpRequest.prototype.clone = function (options) {\r\n        options = Object.assign({\r\n            headers: this.headers,\r\n            reportProgress: this.reportProgress,\r\n            params: this.params,\r\n            responseType: this.responseType,\r\n            withCredentials: this.withCredentials,\r\n            observe: this.observe,\r\n            body: this.body,\r\n            url: this.url,\r\n            method: this.method,\r\n        }, options || {});\r\n        var clone = new HttpRequest(this.method, this.url, this.body, options);\r\n        return clone;\r\n    };\r\n    return HttpRequest;\r\n}());\r\nexports.HttpRequest = HttpRequest;\r\nfunction methodHasBody_(method) {\r\n    switch (method) {\r\n        case 'DELETE':\r\n        case 'GET':\r\n        case 'HEAD':\r\n        case 'OPTIONS':\r\n        case 'JSONP':\r\n            return false;\r\n        default:\r\n            return true;\r\n    }\r\n}\r\nfunction isArrayBuffer_(value) {\r\n    return typeof ArrayBuffer !== 'undefined' && value instanceof ArrayBuffer;\r\n}\r\nfunction isBlob_(value) {\r\n    return typeof Blob !== 'undefined' && value instanceof Blob;\r\n}\r\nfunction isFormData_(value) {\r\n    return typeof FormData !== 'undefined' && value instanceof FormData;\r\n}\r\nfunction flatMap_(s, x) {\r\n    if (typeof x === 'number') {\r\n        s += x.toString();\r\n    }\r\n    else if (typeof x === 'string') {\r\n        s += x.substr(0, 10);\r\n    }\r\n    else if (x && typeof x === 'object') {\r\n        s += '_' + Object.keys(x).map(function (k) { return k + '_' + flatMap_('', x[k]); }).join('_');\r\n    }\r\n    return s;\r\n}\r\nfunction getPath_(href) {\r\n    var e_1, _a;\r\n    var protocol = '';\r\n    var host = '';\r\n    var hostname = '';\r\n    var port = '';\r\n    var pathname = '';\r\n    var search = '';\r\n    var hash = '';\r\n    var regExp = /^((http\\:|https\\:)?\\/\\/|\\/)?([^\\/\\:]+)?(\\:([^\\/]+))?(\\/[^\\?]+)?(\\?[^\\#]+)?(\\#.+)?$/g;\r\n    var matches = href.matchAll(regExp);\r\n    try {\r\n        for (var matches_1 = tslib_1.__values(matches), matches_1_1 = matches_1.next(); !matches_1_1.done; matches_1_1 = matches_1.next()) {\r\n            var match = matches_1_1.value;\r\n            protocol = match[2] || '';\r\n            host = hostname = match[3] || '';\r\n            port = match[5] || '';\r\n            pathname = match[6] || '';\r\n            search = match[7] || '';\r\n            hash = match[8] || '';\r\n        }\r\n    }\r\n    catch (e_1_1) { e_1 = { error: e_1_1 }; }\r\n    finally {\r\n        try {\r\n            if (matches_1_1 && !matches_1_1.done && (_a = matches_1.return)) _a.call(matches_1);\r\n        }\r\n        finally { if (e_1) throw e_1.error; }\r\n    }\r\n    return { href: href, protocol: protocol, host: host, hostname: hostname, port: port, pathname: pathname, search: search, hash: hash };\r\n}\r\n","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar rxjs_1 = require(\"rxjs\");\r\nvar operators_1 = require(\"rxjs/operators\");\r\nvar http_error_response_1 = require(\"./http-error-response\");\r\nvar http_headers_1 = require(\"./http-headers\");\r\nvar http_interceptor_1 = require(\"./http-interceptor\");\r\nvar http_params_1 = require(\"./http-params\");\r\nvar http_request_1 = require(\"./http-request\");\r\nvar http_response_1 = require(\"./http-response\");\r\nvar HttpService = /** @class */ (function () {\r\n    function HttpService() {\r\n    }\r\n    HttpService.incrementPendingRequest = function () {\r\n        HttpService.pendingRequests$.next(HttpService.pendingRequests$.getValue() + 1);\r\n    };\r\n    HttpService.decrementPendingRequest = function () {\r\n        HttpService.pendingRequests$.next(HttpService.pendingRequests$.getValue() - 1);\r\n    };\r\n    HttpService.request$ = function (first, url, options) {\r\n        var _this = this;\r\n        if (options === void 0) { options = {}; }\r\n        var request;\r\n        if (first instanceof http_request_1.HttpRequest) {\r\n            request = first;\r\n        }\r\n        else {\r\n            var headers = undefined;\r\n            if (options.headers instanceof http_headers_1.HttpHeaders) {\r\n                headers = options.headers;\r\n            }\r\n            else {\r\n                headers = new http_headers_1.HttpHeaders(options.headers);\r\n            }\r\n            var params = undefined;\r\n            if (options.params) {\r\n                params = new http_params_1.HttpParams(options.params);\r\n            }\r\n            request = new http_request_1.HttpRequest(first, url, (options.body !== undefined ? options.body : null), {\r\n                headers: headers,\r\n                params: params,\r\n                reportProgress: options.reportProgress,\r\n                responseType: options.responseType || 'json',\r\n                withCredentials: options.withCredentials,\r\n            });\r\n        }\r\n        // console.log('HttpService.request$', request);\r\n        HttpService.incrementPendingRequest();\r\n        var events$ = rxjs_1.of(request).pipe(operators_1.concatMap(function (request) { return _this.handler.handle(request); }), \r\n        // tap((response: HttpEvent<any>) => console.log('HttpService.response', response)),\r\n        operators_1.finalize(function () { return HttpService.decrementPendingRequest(); }));\r\n        if (first instanceof http_request_1.HttpRequest || options.observe === 'events') {\r\n            return events$.pipe(operators_1.catchError(function (error) {\r\n                console.log('error', error);\r\n                return rxjs_1.throwError(_this.getError(error, null, request));\r\n            }));\r\n        }\r\n        var response$ = events$.pipe(operators_1.filter(function (event) { return event instanceof http_response_1.HttpResponse; }));\r\n        var response_;\r\n        var observe$ = response$.pipe(operators_1.map(function (response) {\r\n            response_ = response;\r\n            switch (options.observe || 'body') {\r\n                case 'body':\r\n                    switch (request.responseType) {\r\n                        case 'arraybuffer':\r\n                            if (response.body !== null && !(response.body instanceof ArrayBuffer)) {\r\n                                throw new Error('Response is not an ArrayBuffer.');\r\n                            }\r\n                            return response.body;\r\n                        case 'blob':\r\n                            if (response.body !== null && !(response.body instanceof Blob)) {\r\n                                throw new Error('Response is not a Blob.');\r\n                            }\r\n                            return response.body;\r\n                        case 'text':\r\n                            if (response.body !== null && typeof response.body !== 'string') {\r\n                                throw new Error('Response is not a string.');\r\n                            }\r\n                            return response.body;\r\n                        case 'json':\r\n                        default:\r\n                            return response.body;\r\n                    }\r\n                case 'response':\r\n                    return response;\r\n                default:\r\n                    throw new Error(\"Unreachable: unhandled observe type \" + options.observe + \"}\");\r\n            }\r\n        }), operators_1.catchError(function (error) {\r\n            console.log('error', error);\r\n            return rxjs_1.throwError(_this.getError(error, response_, request));\r\n        }));\r\n        return observe$;\r\n        /*\r\n        switch (options.observe || 'body') {\r\n            case 'body':\r\n                switch (request.responseType) {\r\n                    case 'arraybuffer':\r\n                        return response$.pipe(map((response: HttpResponse<T>) => {\r\n                            if (response.body !== null && !(response.body instanceof ArrayBuffer)) {\r\n                                throw new Error('Response is not an ArrayBuffer.');\r\n                            }\r\n                            return response.body;\r\n                        }));\r\n                    case 'blob':\r\n                        return response$.pipe(map((response: HttpResponse<T>) => {\r\n                            if (response.body !== null && !(response.body instanceof Blob)) {\r\n                                throw new Error('Response is not a Blob.');\r\n                            }\r\n                            return response.body;\r\n                        }));\r\n                    case 'text':\r\n                        return response$.pipe(map((response: HttpResponse<T>) => {\r\n                            if (response.body !== null && typeof response.body !== 'string') {\r\n                                throw new Error('Response is not a string.');\r\n                            }\r\n                            return response.body;\r\n                        }));\r\n                    case 'json':\r\n                    default:\r\n                        return response$.pipe(map((response: HttpResponse<T>) => response.body));\r\n                }\r\n            case 'response':\r\n                return response$;\r\n            default:\r\n                throw new Error(`Unreachable: unhandled observe type ${options.observe}}`);\r\n        }\r\n        */\r\n    };\r\n    HttpService.delete$ = function (url, options) {\r\n        if (options === void 0) { options = {}; }\r\n        return this.request$('DELETE', url, options);\r\n    };\r\n    HttpService.get$ = function (url, options) {\r\n        if (options === void 0) { options = {}; }\r\n        return this.request$('GET', url, options);\r\n    };\r\n    HttpService.head$ = function (url, options) {\r\n        if (options === void 0) { options = {}; }\r\n        return this.request$('HEAD', url, options);\r\n    };\r\n    HttpService.jsonp$ = function (url, callbackParam) {\r\n        return this.request$('JSONP', url, {\r\n            params: new http_params_1.HttpParams().append(callbackParam, 'JSONP_CALLBACK'),\r\n            observe: 'body',\r\n            responseType: 'json',\r\n        });\r\n    };\r\n    HttpService.options$ = function (url, options) {\r\n        if (options === void 0) { options = {}; }\r\n        return this.request$('OPTIONS', url, options);\r\n    };\r\n    HttpService.patch$ = function (url, body, options) {\r\n        if (options === void 0) { options = {}; }\r\n        return this.request$('PATCH', url, optionsWithBody_(options, body));\r\n    };\r\n    HttpService.post$ = function (url, body, options) {\r\n        if (options === void 0) { options = {}; }\r\n        return this.request$('POST', url, optionsWithBody_(options, body));\r\n    };\r\n    HttpService.put$ = function (url, body, options) {\r\n        if (options === void 0) { options = {}; }\r\n        return this.request$('PUT', url, optionsWithBody_(options, body));\r\n    };\r\n    HttpService.getError = function (error, response, request) {\r\n        if (!error.status) {\r\n            error.statusCode = (response === null || response === void 0 ? void 0 : response.status) || 0;\r\n        }\r\n        if (!error.statusMessage) {\r\n            error.statusMessage = (response === null || response === void 0 ? void 0 : response.statusText) || 'Unknown Error';\r\n        }\r\n        var options = {\r\n            error: error,\r\n            status: error.status,\r\n            statusText: error.statusText,\r\n            message: error.message,\r\n            request: request,\r\n        };\r\n        if (response) {\r\n            options.headers = response.headers;\r\n            options.status = options.status || response.status;\r\n            options.statusText = options.statusText || response.statusText;\r\n            options.url = response.url;\r\n        }\r\n        return new http_error_response_1.HttpErrorResponse(options);\r\n    };\r\n    HttpService.pendingRequests$ = new rxjs_1.BehaviorSubject(0);\r\n    // static handler: HttpHandler = new HttpFetchHandler();\r\n    HttpService.handler = new http_interceptor_1.HttpInterceptingHandler();\r\n    return HttpService;\r\n}());\r\nexports.default = HttpService;\r\nfunction optionsWithBody_(options, body) {\r\n    return Object.assign({}, options, { body: body });\r\n}\r\n","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar http_module_1 = require(\"./http.module\");\r\nObject.defineProperty(exports, \"HttpModule\", { enumerable: true, get: function () { return http_module_1.default; } });\r\nvar http_error_response_1 = require(\"./http/http-error-response\");\r\nObject.defineProperty(exports, \"HttpErrorResponse\", { enumerable: true, get: function () { return http_error_response_1.HttpErrorResponse; } });\r\nvar http_event_1 = require(\"./http/http-event\");\r\nObject.defineProperty(exports, \"HttpEventType\", { enumerable: true, get: function () { return http_event_1.HttpEventType; } });\r\nvar http_fetch_handler_1 = require(\"./http/http-fetch.handler\");\r\nObject.defineProperty(exports, \"HttpFetchHandler\", { enumerable: true, get: function () { return http_fetch_handler_1.HttpFetchHandler; } });\r\nvar http_handler_1 = require(\"./http/http-handler\");\r\nObject.defineProperty(exports, \"HttpHandler\", { enumerable: true, get: function () { return http_handler_1.HttpHandler; } });\r\nvar http_headers_1 = require(\"./http/http-headers\");\r\nObject.defineProperty(exports, \"HttpHeaders\", { enumerable: true, get: function () { return http_headers_1.HttpHeaders; } });\r\nvar http_interceptor_1 = require(\"./http/http-interceptor\");\r\nObject.defineProperty(exports, \"fetchHandler\", { enumerable: true, get: function () { return http_interceptor_1.fetchHandler; } });\r\nObject.defineProperty(exports, \"HttpInterceptingHandler\", { enumerable: true, get: function () { return http_interceptor_1.HttpInterceptingHandler; } });\r\nObject.defineProperty(exports, \"HttpInterceptorHandler\", { enumerable: true, get: function () { return http_interceptor_1.HttpInterceptorHandler; } });\r\nObject.defineProperty(exports, \"HttpInterceptors\", { enumerable: true, get: function () { return http_interceptor_1.HttpInterceptors; } });\r\nObject.defineProperty(exports, \"interceptingHandler\", { enumerable: true, get: function () { return http_interceptor_1.interceptingHandler; } });\r\nObject.defineProperty(exports, \"jsonpCallbackContext\", { enumerable: true, get: function () { return http_interceptor_1.jsonpCallbackContext; } });\r\nObject.defineProperty(exports, \"NoopInterceptor\", { enumerable: true, get: function () { return http_interceptor_1.NoopInterceptor; } });\r\nObject.defineProperty(exports, \"xhrHandler\", { enumerable: true, get: function () { return http_interceptor_1.xhrHandler; } });\r\nvar http_params_1 = require(\"./http/http-params\");\r\nObject.defineProperty(exports, \"HttpParams\", { enumerable: true, get: function () { return http_params_1.HttpParams; } });\r\nObject.defineProperty(exports, \"HttpUrlEncodingCodec\", { enumerable: true, get: function () { return http_params_1.HttpUrlEncodingCodec; } });\r\nvar http_request_1 = require(\"./http/http-request\");\r\nObject.defineProperty(exports, \"HttpRequest\", { enumerable: true, get: function () { return http_request_1.HttpRequest; } });\r\nvar http_response_1 = require(\"./http/http-response\");\r\nObject.defineProperty(exports, \"HttpHeaderResponse\", { enumerable: true, get: function () { return http_response_1.HttpHeaderResponse; } });\r\nObject.defineProperty(exports, \"HttpResponse\", { enumerable: true, get: function () { return http_response_1.HttpResponse; } });\r\nObject.defineProperty(exports, \"HttpResponseBase\", { enumerable: true, get: function () { return http_response_1.HttpResponseBase; } });\r\nvar http_xhr_handler_1 = require(\"./http/http-xhr.handler\");\r\nObject.defineProperty(exports, \"HttpXhrHandler\", { enumerable: true, get: function () { return http_xhr_handler_1.HttpXhrHandler; } });\r\nvar http_service_1 = require(\"./http/http.service\");\r\nObject.defineProperty(exports, \"HttpService\", { enumerable: true, get: function () { return http_service_1.default; } });\r\n","import { Observable, Observer } from \"rxjs\";\n\nconst fs = require('fs');\n\nexport enum CacheMode {\n\tMemory = 'memory',\n\tFile = 'file',\n}\n\nexport enum CacheControlType {\n\tPublic = 'public', // The response may be stored by any cache, even if the response is normally non-cacheable.\n\tPrivate = 'private', // The response may be stored only by a browser's cache, even if the response is normally non-cacheable. If you mean to not store the response in any cache, use no-store instead. This directive is not effective in preventing caches from storing your response.\n\tNoCache = 'no-cache', // The response may be stored by any cache, even if the response is normally non-cacheable. However, the stored response MUST always go through validation with the origin server first before using it, therefore, you cannot use no-cache in-conjunction with immutable. If you mean to not store the response in any cache, use no-store instead. This directive is not effective in preventing caches from storing your response.\n\tNoStore = 'no-store', // The response may not be stored in any cache. Although other directives may be set, this alone is the only directive you need in preventing cached responses on modern browsers. max-age=0 is already implied. Setting must-revalidate does not make sense because in order to go through revalidation you need the response to be stored in a cache, which no-store prevents.\n}\n\nexport interface ICacheItem {\n\tvalue: any;\n\tdate?: Date,\n\tmaxAge?: number;\n\tcacheControl?: CacheControlType;\n}\n\nexport class CacheItem {\n\tvalue: any;\n\tdate: Date = new Date();\n\tmaxAge: number = 0;\n\tcacheControl: CacheControlType = CacheControlType.Public;\n\tget expired(): boolean {\n\t\treturn this.cacheControl === CacheControlType.NoStore\n\t\t\t|| this.maxAge === 0\n\t\t\t|| (this.date.getTime() + (this.maxAge * 1000) < Date.now());\n\t}\n\tconstructor(options?: ICacheItem) {\n\t\tif (options) {\n\t\t\tthis.value = options.value;\n\t\t\tthis.date = options.date ? new Date(options.date) : this.date;\n\t\t\tthis.maxAge = options.maxAge || this.maxAge;\n\t\t\tthis.cacheControl = options.cacheControl || this.cacheControl;\n\t\t}\n\t}\n}\n\nexport default class CacheService {\n\n\tprivate static cache_: Map<string, string> = new Map<string, string>();\n\tstatic mode: CacheMode = CacheMode.Memory;\n\tstatic folder: string;\n\n\tstatic has(type: string = 'cache', name: string): boolean {\n\t\tlet has: boolean = false;\n\t\tswitch (this.mode) {\n\t\t\tcase CacheMode.File:\n\t\t\t\thas = this.hasFile(type, name);\n\t\t\t\tbreak;\n\t\t\tcase CacheMode.Memory:\n\t\t\tdefault:\n\t\t\t\tconst key: string = `${type}_${name}`;\n\t\t\t\thas = this.cache_.has(key);\n\t\t}\n\t\treturn has;\n\t}\n\n\tstatic get(type: string = 'cache', name: string): any {\n\t\tlet value = null, cacheItem: CacheItem | null;\n\t\tconst key: string = `${type}_${name}`;\n\t\tswitch (this.mode) {\n\t\t\tcase CacheMode.File:\n\t\t\t\tif (this.hasFile(type, name)) {\n\t\t\t\t\tcacheItem = this.readFile(type, name);\n\t\t\t\t\tif (cacheItem) {\n\t\t\t\t\t\tif (cacheItem.expired) {\n\t\t\t\t\t\t\tthis.unlinkFile(type, name);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tvalue = cacheItem?.value;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase CacheMode.Memory:\n\t\t\tdefault:\n\t\t\t\tif (this.cache_.has(key)) {\n\t\t\t\t\tconst data: string | undefined = this.cache_.get(key);\n\t\t\t\t\tif (data) {\n\t\t\t\t\t\tcacheItem = new CacheItem(JSON.parse(data));\n\t\t\t\t\t\tif (cacheItem) {\n\t\t\t\t\t\t\tif (cacheItem.expired) {\n\t\t\t\t\t\t\t\tthis.cache_.delete(key);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tvalue = cacheItem.value;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t}\n\t\treturn value;\n\t}\n\n\tstatic set(type: string = 'cache', name: string, value: any, maxAge: number = 0): any {\n\t\tconst key: string = `${type}_${name}`;\n\t\tconst cacheItem: CacheItem = new CacheItem({ value, maxAge });\n\t\tswitch (this.mode) {\n\t\t\tcase CacheMode.File:\n\t\t\t\tthis.writeFile(type, name, cacheItem);\n\t\t\t\tbreak;\n\t\t\tcase CacheMode.Memory:\n\t\t\tdefault:\n\t\t\t\tconst serialized: string = this.serialize(cacheItem);\n\t\t\t\tconsole.log(serialized);\n\t\t\t\tthis.cache_.set(key, serialized);\n\t\t}\n\t\treturn value;\n\t}\n\n\tstatic delete(type: string = 'cache', name: string): void {\n\t\tswitch (this.mode) {\n\t\t\tcase CacheMode.File:\n\t\t\t\tthis.unlinkFile(type, name);\n\t\t\t\tbreak;\n\t\t\tcase CacheMode.Memory:\n\t\t\tdefault:\n\t\t\t\tconst key: string = `${type}_${name}`;\n\t\t\t\tif (this.cache_.has(key)) {\n\t\t\t\t\tthis.cache_.delete(key);\n\t\t\t\t}\n\t\t}\n\t}\n\n\tprotected static getPath(type: string = 'cache', name: string): string {\n\t\tconst regExp: RegExp = /(\\/|\\\\|\\:|\\?|\\#|\\&)+/g;\n\t\tlet path: string = `_${type}_${name}`;\n\t\t// console.log('path', path);\n\t\tpath = path.replace(regExp, function (substring: string, group: string) {\n\t\t\treturn encodeURIComponent(group);\n\t\t});\n\t\treturn `${this.folder}${path}`;\n\t}\n\n\tprotected static hasFile(type: string = 'cache', name: string): boolean {\n\t\tlet has: boolean = false;\n\t\tconst key: string = this.getPath(type, name);\n\t\ttry {\n\t\t\tif (fs.existsSync(key)) {\n\t\t\t\thas = true;\n\t\t\t}\n\t\t} catch (error) {\n\t\t\tthrow error;\n\t\t}\n\t\treturn has;\n\t}\n\n\tprotected static readFile(type: string = 'cache', name: string): CacheItem | null {\n\t\tlet cacheItem: CacheItem | null = null;\n\t\tconst key: string = this.getPath(type, name);\n\t\ttry {\n\t\t\tconst json: string = fs.readFileSync(key, 'utf8');\n\t\t\tcacheItem = new CacheItem(JSON.parse(json));\n\t\t} catch (error) {\n\t\t\tthrow error;\n\t\t}\n\t\treturn cacheItem;\n\t}\n\n\tprotected static writeFile(type: string = 'cache', name: string, cacheItem: CacheItem): CacheItem {\n\t\tconst key: string = this.getPath(type, name);\n\t\ttry {\n\t\t\tconst json: string = this.serialize(cacheItem);\n\t\t\tfs.writeFileSync(key, json, 'utf8');\n\t\t} catch (error) {\n\t\t\tthrow error;\n\t\t}\n\t\treturn cacheItem;\n\t}\n\n\tprotected static unlinkFile(type: string = 'cache', name: string): void {\n\t\tconst key: string = this.getPath(type, name);\n\t\ttry {\n\t\t\tif (fs.existsSync(key)) {\n\t\t\t\tfs.unlinkSync(key);\n\t\t\t}\n\t\t} catch (error) {\n\t\t\tthrow error;\n\t\t}\n\t}\n\n\tprotected static readFile$(type: string = 'cache', name: string): Observable<CacheItem> {\n\t\tconst service = this;\n\t\treturn Observable.create(function (observer: Observer<CacheItem>) {\n\t\t\tconst key: string = `${service.folder}_${type}_${name}`;\n\t\t\tfs.readFile(key, 'utf8', function (error: NodeJS.ErrnoException, json: string) {\n\t\t\t\tif (error) {\n\t\t\t\t\tobserver.error(error);\n\t\t\t\t} else {\n\t\t\t\t\tconst cacheItem: CacheItem = new CacheItem(JSON.parse(json));\n\t\t\t\t\tobserver.next(cacheItem);\n\t\t\t\t\tobserver.complete();\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t}\n\n\tprotected static writeFile$(type: string = 'cache', name: string, cacheItem: CacheItem): Observable<CacheItem> {\n\t\tconst service = this;\n\t\treturn Observable.create(function (observer: Observer<CacheItem>) {\n\t\t\tconst key: string = `${service.folder}_${type}_${name}`;\n\t\t\tconst json: string = service.serialize(cacheItem);\n\t\t\tfs.writeFile(key, json, 'utf8', function (error: NodeJS.ErrnoException) {\n\t\t\t\tif (error) {\n\t\t\t\t\tobserver.error(error);\n\t\t\t\t} else {\n\t\t\t\t\tobserver.next(cacheItem);\n\t\t\t\t\tobserver.complete();\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t}\n\n\tprotected static serialize(item: any): string {\n\t\tconst cache: Map<any, boolean> = new Map<any, boolean>();\n\t\tconst serialized: string = JSON.stringify(item, (key: string, value: any) => {\n\t\t\tif (value && typeof value === 'object') {\n\t\t\t\tif (cache.has(value)) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tcache.set(value, true);\n\t\t\t}\n\t\t\treturn value;\n\t\t}, 0);\n\t\tcache.clear();\n\t\treturn serialized;\n\t}\n\n}\n\n/*\nCache-Control: max-age=0, private, must-revalidate\nDate: Fri, 14 Aug 2020 20:09:02 GMT\nExpect-CT: max-age=2592000, report-uri=\"https://api.github.com/_private/browser/errors\"\nStatus: 200 OK\nStrict-Transport-Security: max-age=31536000; includeSubdomains; preload\nCache-Control: no-cache\nConnection: keep-alive\nPragma: no-cache\n*/\n","import { Parser } from 'htmlparser2';\r\nimport { ILocation, RxLocation } from '../location/location';\r\n\r\n// export const NO_CHILDS = ['title','base','meta','link','img','br','input',];\r\n// const SKIP = ['html','head','title','base','meta','script','link','body',];\r\n// document.createComment = nodeValue => { return new RxComment(null, nodeValue); };\r\n// document.createTextNode = nodeValue => { return new RxText(null, nodeValue); };\r\n\r\nexport enum RxNodeType {\r\n\tELEMENT_NODE = 1, //\tUn nodo Element come <p> o <div>.\r\n\tTEXT_NODE = 3, //\tL'attuale Text dentro un Element o Attr.\r\n\tCDATA_SECTION_NODE = 4, //\tUna CDATASection, ad esempio <!CDATA[[  ]]>.\r\n\tPROCESSING_INSTRUCTION_NODE = 7, //\tUna ProcessingInstruction di un documento XML, come <?xml-stylesheet  ?>.\r\n\tCOMMENT_NODE = 8, //\tUn nodo Comment, come <!--  -->.\r\n\tDOCUMENT_NODE = 9, //\tUn nodo Document.\r\n\tDOCUMENT_TYPE_NODE = 10, //\tUn nodo DocumentType, come <!DOCTYPE html>.\r\n\tDOCUMENT_FRAGMENT_NODE = 11, //\tUn nodo DocumentFragment.\r\n}\r\n\r\nexport enum SelectorType {\r\n\tNone = -1,\r\n\tId = 0,\r\n\tClass = 1,\r\n\tAttribute = 2,\r\n\tTagName = 3,\r\n}\r\n\r\nexport class RxSelector {\r\n\tselector: string = '';\r\n\ttype: SelectorType = SelectorType.None;\r\n\tnegate: boolean = false;\r\n\tconstructor(options: RxSelector) {\r\n\t\tif (options) {\r\n\t\t\tObject.assign(this, options);\r\n\t\t}\r\n\t}\r\n}\r\n\r\nexport class RxQuery {\r\n\tselector: string = '';\r\n\tselectors: RxSelector[] = [];\r\n\tinner: boolean = false;\r\n\tconstructor(options: RxQuery) {\r\n\t\tif (options) {\r\n\t\t\tObject.assign(this, options);\r\n\t\t}\r\n\t}\r\n}\r\n\r\nexport class RxNode {\r\n\tparentNode: RxElement | null;\r\n\tnodeType: RxNodeType;\r\n\tnodeValue: string | null = null;\r\n\r\n\tconstructor(parentNode: RxElement | null = null) {\r\n\t\tthis.parentNode = parentNode;\r\n\t\tthis.nodeType = -1;\r\n\t}\r\n\tcloneNode(deep: boolean = false) {\r\n\t\treturn cloneNode.apply(this, [this, deep]);\r\n\t}\r\n\tserialize(): string {\r\n\t\treturn ``;\r\n\t}\r\n}\r\n\r\nexport class RxStyle {\r\n\t[key: string]: any;\r\n\titem(index: number): string | undefined {\r\n\t\tconst keys = Object.keys(this);\r\n\t\tif (keys.length > index) {\r\n\t\t\treturn keys[index];\r\n\t\t} else {\r\n\t\t\treturn undefined;\r\n\t\t}\r\n\t}\r\n\tgetPropertyPriority(key: string): string {\r\n\t\tconst value = this[key];\r\n\t\tif (value && value.indexOf('!important')) {\r\n\t\t\treturn 'important';\r\n\t\t} else {\r\n\t\t\treturn '';\r\n\t\t}\r\n\t}\r\n\tgetPropertyValue(key: string): string {\r\n\t\treturn this[key];\r\n\t}\r\n\tsetProperty(key: string, value: string, important: 'important' | '' | undefined) {\r\n\t\tthis[key] = value + (important === 'important' ? '!important' : '');\r\n\t\tthis.serialize_();\r\n\t}\r\n\tremoveProperty(key: string) {\r\n\t\tdelete this[key];\r\n\t\tthis.serialize_();\r\n\t}\r\n\tprivate serialize_() {\r\n\t\tthis.node.attributes.style = Object.keys(this).map(key => {\r\n\t\t\treturn `${key}: ${this[key]};`;\r\n\t\t}).join(' ');\r\n\t}\r\n\tinit() {\r\n\t\tconst keys = Object.keys(this);\r\n\t\tkeys.forEach(key => delete this[key]);\r\n\t\tif (this.node.attributes?.style) {\r\n\t\t\tconst regex: RegExp = /([^:]+):([^;]+);?\\s*/gm\r\n\t\t\tconst matches: RegExpMatchArray[] = [...this.node.attributes.style.matchAll(regex)];\r\n\t\t\tmatches.forEach((match: RegExpMatchArray) => {\r\n\t\t\t\tconst key: string = match[1];\r\n\t\t\t\tconst value: string = match[2];\r\n\t\t\t\tthis[key] = value;\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\tconstructor(node: RxElement) {\r\n\t\tObject.defineProperty(this, 'node', {\r\n\t\t\tvalue: node,\r\n\t\t\twritable: false,\r\n\t\t\tenumerable: false\r\n\t\t});\r\n\t\tthis.init();\r\n\t}\r\n}\r\n\r\nexport class RxClassList extends Array<string> {\r\n\tnode: RxElement;\r\n\titem(index: number) {\r\n\t\treturn this[index];\r\n\t}\r\n\tcontains(name: string): boolean {\r\n\t\treturn this.indexOf(name) !== -1;\r\n\t}\r\n\tadd(...names: string[]) {\r\n\t\tnames.forEach(name => {\r\n\t\t\tif (this.indexOf(name) !== -1) {\r\n\t\t\t\tthis.push(name);\r\n\t\t\t}\r\n\t\t});\r\n\t\tthis.serialize_();\r\n\t}\r\n\tremove(...names: string[]) {\r\n\t\tnames.forEach(name => {\r\n\t\t\tconst index: number = this.indexOf(name);\r\n\t\t\tif (index !== -1) {\r\n\t\t\t\tthis.splice(index, 1);\r\n\t\t\t}\r\n\t\t});\r\n\t\tthis.serialize_();\r\n\t}\r\n\ttoggle(name: string, force?: boolean): boolean {\r\n\t\tconst index: number = this.indexOf(name);\r\n\t\tif (force === false) {\r\n\t\t\tthis.splice(index, 1);\r\n\t\t\tthis.serialize_();\r\n\t\t\treturn false;\r\n\t\t} else if (force === true) {\r\n\t\t\tthis.push(name);\r\n\t\t\tthis.serialize_();\r\n\t\t\treturn true;\r\n\t\t} else if (index !== -1) {\r\n\t\t\tthis.splice(index, 1);\r\n\t\t\tthis.serialize_();\r\n\t\t\treturn false;\r\n\t\t} else {\r\n\t\t\tthis.push(name);\r\n\t\t\tthis.serialize_();\r\n\t\t\treturn true;\r\n\t\t}\r\n\t}\r\n\treplace(oldClass: string, newClass: string) {\r\n\t\tconst index: number = this.indexOf(oldClass);\r\n\t\tif (index !== -1) {\r\n\t\t\tthis.splice(index, 1);\r\n\t\t}\r\n\t\tthis.push(newClass);\r\n\t\tthis.serialize_();\r\n\t}\r\n\tprivate serialize_() {\r\n\t\tthis.node.attributes.class = this.join(' ');\r\n\t}\r\n\tinit() {\r\n\t\tthis.length = 0;\r\n\t\tif (this.node.attributes?.class) {\r\n\t\t\tArray.prototype.push.apply(this, this.node.attributes.class.split(' ').map(name => name.trim()));\r\n\t\t}\r\n\t}\r\n\tconstructor(node: RxElement) {\r\n\t\tsuper();\r\n\t\tthis.node = node;\r\n\t\tthis.init();\r\n\t}\r\n}\r\n\r\nexport class RxElement extends RxNode {\r\n\tnodeName: string;\r\n\tchildNodes: RxNode[];\r\n\tattributes: { [key: string]: string | null } = {};\r\n\tstyle: RxStyle;\r\n\tclassList: RxClassList;\r\n\tget children(): RxElement[] {\r\n\t\tlet children: RxElement[] = [],\r\n\t\t\ti = 0,\r\n\t\t\tnode,\r\n\t\t\tnodes = this.childNodes;\r\n\t\tnode = nodes[i++];\r\n\t\twhile (node) {\r\n\t\t\tnode = nodes[i++];\r\n\t\t\tif (node.nodeType === RxNodeType.ELEMENT_NODE) {\r\n\t\t\t\tchildren.push(node as RxElement);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn children;\r\n\t}\r\n\tget childElementCount(): number {\r\n\t\tlet i = 0,\r\n\t\t\tcount = 0,\r\n\t\t\tnode,\r\n\t\t\tnodes = this.childNodes;\r\n\t\tnode = nodes[i++];\r\n\t\twhile (node) {\r\n\t\t\tif (node.nodeType === RxNodeType.ELEMENT_NODE) {\r\n\t\t\t\tcount++;\r\n\t\t\t}\r\n\t\t\tnode = nodes[i++];\r\n\t\t}\r\n\t\treturn count;\r\n\t}\r\n\tget firstChild(): RxNode | null {\r\n\t\tlet node = null;\r\n\t\tif (this.childNodes.length) {\r\n\t\t\tnode = this.childNodes[0];\r\n\t\t}\r\n\t\treturn node;\r\n\t}\r\n\tget firstElementChild(): RxElement | null {\r\n\t\tfor (let node of this.childNodes) {\r\n\t\t\tif (isRxElement(node)) {\r\n\t\t\t\treturn node;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn null;\r\n\t}\r\n\tget lastChild(): RxNode | null {\r\n\t\tlet node = null;\r\n\t\tif (this.childNodes.length) {\r\n\t\t\tnode = this.childNodes[this.childNodes.length - 1];\r\n\t\t}\r\n\t\treturn node;\r\n\t}\r\n\tget lastElementChild(): RxElement | null {\r\n\t\tconst nodes = this.childNodes;\r\n\t\tfor (let i = nodes.length - 1; i > -1; i--) {\r\n\t\t\tconst node = nodes[i];\r\n\t\t\tif (isRxElement(node)) {\r\n\t\t\t\treturn node;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn null;\r\n\t}\r\n\tget previousSibling(): RxNode | null {\r\n\t\tlet node = null;\r\n\t\tif (this.parentNode) {\r\n\t\t\tconst index = this.parentNode.childNodes.indexOf(this);\r\n\t\t\tif (index > 0) {\r\n\t\t\t\tnode = this.parentNode.childNodes[index - 1];\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn node;\r\n\t}\r\n\tget nextSibling(): RxNode | null {\r\n\t\tlet node = null;\r\n\t\tif (this.parentNode) {\r\n\t\t\tconst index = this.parentNode.childNodes.indexOf(this);\r\n\t\t\tif (index !== -1 && index < this.parentNode.childNodes.length - 1) {\r\n\t\t\t\tnode = this.parentNode.childNodes[index];\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn node;\r\n\t}\r\n\tget wholeText() {\r\n\t\tlet nodeValue;\r\n\t\tif (this.nodeType === RxNodeType.TEXT_NODE) {\r\n\t\t\treturn this.nodeValue;\r\n\t\t}\r\n\t\treturn nodeValue;\r\n\t}\r\n\tget outerHTML(): string | null {\r\n\t\tlet html = null;\r\n\t\tif (this.parentNode) {\r\n\t\t\thtml = this.parentNode.serialize();\r\n\t\t}\r\n\t\treturn html;\r\n\t}\r\n\tset innerText(nodeValue: string | null) {\r\n\t\tthis.childNodes = [new RxText(this, nodeValue)];\r\n\t}\r\n\tget innerText(): string | null {\r\n\t\t// return this.childNodes.filter((n): n is RxText => isRxText(n)).map(n => n.innerText).join('');\r\n\t\treturn this.childNodes.filter((n): n is RxText | RxElement => isRxText(n) || isRxElement(n)).map(n => n.innerText).join('');\r\n\t}\r\n\tset textContent(nodeValue: string | null) {\r\n\t\tthis.innerText = String(nodeValue);\r\n\t}\r\n\tget textContent(): string | null {\r\n\t\treturn this.innerText;\r\n\t}\r\n\tget innerHTML(): string {\r\n\t\treturn this.childNodes.map(x => x.serialize()).join('');\r\n\t}\r\n\tset innerHTML(html: string) {\r\n\t\tconst doc = parse(html);\r\n\t\tconst childNodes = doc.childNodes.map(n => {\r\n\t\t\tn.parentNode = this;\r\n\t\t\treturn n;\r\n\t\t});\r\n\t\tthis.childNodes = childNodes;\r\n\t}\r\n\tconstructor(parentNode: RxElement | null = null, nodeName: string, attributes: { [key: string]: string | null } | null = null) {\r\n\t\tsuper(parentNode);\r\n\t\tthis.nodeType = RxNodeType.ELEMENT_NODE;\r\n\t\tthis.nodeName = nodeName;\r\n\t\tif (attributes && typeof attributes === 'object') {\r\n\t\t\tthis.attributes = attributes;\r\n\t\t}\r\n\t\tthis.style = new RxStyle(this);\r\n\t\tthis.classList = new RxClassList(this);\r\n\t\tthis.childNodes = [];\r\n\t\t/*\r\n\t\t\tif (SKIP.indexOf(nodeName) === -1) {\r\n\t\t\t\tconsole.log(parentNode.nodeName, '>', nodeName);\r\n\t\t}\r\n\t\t*/\r\n\t}\r\n\tappend(...nodesOrDOMStrings: (RxNode | string)[]) {\r\n\t\tnodesOrDOMStrings = nodesOrDOMStrings.map(nodeOrDomString => {\r\n\t\t\tlet node;\r\n\t\t\tif (typeof nodeOrDomString === 'string') {\r\n\t\t\t\tnode = new RxText(this, nodeOrDomString);\r\n\t\t\t} else {\r\n\t\t\t\tnode = nodeOrDomString;\r\n\t\t\t\tnode.parentNode = this;\r\n\t\t\t}\r\n\t\t\treturn node;\r\n\t\t});\r\n\t\tArray.prototype.push.apply(this.childNodes, nodesOrDOMStrings);\r\n\t\t/*\r\n\t\tfor (let nodeOrDomString of nodesOrDOMStrings) {\r\n\t\t\t\tlet node;\r\n\t\t\t\tif (typeof nodeOrDomString === 'string') {\r\n\t\t\t\t\tnode = new RxText(this, nodeOrDomString);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tnode = nodeOrDomString;\r\n\t\t\t\t}\r\n\t\t\t\tthis.childNodes.push(node);\r\n\t\t}\r\n\t\t*/\r\n\t}\r\n\tprepend(...nodesOrDOMStrings: (RxNode | string)[]) {\r\n\t\tnodesOrDOMStrings = nodesOrDOMStrings.map(nodeOrDomString => {\r\n\t\t\tlet node;\r\n\t\t\tif (typeof nodeOrDomString === 'string') {\r\n\t\t\t\tnode = new RxText(this, nodeOrDomString);\r\n\t\t\t} else {\r\n\t\t\t\tnode = nodeOrDomString;\r\n\t\t\t\tnode.parentNode = this;\r\n\t\t\t}\r\n\t\t\treturn node;\r\n\t\t});\r\n\t\tArray.prototype.unshift.apply(this.childNodes, nodesOrDOMStrings);\r\n\t\t/*\r\n\t\t\tfor (let nodeOrDomString of nodesOrDOMStrings) {\r\n\t\t\t\tlet node;\r\n\t\t\t\tif (typeof nodeOrDomString === 'string') {\r\n\t\t\t\t\tnode = new RxText(this, nodeOrDomString);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tnode = nodeOrDomString;\r\n\t\t\t\t}\r\n\t\t\t\tthis.childNodes.unshift(node);\r\n\t\t}\r\n\t\t*/\r\n\t}\r\n\treplaceChildren(...nodesOrDOMStrings: (RxNode | string)[]) {\r\n\t\tconst nodes: RxNode[] = nodesOrDOMStrings.map((nodeOrDomString) => {\r\n\t\t\tlet node: RxNode;\r\n\t\t\tif (typeof nodeOrDomString === 'string') {\r\n\t\t\t\tnode = new RxText(this, nodeOrDomString);\r\n\t\t\t} else {\r\n\t\t\t\tnode = nodeOrDomString as RxNode;\r\n\t\t\t\tnode.parentNode = this;\r\n\t\t\t}\r\n\t\t\treturn node;\r\n\t\t});\r\n\t\tthis.childNodes = nodes;\r\n\t}\r\n\tquerySelectorAll(selector: string): RxNode[] | null {\r\n\t\tconst queries = getQueries(selector);\r\n\t\tconst nodes = this.childNodes.filter(x => {\r\n\t\t\treturn true;\r\n\t\t});\r\n\t\tconsole.log(queries);\r\n\t\treturn nodes.length ? nodes : null;\r\n\t}\r\n\tquerySelector(selector: string): RxNode | null {\r\n\t\tconst queries = getQueries(selector);\r\n\t\tconst node = querySelector(queries, this.childNodes);\r\n\t\treturn node;\r\n\t}\r\n\thasAttribute(attribute: string): boolean {\r\n\t\treturn Object.keys(this.attributes).indexOf(attribute.toLowerCase()) !== -1;\r\n\t}\r\n\tgetAttribute(attribute: string): string | null {\r\n\t\treturn this.attributes[attribute.toLowerCase()] || null;\r\n\t}\r\n\tsetAttribute(attribute: string, value: any) {\r\n\t\tthis.attributes[attribute.toLowerCase()] = value.toString();\r\n\t\tif (attribute === 'style') {\r\n\t\t\tthis.style.init();\r\n\t\t} else if (attribute === 'class') {\r\n\t\t\tthis.classList.init();\r\n\t\t}\r\n\t}\r\n\tremoveAttribute(attribute: string) {\r\n\t\tdelete this.attributes[attribute];\r\n\t\tif (attribute === 'style') {\r\n\t\t\tthis.style.init();\r\n\t\t} else if (attribute === 'class') {\r\n\t\t\tthis.classList.init();\r\n\t\t}\r\n\t}\r\n\treplaceChild(newChild: RxNode, oldChild: RxNode): RxNode {\r\n\t\tconst index = this.childNodes.indexOf(oldChild);\r\n\t\tif (index !== -1) {\r\n\t\t\tthis.childNodes[index] = newChild;\r\n\t\t\tnewChild.parentNode = this;\r\n\t\t}\r\n\t\t// console.log('replaceChild', this, newChild, oldChild);\r\n\t\treturn oldChild;\r\n\t}\r\n\tremoveChild(child: RxNode): RxNode {\r\n\t\tif (!(child instanceof RxNode)) {\r\n\t\t\tthrow new Error(`Uncaught TypeError: Failed to execute 'removeChild' on 'Node': parameter 1 is not of type 'Node'.`);\r\n\t\t}\r\n\t\tconst index = this.childNodes.indexOf(child);\r\n\t\tif (index === -1) {\r\n\t\t\tthrow new Error(`Uncaught NotFoundError: Failed to execute 'removeChild' on 'Node': The node to be removed is not a child of this node.`);\r\n\t\t}\r\n\t\tthis.childNodes.splice(index, 1);\r\n\t\t// console.log('removeChild', this.childNodes.length);\r\n\t\treturn child;\r\n\t}\r\n\tinsertBefore(newNode: RxNode, referenceNode: RxNode | null = null): RxNode {\r\n\t\tconst index = referenceNode\r\n\t\t\t? this.childNodes.indexOf(referenceNode)\r\n\t\t\t: this.childNodes.length;\r\n\t\tif (index !== -1) {\r\n\t\t\tthis.childNodes.splice(index, 0, newNode);\r\n\t\t\tnewNode.parentNode = this;\r\n\t\t}\r\n\t\t// console.log('insertBefore', this, newNode, referenceNode);\r\n\t\treturn newNode;\r\n\t}\r\n\tcloneNode(deep: boolean = false): RxNode {\r\n\t\treturn cloneNode.apply(this, [this, deep]);\r\n\t}\r\n\taddListener(eventName: string, handler: (e: any) => {}) { }\r\n\tremoveListener(eventName: string, handler: (e: any) => {}) { }\r\n\tserialize(): string {\r\n\t\treturn `<${\r\n\t\t\tthis.nodeName\r\n\t\t\t}${this.serializeAttributes()}>${this.childNodes\r\n\t\t\t\t.map(x => x.serialize())\r\n\t\t\t\t.join('')}</${this.nodeName}>`;\r\n\t}\r\n\tserializeAttributes(): string {\r\n\t\tlet attributes = '';\r\n\t\tconst keys = Object.keys(this.attributes);\r\n\t\tif (keys.length) {\r\n\t\t\tattributes =\r\n\t\t\t\t' ' +\r\n\t\t\t\tkeys\r\n\t\t\t\t\t.map(k => {\r\n\t\t\t\t\t\treturn `${k}=\"${this.attributes[k]}\"`;\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.join(' ');\r\n\t\t}\r\n\t\treturn attributes;\r\n\t}\r\n}\r\n\r\nexport class RxText extends RxNode {\r\n\tnodeValue: string;\r\n\tget outerHTML(): string | null {\r\n\t\tlet html = null;\r\n\t\tif (this.parentNode) {\r\n\t\t\thtml = this.parentNode.serialize();\r\n\t\t}\r\n\t\treturn html;\r\n\t}\r\n\tget wholeText(): string | null {\r\n\t\treturn this.nodeValue;\r\n\t}\r\n\tset innerText(nodeValue) {\r\n\t\tthis.nodeValue = String(nodeValue);\r\n\t}\r\n\tget innerText(): string | null {\r\n\t\treturn this.nodeValue;\r\n\t}\r\n\tset textContent(nodeValue) {\r\n\t\tthis.nodeValue = String(nodeValue);\r\n\t}\r\n\tget textContent(): string | null {\r\n\t\treturn this.nodeValue;\r\n\t}\r\n\tconstructor(parentNode: RxElement | null = null, nodeValue: any) {\r\n\t\tsuper(parentNode);\r\n\t\tthis.nodeType = RxNodeType.TEXT_NODE;\r\n\t\tthis.nodeValue = String(nodeValue);\r\n\t\t// console.log('RxText', nodeValue);\r\n\t}\r\n\tserialize(): string {\r\n\t\treturn this.nodeValue;\r\n\t}\r\n}\r\n\r\nexport class RxCData extends RxNode {\r\n\tnodeValue: string;\r\n\tget outerHTML(): string | null {\r\n\t\tlet html = null;\r\n\t\tif (this.parentNode) {\r\n\t\t\thtml = this.parentNode.serialize();\r\n\t\t}\r\n\t\treturn html;\r\n\t}\r\n\tget wholeText(): string | null {\r\n\t\treturn this.nodeValue;\r\n\t}\r\n\tset innerText(nodeValue) {\r\n\t\tthis.nodeValue = String(nodeValue);\r\n\t}\r\n\tget innerText(): string | null {\r\n\t\treturn this.nodeValue;\r\n\t}\r\n\tset textContent(nodeValue) {\r\n\t\tthis.nodeValue = String(nodeValue);\r\n\t}\r\n\tget textContent(): string | null {\r\n\t\treturn this.nodeValue;\r\n\t}\r\n\tconstructor(parentNode: RxElement | null = null, nodeValue: any) {\r\n\t\tsuper(parentNode);\r\n\t\tthis.nodeType = RxNodeType.CDATA_SECTION_NODE;\r\n\t\tthis.nodeValue = String(nodeValue);\r\n\t}\r\n\tserialize(): string {\r\n\t\treturn this.nodeValue;\r\n\t}\r\n}\r\n\r\nexport class RxComment extends RxNode {\r\n\tnodeValue: string;\r\n\tget outerHTML(): string | null {\r\n\t\tlet html = null;\r\n\t\tif (this.parentNode) {\r\n\t\t\thtml = this.parentNode.serialize();\r\n\t\t}\r\n\t\treturn html;\r\n\t}\r\n\tget wholeText(): string | null {\r\n\t\treturn this.nodeValue;\r\n\t}\r\n\tset innerText(nodeValue) {\r\n\t\tthis.nodeValue = String(nodeValue);\r\n\t}\r\n\tget innerText(): string | null {\r\n\t\treturn this.nodeValue;\r\n\t}\r\n\tset textContent(nodeValue) {\r\n\t\tthis.nodeValue = String(nodeValue);\r\n\t}\r\n\tget textContent(): string | null {\r\n\t\treturn this.nodeValue;\r\n\t}\r\n\tconstructor(parentNode: RxElement | null = null, nodeValue: any) {\r\n\t\tsuper(parentNode);\r\n\t\tthis.nodeType = RxNodeType.COMMENT_NODE;\r\n\t\tthis.nodeValue = String(nodeValue);\r\n\t}\r\n\tserialize(): string {\r\n\t\treturn `<!--${this.nodeValue}-->`;\r\n\t}\r\n}\r\n\r\nexport class RxProcessingInstruction extends RxNode {\r\n\tconstructor(parentNode: RxElement | null = null, nodeValue: any) {\r\n\t\tsuper(parentNode);\r\n\t\tthis.nodeType = RxNodeType.PROCESSING_INSTRUCTION_NODE;\r\n\t\tthis.nodeValue = String(nodeValue);\r\n\t}\r\n\tserialize(): string {\r\n\t\treturn `<${this.nodeValue}>`;\r\n\t}\r\n}\r\n\r\nexport class RxDocumentType extends RxNode {\r\n\tconstructor(parentNode: RxElement | null = null, nodeValue: any) {\r\n\t\tsuper(parentNode);\r\n\t\tthis.nodeType = RxNodeType.DOCUMENT_TYPE_NODE;\r\n\t\tthis.nodeValue = String(nodeValue);\r\n\t}\r\n\tserialize(): string {\r\n\t\treturn `<${this.nodeValue}>`;\r\n\t}\r\n}\r\n\r\nexport class RxDocumentFragment extends RxElement {\r\n\tconstructor() {\r\n\t\tsuper(null, '#document-fragment');\r\n\t\tthis.nodeType = RxNodeType.DOCUMENT_FRAGMENT_NODE;\r\n\t\tthis.childNodes = [];\r\n\t}\r\n}\r\n\r\n// !!! TODO\r\n// Any web page loaded in the browser and serves as an entry point into the web page's content, which is the DOM tree.//\r\n// interface Document extends Node, DocumentAndElementEventHandlers, DocumentOrShadowRoot, GlobalEventHandlers, NonElementParentNode, ParentNode, XPathEvaluatorBase {\r\nexport interface IDocument extends Document {\r\n\t/*\r\n\treadonly URL: string; // Sets or gets the URL for the current document.\r\n\treadonly characterSet: string; // Returns document's encoding.\r\n\treadonly charset: string; // Gets or sets the character set used to encode the object.\r\n\treadonly compatMode: string; // Gets a value that indicates whether standards-compliant mode is switched on for the object.\r\n\treadonly contentType: string; // Returns document's content type.\r\n\treadonly currentScript: HTMLOrSVGScriptElement | null; // Returns the script element, or the SVG script element, that is currently executing, as long as the element represents a classic script. In the case of reentrant script execution, returns the one that most recently started executing amongst those that have not yet finished executing.\r\n\treadonly defaultView: (WindowProxy & typeof globalThis) | null; // Returns null if the Document is not currently executing a script or SVG script element (e.g., because the running script is an event handler, or a timeout), or if the currently executing script or SVG script element represents a module script.\r\n\treadonly doctype: DocumentType | null; // Gets an object representing the document type declaration associated with the current document.\r\n\treadonly documentElement: HTMLElement; // Gets a reference to the root node of the document.\r\n\treadonly documentURI: string; // Returns document's URL.\r\n\treadonly embeds: HTMLCollectionOf<HTMLEmbedElement>; // Retrieves a collection of all embed objects in the document.\r\n\treadonly forms: HTMLCollectionOf<HTMLFormElement>; // Retrieves a collection, in source order, of all form objects in the document.\r\n\treadonly fullscreenEnabled: boolean; // Returns true if document has the ability to display elements fullscreen and fullscreen is supported, or false otherwise.\r\n\treadonly head: HTMLHeadElement; // Returns the head element.\r\n\treadonly hidden: boolean;\r\n\treadonly images: HTMLCollectionOf<HTMLImageElement>; // Retrieves a collection, in source order, of img objects in the document.\r\n\treadonly implementation: DOMImplementation; // Gets the implementation object of the current document.\r\n\treadonly inputEncoding: string; // Returns the character encoding used to create the webpage that is loaded into the document object.\r\n\treadonly lastModified: string; // Gets the date that the page was last modified, if the page supplies one.\r\n\treadonly links: HTMLCollectionOf<HTMLAnchorElement | HTMLAreaElement>; // Retrieves a collection of all a objects that specify the href property and all area objects in the document.\r\n\treadonly origin: string; // Returns document's origin.\r\n\treadonly ownerDocument: null;\r\n\treadonly plugins: HTMLCollectionOf<HTMLEmbedElement>; // Return an HTMLCollection of the embed elements in the Document.\r\n\treadonly readyState: DocumentReadyState; // Retrieves a value that indicates the current state of the object.\r\n\treadonly referrer: string; // Gets the URL of the location that referred the user to the current page.\r\n\treadonly scripts: HTMLCollectionOf<HTMLScriptElement>; // Retrieves a collection of all script objects in the document.\r\n\treadonly scrollingElement: Element | null;\r\n\treadonly timeline: DocumentTimeline;\r\n\treadonly visibilityState: VisibilityState;\r\n\tbody: HTMLElement; // Specifies the beginning and end of the document body.\r\n\tcookie: string; // Returns the HTTP cookies that apply to the Document. If there are no cookies or cookies can't be applied to this resource, the empty string will be returned.\r\n\t// Can be set, to add a new cookie to the element's set of HTTP cookies.\r\n\t// If the contents are sandboxed into a unique origin (e.g. in an iframe with the sandbox attribute), a \"SecurityError\" DOMException will be thrown on getting and setting.\r\n\tdesignMode: string; // Sets or gets a value that indicates whether the document can be edited.\r\n\tdir: string; // Sets or retrieves a value that indicates the reading order of the object.\r\n\tdomain: string; // Sets or gets the security domain of the document.\r\n\tlocation: Location; // Contains information about the current URL.\r\n\ttitle: string; // Contains the title of the document.\r\n\t// METHODS\r\n\tonfullscreenchange: ((this: Document, ev: Event) => any) | null;\r\n\tonfullscreenerror: ((this: Document, ev: Event) => any) | null;\r\n\tonpointerlockchange: ((this: Document, ev: Event) => any) | null;\r\n\tonpointerlockerror: ((this: Document, ev: Event) => any) | null;\r\n\tonreadystatechange: ((this: Document, ev: Event) => any) | null; // Fires when the state of the object has changed.\r\n\t// @param ev The event\r\n\tonvisibilitychange: ((this: Document, ev: Event) => any) | null;\r\n\tadoptNode<T extends Node>(source: T): T; // Moves node from another document and returns it.\r\n\t// If node is a document, throws a \"NotSupportedError\" DOMException or, if node is a shadow root, throws a \"HierarchyRequestError\" DOMException.\r\n\tcaretPositionFromPoint(x: number, y: number): CaretPosition | null;\r\n\tclose(): void; // Closes an output stream and forces the sent data to display.\r\n\tcreateAttribute(localName: string): Attr; // Creates an attribute object with a specified name.\r\n\t// @param name String that sets the attribute object's name.\r\n\tcreateAttributeNS(namespace: string | null, qualifiedName: string): Attr;\r\n\tcreateCDATASection(data: string): CDATASection; // Returns a CDATASection node whose data is data.\r\n\tcreateComment(data: string): Comment; // Creates a comment object with the specified data.\r\n\t// @param data Sets the comment object's data.\r\n\tcreateDocumentFragment(): DocumentFragment; // Creates a new document.\r\n\tcreateElement<K extends keyof HTMLElementTagNameMap>(tagName: K, options?: ElementCreationOptions): HTMLElementTagNameMap[K]; // Creates an instance of the element for the specified tag.\r\n\t// @param tagName The name of an element.\r\n\t// @deprecated\r\n\t// createElement<K extends keyof HTMLElementDeprecatedTagNameMap>(tagName: K, options?: ElementCreationOptions): HTMLElementDeprecatedTagNameMap[K];\r\n\tcreateElement(tagName: string, options?: ElementCreationOptions): HTMLElement;\r\n\tcreateElementNS(namespaceURI: 'http://www.w3.org/1999/xhtml', qualifiedName: string): HTMLElement;\r\n\tcreateElementNS<K extends keyof SVGElementTagNameMap>(namespaceURI: 'http://www.w3.org/2000/svg', qualifiedName: K): SVGElementTagNameMap[K];\r\n\tcreateElementNS(namespaceURI: 'http://www.w3.org/2000/svg', qualifiedName: string): SVGElement;\r\n\tcreateElementNS(namespaceURI: string | null, qualifiedName: string, options?: ElementCreationOptions): Element;\r\n\tcreateElementNS(namespace: string | null, qualifiedName: string, options?: string | ElementCreationOptions): Element; // Returns an element with namespace namespace. Its namespace prefix will be everything before \":\" (U+003E) in qualifiedName or null. Its local name will be everything after \":\" (U+003E) in qualifiedName or qualifiedName.\r\n\t// If localName does not match the Name production an 'InvalidCharacterError' DOMException will be thrown.\r\n\t// If one of the following conditions is true a 'NamespaceError' DOMException will be thrown:\r\n\t// localName does not match the QName production.\r\n\t// Namespace prefix is not null and namespace is the empty string.\r\n\t// Namespace prefix is 'xml' and namespace is not the XML namespace.\r\n\t// qualifiedName or namespace prefix is 'xmlns' and namespace is not the XMLNS namespace.\r\n\t// namespace is the XMLNS namespace and neither qualifiedName nor namespace prefix is 'xmlns'.\r\n\t// When supplied, options's is can be used to create a customized built-in element.\r\n\tcreateEvent(eventInterface: 'AnimationEvent'): AnimationEvent;\r\n\tcreateEvent(eventInterface: 'AnimationPlaybackEvent'): AnimationPlaybackEvent;\r\n\tcreateEvent(eventInterface: 'AudioProcessingEvent'): AudioProcessingEvent;\r\n\tcreateEvent(eventInterface: 'BeforeUnloadEvent'): BeforeUnloadEvent;\r\n\tcreateEvent(eventInterface: 'ClipboardEvent'): ClipboardEvent;\r\n\tcreateEvent(eventInterface: 'CloseEvent'): CloseEvent;\r\n\tcreateEvent(eventInterface: 'CompositionEvent'): CompositionEvent;\r\n\tcreateEvent(eventInterface: 'CustomEvent'): CustomEvent;\r\n\tcreateEvent(eventInterface: 'DeviceLightEvent'): DeviceLightEvent;\r\n\tcreateEvent(eventInterface: 'DeviceMotionEvent'): DeviceMotionEvent;\r\n\tcreateEvent(eventInterface: 'DeviceOrientationEvent'): DeviceOrientationEvent;\r\n\tcreateEvent(eventInterface: 'DragEvent'): DragEvent;\r\n\tcreateEvent(eventInterface: 'ErrorEvent'): ErrorEvent;\r\n\tcreateEvent(eventInterface: 'Event'): Event;\r\n\tcreateEvent(eventInterface: 'Events'): Event;\r\n\tcreateEvent(eventInterface: 'FocusEvent'): FocusEvent;\r\n\tcreateEvent(eventInterface: 'FocusNavigationEvent'): FocusNavigationEvent;\r\n\tcreateEvent(eventInterface: 'GamepadEvent'): GamepadEvent;\r\n\tcreateEvent(eventInterface: 'HashChangeEvent'): HashChangeEvent;\r\n\tcreateEvent(eventInterface: 'IDBVersionChangeEvent'): IDBVersionChangeEvent;\r\n\tcreateEvent(eventInterface: 'InputEvent'): InputEvent;\r\n\tcreateEvent(eventInterface: 'KeyboardEvent'): KeyboardEvent;\r\n\tcreateEvent(eventInterface: 'ListeningStateChangedEvent'): ListeningStateChangedEvent;\r\n\tcreateEvent(eventInterface: 'MSGestureEvent'): MSGestureEvent;\r\n\tcreateEvent(eventInterface: 'MSMediaKeyMessageEvent'): MSMediaKeyMessageEvent;\r\n\tcreateEvent(eventInterface: 'MSMediaKeyNeededEvent'): MSMediaKeyNeededEvent;\r\n\tcreateEvent(eventInterface: 'MSPointerEvent'): MSPointerEvent;\r\n\tcreateEvent(eventInterface: 'MediaEncryptedEvent'): MediaEncryptedEvent;\r\n\tcreateEvent(eventInterface: 'MediaKeyMessageEvent'): MediaKeyMessageEvent;\r\n\tcreateEvent(eventInterface: 'MediaQueryListEvent'): MediaQueryListEvent;\r\n\tcreateEvent(eventInterface: 'MediaStreamErrorEvent'): MediaStreamErrorEvent;\r\n\tcreateEvent(eventInterface: 'MediaStreamEvent'): MediaStreamEvent;\r\n\tcreateEvent(eventInterface: 'MediaStreamTrackEvent'): MediaStreamTrackEvent;\r\n\tcreateEvent(eventInterface: 'MessageEvent'): MessageEvent;\r\n\tcreateEvent(eventInterface: 'MouseEvent'): MouseEvent;\r\n\tcreateEvent(eventInterface: 'MouseEvents'): MouseEvent;\r\n\tcreateEvent(eventInterface: 'MutationEvent'): MutationEvent;\r\n\tcreateEvent(eventInterface: 'MutationEvents'): MutationEvent;\r\n\tcreateEvent(eventInterface: 'OfflineAudioCompletionEvent'): OfflineAudioCompletionEvent;\r\n\tcreateEvent(eventInterface: 'OverflowEvent'): OverflowEvent;\r\n\tcreateEvent(eventInterface: 'PageTransitionEvent'): PageTransitionEvent;\r\n\tcreateEvent(eventInterface: 'PaymentRequestUpdateEvent'): PaymentRequestUpdateEvent;\r\n\tcreateEvent(eventInterface: 'PermissionRequestedEvent'): PermissionRequestedEvent;\r\n\tcreateEvent(eventInterface: 'PointerEvent'): PointerEvent;\r\n\tcreateEvent(eventInterface: 'PopStateEvent'): PopStateEvent;\r\n\tcreateEvent(eventInterface: 'ProgressEvent'): ProgressEvent;\r\n\tcreateEvent(eventInterface: 'PromiseRejectionEvent'): PromiseRejectionEvent;\r\n\tcreateEvent(eventInterface: 'RTCDTMFToneChangeEvent'): RTCDTMFToneChangeEvent;\r\n\tcreateEvent(eventInterface: 'RTCDataChannelEvent'): RTCDataChannelEvent;\r\n\tcreateEvent(eventInterface: 'RTCDtlsTransportStateChangedEvent'): RTCDtlsTransportStateChangedEvent;\r\n\tcreateEvent(eventInterface: 'RTCErrorEvent'): RTCErrorEvent;\r\n\tcreateEvent(eventInterface: 'RTCIceCandidatePairChangedEvent'): RTCIceCandidatePairChangedEvent;\r\n\tcreateEvent(eventInterface: 'RTCIceGathererEvent'): RTCIceGathererEvent;\r\n\tcreateEvent(eventInterface: 'RTCIceTransportStateChangedEvent'): RTCIceTransportStateChangedEvent;\r\n\tcreateEvent(eventInterface: 'RTCPeerConnectionIceErrorEvent'): RTCPeerConnectionIceErrorEvent;\r\n\tcreateEvent(eventInterface: 'RTCPeerConnectionIceEvent'): RTCPeerConnectionIceEvent;\r\n\tcreateEvent(eventInterface: 'RTCSsrcConflictEvent'): RTCSsrcConflictEvent;\r\n\tcreateEvent(eventInterface: 'RTCStatsEvent'): RTCStatsEvent;\r\n\tcreateEvent(eventInterface: 'RTCTrackEvent'): RTCTrackEvent;\r\n\tcreateEvent(eventInterface: 'SVGZoomEvent'): SVGZoomEvent;\r\n\tcreateEvent(eventInterface: 'SVGZoomEvents'): SVGZoomEvent;\r\n\tcreateEvent(eventInterface: 'SecurityPolicyViolationEvent'): SecurityPolicyViolationEvent;\r\n\tcreateEvent(eventInterface: 'ServiceWorkerMessageEvent'): ServiceWorkerMessageEvent;\r\n\tcreateEvent(eventInterface: 'SpeechRecognitionEvent'): SpeechRecognitionEvent;\r\n\tcreateEvent(eventInterface: 'SpeechSynthesisErrorEvent'): SpeechSynthesisErrorEvent;\r\n\tcreateEvent(eventInterface: 'SpeechSynthesisEvent'): SpeechSynthesisEvent;\r\n\tcreateEvent(eventInterface: 'StorageEvent'): StorageEvent;\r\n\tcreateEvent(eventInterface: 'TextEvent'): TextEvent;\r\n\tcreateEvent(eventInterface: 'TouchEvent'): TouchEvent;\r\n\tcreateEvent(eventInterface: 'TrackEvent'): TrackEvent;\r\n\tcreateEvent(eventInterface: 'TransitionEvent'): TransitionEvent;\r\n\tcreateEvent(eventInterface: 'UIEvent'): UIEvent;\r\n\tcreateEvent(eventInterface: 'UIEvents'): UIEvent;\r\n\tcreateEvent(eventInterface: 'VRDisplayEvent'): VRDisplayEvent;\r\n\tcreateEvent(eventInterface: 'VRDisplayEvent '): VRDisplayEvent;\r\n\tcreateEvent(eventInterface: 'WebGLContextEvent'): WebGLContextEvent;\r\n\tcreateEvent(eventInterface: 'WheelEvent'): WheelEvent;\r\n\tcreateEvent(eventInterface: string): Event;\r\n\tcreateNodeIterator(root: Node, whatToShow?: number, filter?: NodeFilter | null): NodeIterator; // Creates a NodeIterator object that you can use to traverse filtered lists of nodes or elements in a document.\r\n\t// @param root The root element or node to start traversing on.\r\n\t// @param whatToShow The type of nodes or elements to appear in the node list\r\n\t// @param filter A custom NodeFilter function to use. For more information, see filter. Use null for no filter.\r\n\t// @param entityReferenceExpansion A flag that specifies whether entity reference nodes are expanded.\r\n\tcreateProcessingInstruction(target: string, data: string): ProcessingInstruction; // Returns a ProcessingInstruction node whose target is target and data is data. If target does not match the Name production an 'InvalidCharacterError' DOMException will be thrown. If data contains \"?>\" an \"InvalidCharacterError\" DOMException will be thrown.\r\n\tcreateRange(): Range; // Returns an empty range object that has both of its boundary points positioned at the beginning of the document.\r\n\tcreateTextNode(data: string): Text; // Creates a text string from the specified value.\r\n\t// @param data String that specifies the nodeValue property of the text node.\r\n\tcreateTreeWalker(root: Node, whatToShow?: number, filter?: NodeFilter | null): TreeWalker; // Creates a TreeWalker object that you can use to traverse filtered lists of nodes or elements in a document.\r\n\t// @param root The root element or node to start traversing on.\r\n\t// @param whatToShow The type of nodes or elements to appear in the node list. For more information, see whatToShow.\r\n\t// @param filter A custom NodeFilter function to use.\r\n\t// @param entityReferenceExpansion A flag that specifies whether entity reference nodes are expanded.\r\n\t// @deprecated\r\n\t// createTreeWalker(root: Node, whatToShow: number, filter: NodeFilter | null, entityReferenceExpansion?: boolean): TreeWalker;\r\n\telementFromPoint(x: number, y: number): Element | null; // Returns the element for the specified x coordinate and the specified y coordinate.\r\n\t// @param x The x-offset\r\n\t// @param y The y-offset\r\n\telementsFromPoint(x: number, y: number): Element[];\r\n\texecCommand(commandId: string, showUI?: boolean, value?: string): boolean; // Executes a command on the current document, current selection, or the given range.\r\n\t// @param commandId String that specifies the command to execute. This command can be any of the command identifiers that can be executed in script.\r\n\t// @param showUI Display the user interface, defaults to false.\r\n\t// @param value Value to assign.\r\n\texitFullscreen(): Promise<void>; // Stops document's fullscreen element from being displayed fullscreen and resolves promise when done.\r\n\texitPointerLock(): void;\r\n\tgetAnimations(): Animation[];\r\n\tgetElementById(elementId: string): HTMLElement | null; // Returns a reference to the first object with the specified value of the ID or NAME attribute.\r\n\t// @param elementId String that specifies the ID value. Case-insensitive.\r\n\tgetElementsByClassName(classNames: string): HTMLCollectionOf<Element>; // Returns a HTMLCollection of the elements in the object on which the method was invoked (a document or an element) that have all the classes given by classNames. The classNames argument is interpreted as a space-separated list of classes.\r\n\tgetElementsByName(elementName: string): NodeListOf<HTMLElement>; // Gets a collection of objects based on the value of the NAME or ID attribute.\r\n\t// @param elementName Gets a collection of objects based on the value of the NAME or ID attribute.\r\n\tgetElementsByTagName<K extends keyof HTMLElementTagNameMap>(qualifiedName: K): HTMLCollectionOf<HTMLElementTagNameMap[K]>;\r\n\tgetElementsByTagName<K extends keyof SVGElementTagNameMap>(qualifiedName: K): HTMLCollectionOf<SVGElementTagNameMap[K]>;\r\n\tgetElementsByTagName(qualifiedName: string): HTMLCollectionOf<Element>; // Retrieves a collection of objects based on the specified element name.\r\n\t// @param name Specifies the name of an element.\r\n\tgetElementsByTagNameNS(namespaceURI: 'http://www.w3.org/1999/xhtml', localName: string): HTMLCollectionOf<HTMLElement>;\r\n\tgetElementsByTagNameNS(namespaceURI: 'http://www.w3.org/2000/svg', localName: string): HTMLCollectionOf<SVGElement>;\r\n\tgetElementsByTagNameNS(namespaceURI: string, localName: string): HTMLCollectionOf<Element>; // If namespace and localName are '*' returns a HTMLCollection of all descendant elements.\r\n\t// If only namespace is '*' returns a HTMLCollection of all descendant elements whose local name is localName.\r\n\t// If only localName is '*' returns a HTMLCollection of all descendant elements whose namespace is namespace.\r\n\t// Otherwise, returns a HTMLCollection of all descendant elements whose namespace is namespace and local name is localName.\r\n\tgetSelection(): Selection | null; // Returns an object representing the current selection of the document that is loaded into the object displaying a webpage.\r\n\thasFocus(): boolean; // Gets a value indicating whether the object currently has focus.\r\n\timportNode<T extends Node>(importedNode: T, deep: boolean): T; // Returns a copy of node. If deep is true, the copy also includes the node's descendants.\r\n\t// If node is a document or a shadow root, throws a 'NotSupportedError' DOMException.\r\n\topen(url?: string, name?: string, features?: string, replace?: boolean): Document; // Opens a new window and loads a document specified by a given URL. Also, opens a new window that uses the url parameter and the name parameter to collect the output of the write method and the writeln method.\r\n\t// @param url Specifies a MIME type for the document.\r\n\t// @param name Specifies the name of the window. This name is used as the value for the TARGET attribute on a form or an anchor element.\r\n\t// @param features Contains a list of items separated by commas. Each item consists of an option and a value, separated by an equals sign (for example, \"fullscreen=yes, toolbar=yes\"). The following values are supported.\r\n\t// @param replace Specifies whether the existing entry for the document is replaced in the history list.\r\n\tqueryCommandEnabled(commandId: string): boolean; // Returns a Boolean value that indicates whether a specified command can be successfully executed using execCommand, given the current state of the document.\r\n\t// @param commandId Specifies a command identifier.\r\n\tqueryCommandIndeterm(commandId: string): boolean; // Returns a Boolean value that indicates whether the specified command is in the indeterminate state.\r\n\t// @param commandId String that specifies a command identifier.\r\n\tqueryCommandState(commandId: string): boolean; // Returns a Boolean value that indicates the current state of the command.\r\n\t// @param commandId String that specifies a command identifier.\r\n\tqueryCommandSupported(commandId: string): boolean; // Returns a Boolean value that indicates whether the current command is supported on the current range.\r\n\t// @param commandId Specifies a command identifier.\r\n\tqueryCommandValue(commandId: string): string; // Returns the current value of the document, range, or current selection for the given command.\r\n\t// @param commandId String that specifies a command identifier.\r\n\twrite(...text: string[]): void; // Writes one or more HTML expressions to a document in the specified window.\r\n\t// @param content Specifies the text and HTML tags to write.\r\n\twriteln(...text: string[]): void; // Writes one or more HTML expressions, followed by a carriage return, to a document in the specified window.\r\n\t// @param content The text and HTML tags to write.\r\n\taddEventListener<K extends keyof DocumentEventMap>(type: K, listener: (this: Document, ev: DocumentEventMap[K]) => any, options?: boolean | AddEventListenerOptions): void;\r\n\taddEventListener(type: string, listener: EventListenerOrEventListenerObject, options?: boolean | AddEventListenerOptions): void;\r\n\tremoveEventListener<K extends keyof DocumentEventMap>(type: K, listener: (this: Document, ev: DocumentEventMap[K]) => any, options?: boolean | EventListenerOptions): void;\r\n\tremoveEventListener(type: string, listener: EventListenerOrEventListenerObject, options?: boolean | EventListenerOptions): void;\r\n\t// DEPRECATED !!!\r\n\t// Sets or gets the color of all active links in the document.\r\n\t// @deprecated\r\n\t// alinkColor: string; // Returns a reference to the collection of elements contained by the object.\r\n\t// @deprecated\r\n\t// readonly all: HTMLAllCollection; // Retrieves a collection of all a objects that have a name and/or id property. Objects in this collection are in HTML source order.\r\n\t// @deprecated\r\n\t// readonly anchors: HTMLCollectionOf<HTMLAnchorElement>; // Retrieves a collection of all applet objects in the document.\r\n\t// @deprecated\r\n\t// readonly applets: HTMLCollectionOf<HTMLAppletElement>; // Deprecated. Sets or retrieves a value that indicates the background color behind the object.\r\n\t// @deprecated\r\n\t// bgColor: string; // Sets or gets the foreground (text) color of the document.\r\n\t// @deprecated\r\n\t// fgColor: string; // @deprecated\r\n\t// readonly fullscreen: boolean; // Sets or gets the color of the document links.\r\n\t// @deprecated\r\n\t// linkColor: string; // Sets or gets the color of the links that the user has visited.\r\n\t// @deprecated\r\n\t// vlinkColor: string; // @deprecated\r\n\t// captureEvents(): void; // @deprecated\r\n\t// caretRangeFromPoint(x: number, y: number): Range; // @deprecated\r\n\t// clear(): void; // @deprecated\r\n\t// releaseEvents(): void;\r\n\t*/\r\n}\r\n\r\nexport class RxDocument extends RxElement {\r\n\tprivate location_: ILocation = RxLocation.location;\r\n\tget location() {\r\n\t\treturn this.location_;\r\n\t}\r\n\tget URL(): string {\r\n\t\treturn this.location_.href;\r\n\t}\r\n\tget hidden(): true {\r\n\t\treturn true;\r\n\t}\r\n\tget visibilityState(): 'prerender' {\r\n\t\treturn 'prerender';\r\n\t}\r\n\tget doctype(): RxDocumentType | null {\r\n\t\treturn this.childNodes.find(x => isRxDocumentType(x)) as RxDocumentType;\r\n\t}\r\n\tget body(): RxElement | null {\r\n\t\treturn this.childNodes.find(x => isRxElement(x) && x.nodeName === 'body') as RxElement;\r\n\t}\r\n\tget head(): RxElement | null {\r\n\t\treturn this.childNodes.find(x => isRxElement(x) && x.nodeName === 'head') as RxElement;\r\n\t}\r\n\tget title(): string | null {\r\n\t\tconst title = this.childNodes.find(x => isRxElement(x) && x.nodeName === 'title') as RxElement;\r\n\t\tif (title) {\r\n\t\t\treturn title.innerText;\r\n\t\t} else {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t}\r\n\tset title(nodeValue: string | null) {\r\n\t\tconst title = this.childNodes.find(x => isRxElement(x) && x.nodeName === 'title') as RxElement;\r\n\t\tif (title) {\r\n\t\t\ttitle.innerText = nodeValue;\r\n\t\t}\r\n\t}\r\n\tget documentElement(): RxElement | null {\r\n\t\treturn this.firstElementChild;\r\n\t}\r\n\r\n\t/*\r\n\t\treadonly characterSet: string; // Returns document's encoding.\r\n\t\treadonly charset: string; // Gets or sets the character set used to encode the object.\r\n\t\treadonly compatMode: string; // Gets a value that indicates whether standards-compliant mode is switched on for the object.\r\n\t\treadonly contentType: string; // Returns document's content type.\r\n\t\treadonly currentScript: HTMLOrSVGScriptElement | null; // Returns the script element, or the SVG script element, that is currently executing, as long as the element represents a classic script. In the case of reentrant script execution, returns the one that most recently started executing amongst those that have not yet finished executing.\r\n\t\treadonly defaultView: (WindowProxy & typeof globalThis) | null; // Returns null if the Document is not currently executing a script or SVG script element (e.g., because the running script is an event handler, or a timeout), or if the currently executing script or SVG script element represents a module script.\r\n\t\treadonly documentElement: HTMLElement; // Gets a reference to the root node of the document.\r\n\t\treadonly documentURI: string; // Returns document's URL.\r\n\t\treadonly embeds: HTMLCollectionOf<HTMLEmbedElement>; // Retrieves a collection of all embed objects in the document.\r\n\t\treadonly forms: HTMLCollectionOf<HTMLFormElement>; // Retrieves a collection, in source order, of all form objects in the document.\r\n\t\treadonly fullscreenEnabled: boolean; // Returns true if document has the ability to display elements fullscreen and fullscreen is supported, or false otherwise.\r\n\t\treadonly head: HTMLHeadElement; // Returns the head element.\r\n\t\treadonly hidden: boolean;\r\n\t\treadonly images: HTMLCollectionOf<HTMLImageElement>; // Retrieves a collection, in source order, of img objects in the document.\r\n\t\treadonly implementation: DOMImplementation; // Gets the implementation object of the current document.\r\n\t\treadonly inputEncoding: string; // Returns the character encoding used to create the webpage that is loaded into the document object.\r\n\t\treadonly lastModified: string; // Gets the date that the page was last modified, if the page supplies one.\r\n\t\treadonly links: HTMLCollectionOf<HTMLAnchorElement | HTMLAreaElement>; // Retrieves a collection of all a objects that specify the href property and all area objects in the document.\r\n\t\treadonly origin: string; // Returns document's origin.\r\n\t\treadonly ownerDocument: null;\r\n\t\treadonly plugins: HTMLCollectionOf<HTMLEmbedElement>; // Return an HTMLCollection of the embed elements in the Document.\r\n\t\treadonly readyState: DocumentReadyState; // Retrieves a value that indicates the current state of the object.\r\n\t\treadonly referrer: string; // Gets the URL of the location that referred the user to the current page.\r\n\t\treadonly scripts: HTMLCollectionOf<HTMLScriptElement>; // Retrieves a collection of all script objects in the document.\r\n\t\treadonly scrollingElement: Element | null;\r\n\t\treadonly timeline: DocumentTimeline;\r\n\t\treadonly visibilityState: VisibilityState;\r\n\t\t*/\r\n\r\n\tconstructor() {\r\n\t\tsuper(null, '#document');\r\n\t\tthis.nodeType = RxNodeType.DOCUMENT_NODE;\r\n\t\tthis.childNodes = [];\r\n\t}\r\n\tcreateAttribute() { }\r\n\t// Creates a new Attr object and returns it.\r\n\tcreateAttributeNS() { }\r\n\t// Creates a new attribute node in a given namespace and returns it.\r\n\tcreateCDATASection() { }\r\n\t// Creates a new CDATA node and returns it.\r\n\tcreateComment(nodeValue: string) {\r\n\t\treturn new RxComment(null, nodeValue);\r\n\t}\r\n\t// Creates a new comment node and returns it.\r\n\tcreateDocumentFragment() {\r\n\t\treturn new RxDocumentFragment();\r\n\t}\r\n\t// Creates a new document fragment.\r\n\tcreateElement(nodeName: string): RxElement {\r\n\t\treturn new RxElement(null, nodeName);\r\n\t}\r\n\t// Creates a new element with the given tag name.\r\n\tcreateElementNS(nodeName: string): RxElement {\r\n\t\treturn new RxElement(null, nodeName);\r\n\t}\r\n\t// Creates a new element with the given tag name and namespace URI.\r\n\tcreateEvent() { }\r\n\t// Creates an event object.\r\n\tcreateNodeIterator() { }\r\n\t// Creates a NodeIterator object.\r\n\tcreateProcessingInstruction(nodeValue: string) {\r\n\t\treturn new RxProcessingInstruction(null, nodeValue);\r\n\t}\r\n\t// Creates a new ProcessingInstruction object.\r\n\tcreateRange() { }\r\n\t// Creates a Range object.\r\n\tcreateTextNode(nodeValue: string) {\r\n\t\treturn new RxText(null, nodeValue);\r\n\t}\r\n\t// Creates a text node.\r\n\tcreateTouchList() { }\r\n\t// Creates a TouchList object.\r\n\tcreateTreeWalker() { }\r\n\t// Creates a TreeWalker object.\r\n\tserialize(): string {\r\n\t\treturn `${this.childNodes.map(x => x.serialize()).join('')}`;\r\n\t}\r\n}\r\n\r\nexport function isRxElement(x: RxNode): x is RxElement {\r\n\treturn x.nodeType === RxNodeType.ELEMENT_NODE;\r\n}\r\n\r\nexport function isRxText(x: RxNode): x is RxText {\r\n\treturn x.nodeType === RxNodeType.TEXT_NODE;\r\n}\r\n\r\nexport function isRxComment(x: RxNode): x is RxComment {\r\n\treturn x.nodeType === RxNodeType.COMMENT_NODE;\r\n}\r\n\r\nexport function isRxDocument(x: RxNode): x is RxDocument {\r\n\treturn x.nodeType === RxNodeType.DOCUMENT_NODE;\r\n}\r\n\r\nexport function isRxDocumentFragment(x: RxNode): x is RxDocumentFragment {\r\n\treturn x.nodeType === RxNodeType.DOCUMENT_FRAGMENT_NODE;\r\n}\r\n\r\nexport function isRxDocumentType(x: RxNode): x is RxDocumentType {\r\n\treturn x.nodeType === RxNodeType.DOCUMENT_TYPE_NODE;\r\n}\r\n\r\nexport function isRxProcessingInstruction(x: RxNode): x is RxProcessingInstruction {\r\n\treturn x.nodeType === RxNodeType.PROCESSING_INSTRUCTION_NODE;\r\n}\r\n\r\nexport function parse(html: string) {\r\n\tconst doc = new RxDocument();\r\n\tlet parentNode: RxElement = doc,\r\n\t\tnode;\r\n\tconst parser = new Parser(\r\n\t\t{\r\n\t\t\tonopentag: (nodeName, attributes) => {\r\n\t\t\t\t// console.log(nodeName);\r\n\t\t\t\tnode = new RxElement(parentNode, nodeName, attributes);\r\n\t\t\t\tparentNode.childNodes.push(node);\r\n\t\t\t\tparentNode = node;\r\n\t\t\t\t// if (NO_CHILDS.indexOf(nodeName) === -1) {\r\n\t\t\t\t//\tconsole.log(nodeName);\r\n\t\t\t\t//\tparentNode = node;\r\n\t\t\t\t// }\r\n\t\t\t},\r\n\t\t\tonclosetag: (nodeName) => {\r\n\t\t\t\tif (parentNode.parentNode) {\r\n\t\t\t\t\tparentNode = parentNode.parentNode;\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tontext: (nodeValue) => {\r\n\t\t\t\t// console.log('ontext', nodeValue);\r\n\t\t\t\t// if (nodeValue.length) {\r\n\t\t\t\tconst textNode = new RxText(parentNode, nodeValue);\r\n\t\t\t\tparentNode.childNodes.push(textNode);\r\n\t\t\t\t// }\r\n\t\t\t},\r\n\t\t\tonprocessinginstruction: (nodeName, nodeValue) => {\r\n\t\t\t\t// console.log('onprocessinginstruction', nodeName, nodeValue);\r\n\t\t\t\tif (nodeName === '!doctype') {\r\n\t\t\t\t\tnode = new RxDocumentType(parentNode, nodeValue);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tnode = new RxProcessingInstruction(parentNode, nodeValue);\r\n\t\t\t\t}\r\n\t\t\t\tparentNode.childNodes.push(node);\r\n\t\t\t},\r\n\t\t\toncomment: nodeValue => {\r\n\t\t\t\t// console.log('oncomment', nodeValue);\r\n\t\t\t\tnode = new RxComment(parentNode, nodeValue);\r\n\t\t\t\tparentNode.childNodes.push(node);\r\n\t\t\t\t// parentNode = node;\r\n\t\t\t},\r\n\t\t\toncommentend: () => {\r\n\t\t\t\t// console.log('oncommentend');\r\n\t\t\t\t// parentNode = parentNode.parentNode;\r\n\t\t\t},\r\n\t\t\toncdatastart: () => {\r\n\t\t\t\tconsole.log('oncdatastart');\r\n\t\t\t},\r\n\t\t\toncdataend: () => {\r\n\t\t\t\tconsole.log('oncdataend');\r\n\t\t\t},\r\n\t\t\tonerror: error => {\r\n\t\t\t\tconsole.log('error', error);\r\n\t\t\t},\r\n\t\t\t/*\r\n\t\t\tonopentagname: (name) => {\r\n\t\t\t\tconsole.log('onopentagname', name);\r\n\t\t\t},\r\n\t\t\tonattribute: (name, value) => {\r\n\t\t\t\tconsole.log('onattribute', name, value);\r\n\t\t\t},\r\n\t\t\tonreset: () => {\r\n\t\t\t\tconsole.log('reset');\r\n\t\t\t},\r\n\t\t\tonend: () => {\r\n\t\t\t\tconsole.log('end');\r\n\t\t\t},\r\n\t\t\t*/\r\n\t\t},\r\n\t\t{\r\n\t\t\tdecodeEntities: false,\r\n\t\t\tlowerCaseTags: true,\r\n\t\t}\r\n\t);\r\n\tparser.write(html);\r\n\tparser.end();\r\n\treturn doc;\r\n}\r\n\r\nexport function getQueries(selector: string): RxQuery[] {\r\n\tconst queries: RxQuery[] = [];\r\n\tselector\r\n\t\t.trim()\r\n\t\t.split(' ')\r\n\t\t.forEach((x: string) => {\r\n\t\t\tx.trim()\r\n\t\t\t\t.split('>')\r\n\t\t\t\t.forEach((x, i) => {\r\n\t\t\t\t\t// const regex = /\\.([^\\.[]+)|\\[([^\\.\\[]+)\\]|([^\\.\\[\\]]+)/g;\r\n\t\t\t\t\t// const regex = /\\#([^\\.[#]+)|\\.([^\\.[#]+)|\\[([^\\.\\[#]+)\\]|([^\\.\\[#\\]]+)/g;\r\n\t\t\t\t\tconst regex = /\\:not\\(\\#([^\\.[#:]+)\\)|\\:not\\(\\.([^\\.[#:]+)\\)|\\:not\\(\\[([^\\.\\[#:]+)\\]\\)|\\:not\\(([^\\.\\[#:\\]]+)\\)|\\#([^\\.[#:]+)|\\.([^\\.[#:]+)|\\[([^\\.\\[#:]+)\\]|([^\\.\\[#:\\]]+)/g;\r\n\t\t\t\t\t/* eslint no-useless-escape: \"off\" */\r\n\t\t\t\t\tconst selectors = [];\r\n\t\t\t\t\tconst matches = x.matchAll(regex);\r\n\t\t\t\t\tfor (const match of matches) {\r\n\t\t\t\t\t\tif (match[1]) {\r\n\t\t\t\t\t\t\tselectors.push({ selector: match[1], type: SelectorType.Id, negate: true });\r\n\t\t\t\t\t\t} else if (match[2]) {\r\n\t\t\t\t\t\t\tselectors.push({ selector: match[2], type: SelectorType.Class, negate: true });\r\n\t\t\t\t\t\t} else if (match[3]) {\r\n\t\t\t\t\t\t\tselectors.push({ selector: match[3], type: SelectorType.Attribute, negate: true });\r\n\t\t\t\t\t\t} else if (match[4]) {\r\n\t\t\t\t\t\t\tselectors.push({ selector: match[4], type: SelectorType.TagName, negate: true });\r\n\t\t\t\t\t\t} else if (match[5]) {\r\n\t\t\t\t\t\t\tselectors.push({ selector: match[5], type: SelectorType.Id, negate: false });\r\n\t\t\t\t\t\t} else if (match[6]) {\r\n\t\t\t\t\t\t\tselectors.push({ selector: match[6], type: SelectorType.Class, negate: false });\r\n\t\t\t\t\t\t} else if (match[7]) {\r\n\t\t\t\t\t\t\tselectors.push({ selector: match[7], type: SelectorType.Attribute, negate: false });\r\n\t\t\t\t\t\t} else if (match[8]) {\r\n\t\t\t\t\t\t\tselectors.push({ selector: match[8], type: SelectorType.TagName, negate: false });\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t// console.log('match', match);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tconst selector =\r\n\t\t\t\t\t\ti > 0\r\n\t\t\t\t\t\t\t? { selector: x, selectors, inner: true }\r\n\t\t\t\t\t\t\t: { selector: x, selectors, inner: false };\r\n\t\t\t\t\tqueries.push.call(queries, selector);\r\n\t\t\t\t});\r\n\t\t});\r\n\treturn queries;\r\n}\r\n\r\nexport function matchSelector(child: RxElement, selector: RxSelector): boolean {\r\n\tswitch (selector.type) {\r\n\t\tcase SelectorType.Id:\r\n\t\t\treturn (selector.selector !== '' && child.attributes.id === selector.selector) !== selector.negate;\r\n\t\tcase SelectorType.Class:\r\n\t\t\treturn (child.classList.indexOf(selector.selector) !== -1) !== selector.negate;\r\n\t\tcase SelectorType.Attribute:\r\n\t\t\treturn (Object.keys(child.attributes).indexOf(selector.selector) !== -1) !== selector.negate;\r\n\t\tcase SelectorType.TagName:\r\n\t\t\treturn (child.nodeName === selector.selector) !== selector.negate;\r\n\t\tdefault:\r\n\t\t\treturn false;\r\n\t}\r\n}\r\n\r\nexport function matchSelectors(child: RxElement, selectors: RxSelector[]): boolean {\r\n\treturn selectors.reduce(function (p: boolean, selector: RxSelector) {\r\n\t\treturn p && matchSelector(child, selector);\r\n\t}, true);\r\n}\r\n\r\nexport function querySelectorAll(queries: RxQuery[], childNodes: RxNode[], query: RxQuery | null = null, nodes: RxElement[] = []): RxElement[] | null {\r\n\tif (query || queries.length) {\r\n\t\tquery = query || queries.shift() as RxQuery;\r\n\t\tfor (let child of childNodes) {\r\n\t\t\tif (child instanceof RxElement) {\r\n\t\t\t\tif (matchSelectors(child, query.selectors)) {\r\n\t\t\t\t\t// console.log(query);\r\n\t\t\t\t\tif (queries.length) {\r\n\t\t\t\t\t\tconst results: RxElement[] | null = querySelectorAll(queries, child.childNodes);\r\n\t\t\t\t\t\tif (results) {\r\n\t\t\t\t\t\t\tArray.prototype.push.apply(nodes, results);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tnodes.push(child);\r\n\t\t\t\t\t}\r\n\t\t\t\t} else if (!query.inner) {\r\n\t\t\t\t\tconst results: RxElement[] | null = querySelectorAll(queries, child.childNodes, query);\r\n\t\t\t\t\tif (results) {\r\n\t\t\t\t\t\tArray.prototype.push.apply(nodes, results);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn nodes.length ? nodes : null;\r\n}\r\n\r\nexport function querySelector(queries: RxQuery[], childNodes: RxNode[], query: RxQuery | null = null): RxElement | null {\r\n\tlet node = null;\r\n\tif (query || queries.length) {\r\n\t\tquery = query || queries.shift() as RxQuery;\r\n\t\tfor (let child of childNodes) {\r\n\t\t\tif (child instanceof RxElement) {\r\n\t\t\t\tif (matchSelectors(child, query.selectors)) {\r\n\t\t\t\t\t// console.log(query);\r\n\t\t\t\t\tif (queries.length) {\r\n\t\t\t\t\t\treturn querySelector(queries, child.childNodes);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\treturn child;\r\n\t\t\t\t\t}\r\n\t\t\t\t} else if (!query.inner) {\r\n\t\t\t\t\tnode = querySelector(queries, child.childNodes, query);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn node;\r\n}\r\n\r\nexport function cloneNode(source: RxNode, deep: boolean = false, parentNode: RxElement | null = null): RxNode {\r\n\tlet node: RxNode;\r\n\tif (isRxElement(source)) {\r\n\t\tconst nodeElement: RxElement = new RxElement(\r\n\t\t\tparentNode,\r\n\t\t\tsource.nodeName,\r\n\t\t\tObject.assign({}, source.attributes),\r\n\t\t);\r\n\t\tif (deep) {\r\n\t\t\tnodeElement.childNodes = source.childNodes.map(x => cloneNode.apply(x, [x, deep, nodeElement]));\r\n\t\t}\r\n\t\tnode = nodeElement;\r\n\t} else if (isRxDocumentFragment(source)) {\r\n\t\tconst nodeDocumentFragment: RxDocumentFragment = new RxDocumentFragment();\r\n\t\tif (deep) {\r\n\t\t\tnodeDocumentFragment.childNodes = source.childNodes.map(x => cloneNode.apply(x, [x, deep, nodeDocumentFragment]));\r\n\t\t}\r\n\t\tnode = nodeDocumentFragment;\r\n\t} else if (isRxText(source)) {\r\n\t\tnode = new RxText(parentNode, source.nodeValue);\r\n\t} else if (isRxComment(source)) {\r\n\t\tnode = new RxComment(parentNode, source.nodeValue);\r\n\t} else if (isRxDocument(source)) {\r\n\t\tconst documentElement: RxDocument = new RxDocument();\r\n\t\tif (deep) {\r\n\t\t\tdocumentElement.childNodes = source.childNodes.map(x => cloneNode.apply(x, [x, deep, documentElement]));\r\n\t\t}\r\n\t\tnode = documentElement;\r\n\t} else {\r\n\t\tthrow new Error('Invalid node type');\r\n\t}\r\n\treturn node;\r\n}\r\n","export interface IDOMStringList extends DOMStringList {\r\n\t// Returns the number of strings in strings.\r\n\treadonly length: number;\r\n\t// Returns true if strings contains string, and false otherwise.\r\n\tcontains(string: string): boolean;\r\n\t// Returns the string with index index from strings.\r\n\titem(index: number): string | null;\r\n\t[index: number]: string;\r\n}\r\n\r\nexport class RxDOMStringList extends Array<string> implements IDOMStringList {\r\n\t/*\r\n\tprivate list_: string[] = [];\r\n\tget length(): number {\r\n\t\treturn this.list_.length;\r\n\t}\r\n\t*/\r\n\tcontains(string: string): boolean {\r\n\t\t// return this.list_.indexOf(string) !== -1;\r\n\t\treturn this.indexOf(string) !== -1;\r\n\t}\r\n\titem(index: number): string | null {\r\n\t\t// if (index > 0 && index < this.list_.length) {\r\n\t\tif (index > 0 && index < this.length) {\r\n\t\t\t// return this.list_[index];\r\n\t\t\treturn this[index];\r\n\t\t} else {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t};\r\n\t// [index: number]: string;\r\n}\r\n\r\nexport interface ILocation extends Location {\r\n\t/*\r\n\thash: string; // Returns the Location object's URL's fragment (includes leading \"#\" if non-empty). Can be set, to navigate to the same URL with a changed fragment (ignores leading \"#\").\r\n\thost: string; // Returns the Location object's URL's host and port (if different from the default port for the scheme). Can be set, to navigate to the same URL with a changed host and port.\r\n\thostname: string; // Returns the Location object's URL's host. Can be set, to navigate to the same URL with a changed host.\r\n\tpathname: string; // Returns the Location object's URL's path. Can be set, to navigate to the same URL with a changed path.\r\n\tport: string; // Returns the Location object's URL's port. Can be set, to navigate to the same URL with a changed port.\r\n\tprotocol: string; // Returns the Location object's URL's scheme. Can be set, to navigate to the same URL with a changed scheme.\r\n\tsearch: string; // Returns the Location object's URL's query (includes leading \"?\" if non-empty). Can be set, to navigate to the same URL with a changed query (ignores leading \"?\").\r\n\thref: string; // Returns the Location object's URL. Can be set, to navigate to the given URL.\r\n\treadonly origin: string; // Returns the Location object's URL's origin.\r\n\treadonly ancestorOrigins: DOMStringList; // Returns a DOMStringList object listing the origins of the ancestor browsing contexts, from the parent browsing context to the top-level browsing context.\r\n\tassign(url: string): void; // Navigates to the given URL.\r\n\treload(): void; // reload(forcedReload: boolean): void; // @deprecated\r\n\treplace(url: string): void; // Removes the current page from the session history and navigates to the given URL.\r\n\ttoString(): string;\r\n\t*/\r\n}\r\n\r\nexport class RxLocation implements ILocation {\r\n\t/*\r\n\tprivate hash_: string = '';\r\n\tget hash(): string { return this.hash_; }\r\n\tset hash(hash: string) { this.hash_ = hash; updateLocation_(this); }\r\n\r\n\tprivate host_: string = '';\r\n\tget host(): string { return this.host_; }\r\n\tset host(host: string) { this.host_ = host; updateLocation_(this); }\r\n\r\n\tprivate hostname_: string = '';\r\n\tget hostname(): string { return this.hostname_; }\r\n\tset hostname(hostname: string) { this.hostname_ = hostname; updateLocation_(this); }\r\n\r\n\tprivate pathname_: string = '';\r\n\tget pathname(): string { return this.pathname_; }\r\n\tset pathname(pathname: string) { this.pathname_ = pathname; updateLocation_(this); }\r\n\r\n\tprivate port_: string = '';\r\n\tget port(): string { return this.port_; }\r\n\tset port(port: string) { this.port_ = port; updateLocation_(this); }\r\n\r\n\tprivate protocol_: string = '';\r\n\tget protocol(): string { return this.protocol_; }\r\n\tset protocol(protocol: string) { this.protocol_ = protocol; updateLocation_(this); }\r\n\r\n\tprivate search_: string = '';\r\n\tget search(): string { return this.search_; }\r\n\tset search(search: string) { this.search_ = search; updateLocation_(this); }\r\n\t*/\r\n\thash: string = '';\r\n\thost: string = '';\r\n\thostname: string = '';\r\n\tpathname: string = '';\r\n\tport: string = '';\r\n\tprotocol: string = '';\r\n\tsearch: string = '';\r\n\tprivate href_: string = '';\r\n\tget href(): string {\r\n\t\tconst href: string = `${this.protocol}//${this.host}${this.port.length ? `:${this.port}` : ``}${this.pathname}${this.search}${this.hash}`;\r\n\t\tthis.href_ = href;\r\n\t\treturn href;\r\n\t}\r\n\tset href(href: string) {\r\n\t\tif (this.href_ !== href) {\r\n\t\t\tthis.href_ = href;\r\n\t\t\tconst regExp: RegExp = /^((http\\:|https\\:)?\\/\\/|\\/)?([^\\/\\:]+)?(\\:([^\\/]+))?(\\/[^\\?]+)?(\\?[^\\#]+)?(\\#.+)?$/g;\r\n\t\t\tconst matches = href.matchAll(regExp);\r\n\t\t\tfor (let match of matches) {\r\n\t\t\t\t/*\r\n\t\t\t\t0 Match\t0.\thttps://developer.mozilla.org/en-US/docs/Web/API/Location/ancestorOrigins?pippo=shuter&a=dsok#asoka\r\n\t\t\t\t1 Group 1.\thttps://\r\n\t\t\t\t2 Group 2.\thttps:\r\n\t\t\t\t3 Group 3.\tdeveloper.mozilla.org\r\n\t\t\t\t4 Group 4.\t:8080\r\n\t\t\t\t5 Group 5.\t8080\r\n\t\t\t\t6 Group 5.\t/en-US/docs/Web/API/Location/ancestorOrigins\r\n\t\t\t\t7 Group 6.\t?pippo=shuter&a=dsok\r\n\t\t\t\t8 Group 7.\t#asoka\r\n\t\t\t\t*/\r\n\t\t\t\t/*\r\n\t\t\t\tthis.protocol_ = match[2] || '';\r\n\t\t\t\tthis.host_ = this.hostname_ = match[3] || '';\r\n\t\t\t\tthis.port_ = match[5] || '';\r\n\t\t\t\tthis.pathname_ = match[6] || '';\r\n\t\t\t\tthis.search_ = match[7] || '';\r\n\t\t\t\tthis.hash_ = match[8] || '';\r\n\t\t\t\t*/\r\n\t\t\t\tthis.protocol = match[2] || '';\r\n\t\t\t\tthis.host = this.hostname = match[3] || '';\r\n\t\t\t\tthis.port = match[5] || '';\r\n\t\t\t\tthis.pathname = match[6] || '';\r\n\t\t\t\tthis.search = match[7] || '';\r\n\t\t\t\tthis.hash = match[8] || '';\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tget origin(): string {\r\n\t\treturn `${this.protocol}//${this.host}${this.port.length ? `:${this.port}` : ``}`;\r\n\t}\r\n\tprivate ancestorOrigins_: IDOMStringList = new RxDOMStringList();\r\n\tget ancestorOrigins(): DOMStringList {\r\n\t\treturn this.ancestorOrigins_;\r\n\t}\r\n\tassign(url: string): void {\r\n\t\tthis.href = url;\r\n\t}\r\n\treload(): void { }\r\n\treplace(url: string): void {\r\n\t\tthis.href = url;\r\n\t}\r\n\ttoString(): string {\r\n\t\treturn this.href;\r\n\t}\r\n\tprivate static location_: ILocation;\r\n\tstatic get location(): ILocation {\r\n\t\tif (this.location_) {\r\n\t\t\treturn this.location_;\r\n\t\t} else {\r\n\t\t\treturn this.location_ = new RxLocation();\r\n\t\t}\r\n\t}\r\n}\r\n\r\n/*\r\nfunction updateLocation_(location: ILocation): void {\r\n\tlocation.href = location.href;\r\n}\r\n*/\r\n","import { RxLocation } from \"../location/location\";\r\n\r\nexport interface IHistoryItem {\r\n\tdata: any;\r\n\ttitle: string;\r\n\turl?: string | null;\r\n}\r\n\r\nexport interface IHistory extends History {\r\n\t/*\r\n\treadonly length: number;\r\n    scrollRestoration: ScrollRestoration;\r\n    readonly state: any;\r\n    back(): void;\r\n    forward(): void;\r\n    go(delta?: number): void;\r\n    pushState(data: any, title: string, url?: string | null): void;\r\n\treplaceState(data: any, title: string, url?: string | null): void;\r\n\t*/\r\n}\r\n\r\nexport class RxHistory implements IHistory {\r\n\tprivate currentIndex_: number = 0;\r\n\tprivate history_: IHistoryItem[] = [];\r\n\tget length(): number {\r\n\t\treturn this.history_.length;\r\n\t}\r\n\tscrollRestoration: ScrollRestoration = 'auto';\r\n\tstate: any;\r\n\tback(): void {\r\n\t\tif (this.currentIndex_ > 0) {\r\n\t\t\tthis.currentIndex_--;\r\n\t\t\tconst item: IHistoryItem = this.history_[this.currentIndex_];\r\n\t\t\tif (item.url) RxLocation.location.href = item.url;\r\n\t\t}\r\n\t};\r\n\tforward(): void {\r\n\t\tif (this.currentIndex_ < this.history_.length - 1) {\r\n\t\t\tthis.currentIndex_++;\r\n\t\t\tconst item: IHistoryItem = this.history_[this.currentIndex_];\r\n\t\t\tif (item.url) RxLocation.location.href = item.url;\r\n\t\t}\r\n\t};\r\n\tgo(delta?: number): void {\r\n\t\tif (typeof delta === 'number') {\r\n\t\t\tconst index: number = this.currentIndex_ + delta;\r\n\t\t\tif (index > 0 && index < this.history_.length) {\r\n\t\t\t\tconst item: IHistoryItem = this.history_[index];\r\n\t\t\t\tif (item.url) RxLocation.location.href = item.url;\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\tpushState(data: any, title: string, url?: string | null): void {\r\n\t\tthis.history_.push({ data, title, url });\r\n\t\tthis.currentIndex_ = this.history_.length - 1;\r\n\t};\r\n\treplaceState(data: any, title: string, url?: string | null): void {\r\n\t\tif (this.history_.length) {\r\n\t\t\tthis.history_.splice(this.history_.length - 1, 1, { data, title, url });\r\n\t\t} else {\r\n\t\t\tthis.history_.push({ data, title, url });\r\n\t\t}\r\n\t\tthis.currentIndex_ = this.history_.length - 1;\r\n\t};\r\n\tprivate static history_: History;\r\n\tstatic get history(): IHistory {\r\n\t\tif (this.history_) {\r\n\t\t\treturn this.history_;\r\n\t\t} else {\r\n\t\t\treturn this.history_ = new RxHistory();\r\n\t\t}\r\n\t}\r\n}\r\n","import { isPlatformServer, Module, ModuleError, Platform } from 'rxcomp';\nimport { Observable, Observer } from 'rxjs';\nimport { switchMap } from 'rxjs/operators';\nimport CacheService, { CacheControlType, CacheMode } from '../cache/cache.service';\nimport { IHistory, RxHistory } from '../history/history';\nimport { ILocation, RxLocation } from '../location/location';\nimport { parse, RxDocument, RxElement, RxText } from '../nodes/nodes';\nconst fs = require('fs');\n\nexport interface IServerVars {\n\tname?: string;\n\thost?: string;\n\tport?: number;\n\tcharset?: string;\n\ttemplate?: string;\n\tcacheMode?: CacheMode;\n\tcache?: string;\n\troot?: string;\n\tresource?: string;\n\tapi?: string;\n\tstatic?: boolean;\n\tdevelopment?: boolean;\n\tproduction?: boolean;\n\t[key: string]: any;\n}\n\nexport interface IServerRequest {\n\turl: string;\n\ttemplate?: string;\n\tvars?: IServerVars;\n}\n\nexport interface IServerResponse extends IServerRequest {\n\tserialize: () => string;\n\tbody?: string;\n\tstatusCode?: number;\n\tstatusMessage?: string;\n}\n\nexport interface IServerErrorResponse extends IServerRequest {\n\terror: Error;\n\tstatusCode?: number;\n\tstatusMessage?: string;\n}\n\nexport class ServerRequest implements IServerRequest {\n\turl!: string;\n\ttemplate!: string;\n\tvars!: IServerVars;\n\tconstructor(options?: IServerRequest) {\n\t\tif (options) {\n\t\t\tObject.assign(this, options);\n\t\t}\n\t\tthis.vars = Object.assign({\n\t\t\thost: 'http://localhost:5000',\n\t\t\tport: 5000,\n\t\t\tcharset: 'utf8',\n\t\t\ttemplate: `./index.html`,\n\t\t\tcacheMode: CacheMode.Memory,\n\t\t\tcache: './cache/',\n\t\t\troot: './dist/browser/',\n\t\t}, this.vars || {});\n\t}\n}\n\nexport class ServerResponse implements IServerResponse {\n\turl!: string;\n\ttemplate!: string;\n\tvars!: IServerVars;\n\tserialize!: () => string;\n\tbody!: string;\n\tstatusCode?: number;\n\tstatusMessage?: string;\n\tmaxAge?: number;\n\tcacheControl?: CacheControlType;\n\tconstructor(options?: IServerResponse) {\n\t\tif (options) {\n\t\t\tObject.assign(this, options);\n\t\t}\n\t}\n}\n\nexport class ServerErrorResponse implements IServerErrorResponse {\n\turl!: string;\n\tvars!: IServerVars;\n\terror!: Error;\n\tstatusCode?: number;\n\tstatusMessage?: string;\n\tconstructor(options?: IServerErrorResponse) {\n\t\tif (options) {\n\t\t\tObject.assign(this, options);\n\t\t}\n\t}\n}\n\nexport default class Server extends Platform {\n\n\t/**\n\t * @param moduleFactory\n\t * @description This method returns a Server compiled module\n\t */\n\tstatic bootstrap(moduleFactory?: typeof Module, request?: ServerRequest) {\n\t\tif (!isPlatformServer) {\n\t\t\tthrow new ModuleError('missing platform server, node process not found');\n\t\t}\n\t\tif (!moduleFactory) {\n\t\t\tthrow new ModuleError('missing moduleFactory');\n\t\t}\n\t\tif (!moduleFactory.meta) {\n\t\t\tthrow new ModuleError('missing moduleFactory meta');\n\t\t}\n\t\tif (!moduleFactory.meta.bootstrap) {\n\t\t\tthrow new ModuleError('missing bootstrap');\n\t\t}\n\t\tif (!moduleFactory.meta.bootstrap.meta) {\n\t\t\tthrow new ModuleError('missing bootstrap meta');\n\t\t}\n\t\tif (!moduleFactory.meta.bootstrap.meta.selector) {\n\t\t\tthrow new ModuleError('missing bootstrap meta selector');\n\t\t}\n\t\tif (!request?.template) {\n\t\t\tthrow new ModuleError('missing template');\n\t\t}\n\t\t/*\n\t\tif (typeof ((ReadableStream.prototype as any)[Symbol.asyncIterator]) === 'undefined') {\n\t\t\t(ReadableStream.prototype as any)[Symbol.asyncIterator] = async function* () {\n\t\t\t\tconst reader = this.getReader()\n\t\t\t\twhile (1) {\n\t\t\t\t\tconst r = await reader.read();\n\t\t\t\t\tif (r.done) {\n\t\t\t\t\t\treturn r.value;\n\t\t\t\t\t}\n\t\t\t\t\tyield r.value;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t*/\n\t\tconst document = this.resolveGlobals(request);\n\t\tconst meta = this.resolveMeta(moduleFactory);\n\t\tif (meta.node instanceof RxElement) {\n\t\t\tconst node: RxElement = meta.node as RxElement;\n\t\t\tconst nodeInnerHTML = meta.nodeInnerHTML;\n\t\t\tconst rxcomp_hydrate_ = {\n\t\t\t\tselector: moduleFactory.meta.bootstrap.meta.selector,\n\t\t\t\tinnerHTML: nodeInnerHTML,\n\t\t\t};\n\t\t\tconst scriptNode = new RxElement(null, 'script');\n\t\t\tconst scriptText = new RxText(null, `var rxcomp_hydrate_ = ${JSON.stringify(rxcomp_hydrate_)};`);\n\t\t\tscriptNode.append(scriptText);\n\t\t\tnode.parentNode?.insertBefore(scriptNode, node);\n\t\t}\n\t\tconst module = new moduleFactory();\n\t\tmodule.meta = meta;\n\t\tmeta.imports.forEach((moduleFactory: typeof Module) => {\n\t\t\tmoduleFactory.prototype.constructor.call(module);\n\t\t});\n\t\tconst instances = module.compile(meta.node, { document } as Window);\n\t\tmodule.instances = instances;\n\t\tconst root = instances[0];\n\t\troot.pushChanges();\n\t\treturn module;\n\t}\n\n\tstatic serialize(): string {\n\t\t// console.log('Server.serialize');\n\t\tif (this.document instanceof RxDocument) {\n\t\t\tconst serialized = this.document.serialize();\n\t\t\t// console.log('serialized', serialized);\n\t\t\treturn serialized;\n\t\t} else {\n\t\t\tthrow new ModuleError('document is not an instance of RxDocument');\n\t\t}\n\t}\n\n\tprotected static document: Document | RxDocument;\n\n\tprotected static resolveGlobals(request: ServerRequest): Document | RxDocument {\n\t\tconst url: string = request.url;\n\t\tconst location: ILocation = RxLocation.location;\n\t\tlocation.assign(url);\n\t\tglobal.location = location;\n\t\tconst history: IHistory = RxHistory.history;\n\t\thistory.replaceState(null, '', location.origin);\n\t\tglobal.history = history;\n\t\tconst documentOrHtml: Document | string = request.template!;\n\t\tconst document: Document | RxDocument = typeof documentOrHtml === 'string' ? parse(documentOrHtml) : documentOrHtml;\n\t\tthis.document = document as unknown as Document; // !!!\n\t\tglobal.document = this.document;\n\t\thistory.replaceState(null, document.title || '', location.origin);\n\t\treturn this.document;\n\t}\n\n\tstatic render$ = render$;\n\tstatic template$ = template$;\n\tstatic bootstrap$ = bootstrap$;\n}\n\nexport function render$(iRequest: IServerRequest, renderRequest$: (request: ServerRequest) => Observable<ServerResponse>): Observable<ServerResponse> {\n\treturn Observable.create(function (observer: Observer<ServerResponse>) {\n\t\tconst request: ServerRequest = new ServerRequest(iRequest);\n\t\tif (request.vars.cacheMode) {\n\t\t\tCacheService.mode = request.vars.cacheMode;\n\t\t}\n\t\tif (request.vars.cache) {\n\t\t\tCacheService.folder = request.vars.cache;\n\t\t}\n\t\tconst cached = CacheService.get('cached', request.url);\n\t\tconsole.log('Server.render$.fromCache', !!cached, request.url);\n\t\tif (cached) {\n\t\t\tobserver.next(cached);\n\t\t\treturn observer.complete();\n\t\t}\n\t\ttemplate$(request).pipe(\n\t\t\tswitchMap((template: string) => {\n\t\t\t\t// console.log('template!', template);\n\t\t\t\trequest.template = template;\n\t\t\t\treturn renderRequest$(request);\n\t\t\t})\n\t\t).subscribe(\n\t\t\t(success) => {\n\t\t\t\tCacheService.set('cached', request.url, success, 3600);\n\t\t\t\tobserver.next(success);\n\t\t\t\tobserver.complete();\n\t\t\t},\n\t\t\t(error) => {\n\t\t\t\tobserver.error(error);\n\t\t\t}\n\t\t);\n\t});\n}\n\nexport function template$(request: ServerRequest): Observable<string> {\n\treturn Observable.create(function (observer: Observer<string>) {\n\t\tconst src = request.vars.template;\n\t\tif (src) {\n\t\t\tconst template = CacheService.get('template', src);\n\t\t\tconsole.log('Server.template$.fromCache', !!template, src);\n\t\t\tif (template) {\n\t\t\t\tobserver.next(template);\n\t\t\t\tobserver.complete();\n\t\t\t}\n\t\t\tfs.readFile(src, request.vars.charset, function (error: NodeJS.ErrnoException, template: string) {\n\t\t\t\tif (error) {\n\t\t\t\t\tobserver.error(error);\n\t\t\t\t} else {\n\t\t\t\t\tCacheService.set('template', src, template);\n\t\t\t\t\tobserver.next(template);\n\t\t\t\t\tobserver.complete();\n\t\t\t\t}\n\t\t\t});\n\t\t} else {\n\t\t\tobserver.error(new Error('ServerError: missing template'));\n\t\t}\n\t});\n}\n\nexport function bootstrap$(moduleFactory: typeof Module, request: ServerRequest): Observable<ServerResponse> {\n\t// console.log('Server.bootstrap$', request);\n\treturn Observable.create(function (observer: Observer<ServerResponse>) {\n\t\tif (!request.template) {\n\t\t\treturn observer.error(new Error('ServerError: missing template'));\n\t\t}\n\t\ttry {\n\t\t\t// const module = Server.bootstrap(moduleFactory, request.template);\n\t\t\tServer.bootstrap(moduleFactory, request);\n\t\t\tconst serialize = () => Server.serialize();\n\t\t\tobserver.next(new ServerResponse(Object.assign({ serialize }, request) as IServerResponse));\n\t\t\tobserver.complete();\n\t\t} catch (error) {\n\t\t\tobserver.error(new ServerErrorResponse(Object.assign({ error }, request) as IServerErrorResponse));\n\t\t}\n\t});\n}\n","import { IServerVars } from \"../../../src/rxcomp-server\";\r\n\r\nexport const Vars: IServerVars = {\r\n\tname: 'rxcomp-server',\r\n\thost: '',\r\n\tresource: '/',\r\n\tapi: '/api',\r\n\tstatic: false,\r\n\tdevelopment: false,\r\n\tproduction: true,\r\n};\r\n\r\n/*\r\nexport const STATIC = window.location.port === '40333' || window.location.host === 'actarian.github.io';\r\nexport const DEVELOPMENT = ['localhost', '127.0.0.1', '0.0.0.0'].indexOf(window.location.host.split(':')[0]) !== -1;\r\nexport const PRODUCTION = !DEVELOPMENT;\r\nexport const ENV = {\r\n\tNAME: 'ws-events',\r\n\tSTATIC,\r\n\tDEVELOPMENT,\r\n\tPRODUCTION,\r\n\tRESOURCE: '/Modules/Events/Client/docs/',\r\n\tSTATIC_RESOURCE: './',\r\n\tAPI: '/api',\r\n\tSTATIC_API: (DEVELOPMENT && !STATIC) ? '/Modules/Events/Client/docs/api' : './api',\r\n};\r\nexport function getApiUrl(url, useStatic) {\r\n\tconst base = (useStatic || STATIC) ? ENV.STATIC_API : ENV.API;\r\n\tconst json = (useStatic || STATIC) ? '.json' : '';\r\n\treturn `${base}${url}${json}`;\r\n}\r\nexport function getResourceRoot() {\r\n\treturn STATIC ? ENV.STATIC_RESOURCE : ENV.RESOURCE;\r\n}\r\nexport function getSlug(url) {\r\n\tif (!url) {\r\n\t\treturn url;\r\n\t}\r\n\tif (url.indexOf(`/${ENV.NAME}`) !== 0) {\r\n\t\treturn url;\r\n\t}\r\n\tif (STATIC) {\r\n\t\tconsole.log(url);\r\n\t\treturn url;\r\n\t}\r\n\turl = url.replace(`/${ENV.NAME}`, '');\r\n\turl = url.replace('.html', '');\r\n\treturn `/it/it${url}`;\r\n}\r\n*/\r\n","import { Component, errors$, IFactoryMeta } from 'rxcomp';\nimport { first, takeUntil } from 'rxjs/operators';\nimport { HttpService } from '../../../../rxcomp-http/dist/cjs/rxcomp-http';\nimport { Vars } from './vars';\n\ninterface ITodoItem {\n\tid: number;\n\ttitle: string;\n\tcompleted: boolean;\n}\n\ninterface IGetTodos {\n\tgetTodos: ITodoItem[]\n}\n\ninterface IResponseData {\n\tdata: IGetTodos;\n}\n\nexport default class AppComponent extends Component {\n\titems: ITodoItem[] = [];\n\terror: any = null;\n\tonInit() {\n\t\t// console.log('AppComponent.onInit', this);\n\t\t/*\n\t\tconst payload = { query: `{ hello }` };\n\t\t*/\n\t\t/*\n\t\tconst payload = { query: `{ roll(dices: ${3}, sides: ${6}) }` };\n\t\t*/\n\t\t/*\n\t\tconst payload = {\n\t\t\tquery: `query ($dices: Int!, $sides: Int) {\n\t\t\troll(dices: $dices, sides: $sides)\n\t\t}`, variables: { dices: 3, sides: 6 }\n\t\t};\n\t\t*/\n\t\tconst payload = { query: `{ getTodos { id, title, completed } }` };\n\t\t/*\n\t\tHttpService.post$<IResponseData>(`${Vars.host}${Vars.api}`, payload, {\n\t\t\tparams: { query: `{ getTodos { id, title, completed } }` },\n\t\t\treportProgress: true\n\t\t}).pipe(\n\t\t*/\n\t\tconst methodUrl: string = `${Vars.host}${Vars.api}`;\n\t\tconsole.log('methodUrl', methodUrl);\n\t\tHttpService.post$<IResponseData>(methodUrl, payload, { hydrate: true }).pipe(\n\t\t\tfirst(),\n\t\t).subscribe((response: IResponseData) => {\n\t\t\tthis.items = response.data.getTodos;\n\t\t\tthis.pushChanges();\n\t\t\t// console.log('AppComponent.getTodos', this.items);\n\t\t}, error => console.log);\n\t\t// HttpService.get$(`https://jsonplaceholder.typicode.com/users/1/todos`).pipe(\n\t\t/*\n\t\tHttpService.get$(`${Vars.host}/data/todos.json`).pipe(\n\t\t\tfirst(),\n\t\t).subscribe(response => {\n\t\t\t// console.log('AppComponent.items', response);\n\t\t\tthis.items = response.data;\n\t\t\tthis.pushChanges();\n\t\t});\n\t\t*/\n\t\terrors$.pipe(\n\t\t\ttakeUntil(this.unsubscribe$),\n\t\t).subscribe(error => {\n\t\t\tthis.error = error;\n\t\t\tthis.pushChanges();\n\t\t});\n\t}\n\n\tonClick(item: { title: string, completed: boolean }) {\n\t\titem.completed = !item.completed;\n\t\tthis.pushChanges();\n\t}\n\n\tstatic meta: IFactoryMeta = {\n\t\tselector: '[app-component]',\n\t};\n}\n","\nimport { EMPTY, Observable } from 'rxjs';\nimport { tap } from 'rxjs/operators';\nimport { HttpEvent, HttpHandler, HttpRequest, HttpResponse, IHttpInterceptor } from '../../../../../rxcomp-http/dist/cjs/rxcomp-http';\n\nconst cancelRequest: boolean = false;\n\nexport class CustomInterceptor implements IHttpInterceptor {\n\tintercept(request: HttpRequest<any>, next: HttpHandler): Observable<HttpEvent<any>> {\n\t\tif (cancelRequest) {\n\t\t\treturn EMPTY;\n\t\t}\n\t\tconst clonedRequest = request.clone({\n\t\t\turl: request.url,\n\t\t});\n\t\t// console.log('CustomInterceptor.clonedRequest', clonedRequest);\n\t\treturn next.handle(clonedRequest);\n\t\treturn next.handle(request).pipe(\n\t\t\ttap(event => {\n\t\t\t\tif (event instanceof HttpResponse) {\n\t\t\t\t\tconsole.log('CustomInterceptor.status', event.status);\n\t\t\t\t\tconsole.log('CustomInterceptor.filter', request.params.get('filter'));\n\t\t\t\t}\n\t\t\t})\n\t\t);\n\t}\n}\n","import { CoreModule, IModuleMeta, Module } from 'rxcomp';\nimport { HttpModule } from '../../../../rxcomp-http/dist/cjs/rxcomp-http';\nimport AppComponent from './app.component';\nimport { CustomInterceptor } from './custom-interceptor/custom.interceptor';\n\nexport default class AppModule extends Module {\n\n\tstatic meta: IModuleMeta = {\n\t\timports: [\n\t\t\tCoreModule,\n\t\t\tHttpModule.useInterceptors([CustomInterceptor]),\n\t\t],\n\t\tdeclarations: [\n\t\t],\n\t\tbootstrap: AppComponent,\n\t};\n\n}\n","// import fetch from 'cross-fetch';\nimport 'cross-fetch/polyfill';\nimport { Observable } from 'rxjs';\nimport { filter, first, map, switchMap } from 'rxjs/operators';\nimport { HttpService } from '../../../../rxcomp-http/dist/cjs/rxcomp-http';\nimport { Server, ServerRequest, ServerResponse } from '../../../src/rxcomp-server';\nimport AppModule from './app.module';\nimport { Vars } from './vars';\n\nexport function renderRequest$(request: ServerRequest): Observable<ServerResponse> {\n\tVars.host = request.vars.host;\n\t// console.log('renderRequest$', request, Vars);\n\treturn Server.bootstrap$(AppModule, request).pipe(\n\t\tswitchMap((response: ServerResponse) => {\n\t\t\treturn HttpService.pendingRequests$.pipe(\n\t\t\t\tfilter(count => count === 0),\n\t\t\t\tmap(() => {\n\t\t\t\t\tresponse.body = response.serialize();\n\t\t\t\t\treturn response;\n\t\t\t\t}),\n\t\t\t\tfirst(),\n\t\t\t);\n\t\t}),\n\t);\n}\n"]}